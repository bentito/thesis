<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><link rel="stylesheet" href="file:////usr/local/matlab_v7.11/toolbox/matlab/codetools/matlab-report-styles.css" type="text/css" /><title>Function details for eigs</title><link rel="stylesheet" href="file:////usr/local/matlab_v7.11/toolbox/matlab/codetools/matlab-report-styles.css" type="text/css" /></head><body bgcolor="#F8F8F8"><strong>This is a static copy of a profile report</strong><p><a href="file0.html">Home</a><p><span style="font-size:14pt; background:#FFE4B0">eigs (1 call, 3.033 sec)</span><br/><i>Generated 19-May-2013 17:00:57 using cpu time.</i><br/>function in file /usr/local/matlab_v7.11/toolbox/matlab/sparfun/eigs.m<br/>Copy to new window for comparing multiple runs<div class="grayline"/><div class="grayline"/><strong>Parents</strong> (calling functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td></tr><tr><td class="td-linebottomrt"><a href="file108.html">laplacian_eigenvectors</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">1</td></tr></table><div class="grayline"/><strong>Lines where the most time was spent</strong><br/> <p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line Number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Code</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="#Line94">94</a></td><td class="td-linebottomrt"><pre>[A,Amatrix,isrealprob,issymA,n...</pre></td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">2.676 s</td><td class="td-linebottomrt" class="td-linebottomrt">88.2%</td><td class="td-linebottomrt"><img src="file:////usr/local/matlab_v7.11/toolbox/matlab/codetools/private/one-pixel.gif" width=88 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line277">277</a></td><td class="td-linebottomrt"><pre>workd(:,cols(2)) = AminusSigma...</pre></td><td class="td-linebottomrt">53</td><td class="td-linebottomrt">0.252 s</td><td class="td-linebottomrt" class="td-linebottomrt">8.3%</td><td class="td-linebottomrt"><img src="file:////usr/local/matlab_v7.11/toolbox/matlab/codetools/private/one-pixel.gif" width=8 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line238">238</a></td><td class="td-linebottomrt"><pre>arpackc( aupdfun, ido, ...</pre></td><td class="td-linebottomrt">218</td><td class="td-linebottomrt">0.042 s</td><td class="td-linebottomrt" class="td-linebottomrt">1.4%</td><td class="td-linebottomrt"><img src="file:////usr/local/matlab_v7.11/toolbox/matlab/codetools/private/one-pixel.gif" width=1 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line264">264</a></td><td class="td-linebottomrt"><pre>cols = checkIpntr;</pre></td><td class="td-linebottomrt">218</td><td class="td-linebottomrt">0.021 s</td><td class="td-linebottomrt" class="td-linebottomrt">0.7%</td><td class="td-linebottomrt"><img src="file:////usr/local/matlab_v7.11/toolbox/matlab/codetools/private/one-pixel.gif" width=1 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line388">388</a></td><td class="td-linebottomrt"><pre>v(:,[cplxd cplxd+1]) = [comple...</pre></td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.010 s</td><td class="td-linebottomrt" class="td-linebottomrt">0.3%</td><td class="td-linebottomrt"><img src="file:////usr/local/matlab_v7.11/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt">All other lines</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">0.031 s</td><td class="td-linebottomrt">1.0%</td><td class="td-linebottomrt"><img src="file:////usr/local/matlab_v7.11/toolbox/matlab/codetools/private/one-pixel.gif" width=1 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">3.033 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><b>Children</b> (called functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="file112.html">eigs>checkInputs</a></td><td class="td-linebottomrt">nested function</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">2.676 s</td><td class="td-linebottomrt">88.2%</td><td class="td-linebottomrt"><img src="file:////usr/local/matlab_v7.11/toolbox/matlab/codetools/private/one-pixel.gif" width=88 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file126.html">eigs>AminusSigmaBsolve</a></td><td class="td-linebottomrt">nested function</td><td class="td-linebottomrt">53</td><td class="td-linebottomrt">0.252 s</td><td class="td-linebottomrt">8.3%</td><td class="td-linebottomrt"><img src="file:////usr/local/matlab_v7.11/toolbox/matlab/codetools/private/one-pixel.gif" width=8 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file115.html">...(arraytoconvert)int64(arraytoconvert)</a></td><td class="td-linebottomrt">anonymous function</td><td class="td-linebottomrt">225</td><td class="td-linebottomrt">0.021 s</td><td class="td-linebottomrt">0.7%</td><td class="td-linebottomrt"><img src="file:////usr/local/matlab_v7.11/toolbox/matlab/codetools/private/one-pixel.gif" width=1 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file124.html">eigs>checkIpntr</a></td><td class="td-linebottomrt">nested function</td><td class="td-linebottomrt">218</td><td class="td-linebottomrt">0.010 s</td><td class="td-linebottomrt">0.3%</td><td class="td-linebottomrt"><img src="file:////usr/local/matlab_v7.11/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file123.html">arpackc</a></td><td class="td-linebottomrt">MEX-file</td><td class="td-linebottomrt">219</td><td class="td-linebottomrt">0.010 s</td><td class="td-linebottomrt">0.3%</td><td class="td-linebottomrt"><img src="file:////usr/local/matlab_v7.11/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file128.html">eigs>processEUPDinfo</a></td><td class="td-linebottomrt">nested function</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:////usr/local/matlab_v7.11/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file127.html">eigs>@(v)v</a></td><td class="td-linebottomrt">anonymous function</td><td class="td-linebottomrt">163</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:////usr/local/matlab_v7.11/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file125.html">eigs>@(v)AminusSigmaBsolve(v)</a></td><td class="td-linebottomrt">anonymous function</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:////usr/local/matlab_v7.11/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file122.html">eigs>create@(v)v</a></td><td class="td-linebottomrt">anonymous function</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:////usr/local/matlab_v7.11/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file121.html">eigs>create@(v)AminusSigmaBsolve(v)</a></td><td class="td-linebottomrt">anonymous function</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:////usr/local/matlab_v7.11/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file111.html">...(arraytoconvert)int64(arraytoconvert)</a></td><td class="td-linebottomrt">anonymous function</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:////usr/local/matlab_v7.11/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt">Self time (built-ins, overhead, etc.)</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">0.063 s</td><td class="td-linebottomrt">2.1%</td><td class="td-linebottomrt"><img src="file:////usr/local/matlab_v7.11/toolbox/matlab/codetools/private/one-pixel.gif" width=2 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">3.033 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><strong>Code Analyzer results</strong><br/>No Code Analyzer messages.<div class="grayline"/><strong>Coverage results</strong><br/>[ Show coverage for parent directory ]<br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Total lines in function</td><td class="td-linebottomrt">1526</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Non-code lines (comments, blank lines)</td><td class="td-linebottomrt">1262</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines (lines that can run)</td><td class="td-linebottomrt">264</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did run</td><td class="td-linebottomrt">112</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did not run</td><td class="td-linebottomrt">152</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Coverage (did run/can run)</td><td class="td-linebottomrt">42.42 %</td></tr></table><div class="grayline"/><b>Function listing</b><br/><pre> <span style="color: #FF0000; font-weight: bold; text-decoration: none">  time</span> <span style="color: #0000FF; font-weight: bold; text-decoration: none">  calls</span>  <span style="font-weight: bold; text-decoration: none">line</span><br/>               <span style="color: #A0A0A0">   1</span> <span style="color: #A0A0A0; background: #FFFFFF;">function  varargout = eigs(varargin)</span><br/>               <span style="color: #A0A0A0">   2</span> <span style="color: #228B22; background: #FFFFFF;">%EIGS  Find a few eigenvalues and eigenvectors of a matrix using ARPACK</span><br/>               <span style="color: #A0A0A0">   3</span> <span style="color: #228B22; background: #FFFFFF;">%   D = EIGS(A) returns a vector of A's 6 largest magnitude eigenvalues.</span><br/>               <span style="color: #A0A0A0">   4</span> <span style="color: #228B22; background: #FFFFFF;">%   A must be square and should be large and sparse.</span><br/>               <span style="color: #A0A0A0">   5</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">   6</span> <span style="color: #228B22; background: #FFFFFF;">%   [V,D] = EIGS(A) returns a diagonal matrix D of A's 6 largest magnitude</span><br/>               <span style="color: #A0A0A0">   7</span> <span style="color: #228B22; background: #FFFFFF;">%   eigenvalues and a matrix V whose columns are the corresponding</span><br/>               <span style="color: #A0A0A0">   8</span> <span style="color: #228B22; background: #FFFFFF;">%   eigenvectors.</span><br/>               <span style="color: #A0A0A0">   9</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  10</span> <span style="color: #228B22; background: #FFFFFF;">%   [V,D,FLAG] = EIGS(A) also returns a convergence flag. If FLAG is 0 then</span><br/>               <span style="color: #A0A0A0">  11</span> <span style="color: #228B22; background: #FFFFFF;">%   all the eigenvalues converged; otherwise not all converged.</span><br/>               <span style="color: #A0A0A0">  12</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  13</span> <span style="color: #228B22; background: #FFFFFF;">%   EIGS(A,B) solves the generalized eigenvalue problem A*V == B*V*D. B must be</span><br/>               <span style="color: #A0A0A0">  14</span> <span style="color: #228B22; background: #FFFFFF;">%   the same size as A. EIGS(A,[],...) indicates the standard eigenvalue problem</span><br/>               <span style="color: #A0A0A0">  15</span> <span style="color: #228B22; background: #FFFFFF;">%   A*V == V*D.</span><br/>               <span style="color: #A0A0A0">  16</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  17</span> <span style="color: #228B22; background: #FFFFFF;">%   EIGS(A,K) and EIGS(A,B,K) return the K largest magnitude eigenvalues.</span><br/>               <span style="color: #A0A0A0">  18</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  19</span> <span style="color: #228B22; background: #FFFFFF;">%   EIGS(A,K,SIGMA) and EIGS(A,B,K,SIGMA) return K eigenvalues. If SIGMA is:</span><br/>               <span style="color: #A0A0A0">  20</span> <span style="color: #228B22; background: #FFFFFF;">%      'LM' or 'SM' - Largest or Smallest Magnitude</span><br/>               <span style="color: #A0A0A0">  21</span> <span style="color: #228B22; background: #FFFFFF;">%   For real symmetric problems, SIGMA may also be:</span><br/>               <span style="color: #A0A0A0">  22</span> <span style="color: #228B22; background: #FFFFFF;">%      'LA' or 'SA' - Largest or Smallest Algebraic</span><br/>               <span style="color: #A0A0A0">  23</span> <span style="color: #228B22; background: #FFFFFF;">%      'BE' - Both Ends, one more from high end if K is odd</span><br/>               <span style="color: #A0A0A0">  24</span> <span style="color: #228B22; background: #FFFFFF;">%   For nonsymmetric and complex problems, SIGMA may also be:</span><br/>               <span style="color: #A0A0A0">  25</span> <span style="color: #228B22; background: #FFFFFF;">%      'LR' or 'SR' - Largest or Smallest Real part</span><br/>               <span style="color: #A0A0A0">  26</span> <span style="color: #228B22; background: #FFFFFF;">%      'LI' or 'SI' - Largest or Smallest Imaginary part</span><br/>               <span style="color: #A0A0A0">  27</span> <span style="color: #228B22; background: #FFFFFF;">%   If SIGMA is a real or complex scalar including 0, EIGS finds the</span><br/>               <span style="color: #A0A0A0">  28</span> <span style="color: #228B22; background: #FFFFFF;">%   eigenvalues closest to SIGMA. </span><br/>               <span style="color: #A0A0A0">  29</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  30</span> <span style="color: #228B22; background: #FFFFFF;">%   EIGS(A,K,SIGMA,OPTS) and EIGS(A,B,K,SIGMA,OPTS) specify options:</span><br/>               <span style="color: #A0A0A0">  31</span> <span style="color: #228B22; background: #FFFFFF;">%   OPTS.issym: symmetry of A or A-SIGMA*B represented by AFUN [{false} |</span><br/>               <span style="color: #A0A0A0">  32</span> <span style="color: #228B22; background: #FFFFFF;">%   true]</span><br/>               <span style="color: #A0A0A0">  33</span> <span style="color: #228B22; background: #FFFFFF;">%   OPTS.isreal: complexity of A or A-SIGMA*B represented by AFUN [false | {true}]</span><br/>               <span style="color: #A0A0A0">  34</span> <span style="color: #228B22; background: #FFFFFF;">%   OPTS.tol: convergence: Ritz estimate residual &lt;= tol*NORM(A) [scalar | {eps}]</span><br/>               <span style="color: #A0A0A0">  35</span> <span style="color: #228B22; background: #FFFFFF;">%   OPTS.maxit: maximum number of iterations [integer | {300}]</span><br/>               <span style="color: #A0A0A0">  36</span> <span style="color: #228B22; background: #FFFFFF;">%   OPTS.p: number of Lanczos vectors: K+1&lt;p&lt;=N [integer | {2K}]</span><br/>               <span style="color: #A0A0A0">  37</span> <span style="color: #228B22; background: #FFFFFF;">%   OPTS.v0: starting vector [N-by-1 vector | {randomly generated}]</span><br/>               <span style="color: #A0A0A0">  38</span> <span style="color: #228B22; background: #FFFFFF;">%   OPTS.disp: diagnostic information display level [{0} | 1 | 2]</span><br/>               <span style="color: #A0A0A0">  39</span> <span style="color: #228B22; background: #FFFFFF;">%   OPTS.cholB: B is actually its Cholesky factor CHOL(B) [{false} | true]</span><br/>               <span style="color: #A0A0A0">  40</span> <span style="color: #228B22; background: #FFFFFF;">%   OPTS.permB: sparse B is actually CHOL(B(permB,permB)) [permB | {1:N}]</span><br/>               <span style="color: #A0A0A0">  41</span> <span style="color: #228B22; background: #FFFFFF;">%   Use CHOL(B) instead of B when SIGMA is a string other than 'SM'.</span><br/>               <span style="color: #A0A0A0">  42</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  43</span> <span style="color: #228B22; background: #FFFFFF;">%   EIGS(AFUN,N) accepts the function AFUN instead of the matrix A. AFUN is</span><br/>               <span style="color: #A0A0A0">  44</span> <span style="color: #228B22; background: #FFFFFF;">%   a function handle and Y = AFUN(X) should return</span><br/>               <span style="color: #A0A0A0">  45</span> <span style="color: #228B22; background: #FFFFFF;">%      A*X            if SIGMA is unspecified, or a string other than 'SM'</span><br/>               <span style="color: #A0A0A0">  46</span> <span style="color: #228B22; background: #FFFFFF;">%      A\X            if SIGMA is 0 or 'SM'</span><br/>               <span style="color: #A0A0A0">  47</span> <span style="color: #228B22; background: #FFFFFF;">%      (A-SIGMA*I)\X  if SIGMA is a nonzero scalar (standard problem)</span><br/>               <span style="color: #A0A0A0">  48</span> <span style="color: #228B22; background: #FFFFFF;">%      (A-SIGMA*B)\X  if SIGMA is a nonzero scalar (generalized problem)</span><br/>               <span style="color: #A0A0A0">  49</span> <span style="color: #228B22; background: #FFFFFF;">%   N is the size of A. The matrix A, A-SIGMA*I or A-SIGMA*B represented by</span><br/>               <span style="color: #A0A0A0">  50</span> <span style="color: #228B22; background: #FFFFFF;">%   AFUN is assumed to be real and nonsymmetric unless specified otherwise</span><br/>               <span style="color: #A0A0A0">  51</span> <span style="color: #228B22; background: #FFFFFF;">%   by OPTS.isreal and OPTS.issym. In all these EIGS syntaxes, EIGS(A,...)</span><br/>               <span style="color: #A0A0A0">  52</span> <span style="color: #228B22; background: #FFFFFF;">%   may be replaced by EIGS(AFUN,N,...).</span><br/>               <span style="color: #A0A0A0">  53</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  54</span> <span style="color: #228B22; background: #FFFFFF;">%   Example:</span><br/>               <span style="color: #A0A0A0">  55</span> <span style="color: #228B22; background: #FFFFFF;">%      A = delsq(numgrid('C',15));  d1 = eigs(A,5,'SM');</span><br/>               <span style="color: #A0A0A0">  56</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  57</span> <span style="color: #228B22; background: #FFFFFF;">%   Equivalently, if dnRk is the following one-line function:</span><br/>               <span style="color: #A0A0A0">  58</span> <span style="color: #228B22; background: #FFFFFF;">%      %----------------------------%</span><br/>               <span style="color: #A0A0A0">  59</span> <span style="color: #228B22; background: #FFFFFF;">%      function y = dnRk(x,R,k)</span><br/>               <span style="color: #A0A0A0">  60</span> <span style="color: #228B22; background: #FFFFFF;">%      y = (delsq(numgrid(R,k))) \ x;</span><br/>               <span style="color: #A0A0A0">  61</span> <span style="color: #228B22; background: #FFFFFF;">%      %----------------------------%</span><br/>               <span style="color: #A0A0A0">  62</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  63</span> <span style="color: #228B22; background: #FFFFFF;">%      n = size(A,1);  opts.issym = 1;</span><br/>               <span style="color: #A0A0A0">  64</span> <span style="color: #228B22; background: #FFFFFF;">%      d2 = eigs(@(x)dnRk(x,'C',15),n,5,'SM',opts);</span><br/>               <span style="color: #A0A0A0">  65</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  66</span> <span style="color: #228B22; background: #FFFFFF;">%   See also EIG, SVDS, ARPACKC, FUNCTION_HANDLE.</span><br/>               <span style="color: #A0A0A0">  67</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  68</span> <span style="color: #228B22; background: #FFFFFF;">%   Copyright 1984-2010 The MathWorks, Inc.</span><br/>               <span style="color: #A0A0A0">  69</span> <span style="color: #228B22; background: #FFFFFF;">%   $Revision: 1.45.4.13 $  $Date: 2010/02/25 08:11:45 $</span><br/>               <span style="color: #A0A0A0">  70</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  71</span> <span style="color: #228B22; background: #FFFFFF;">%   EIGS provides the reverse communication interface to ARPACK library</span><br/>               <span style="color: #A0A0A0">  72</span> <span style="color: #228B22; background: #FFFFFF;">%   routines. EIGS attempts to provide an interface for as many different</span><br/>               <span style="color: #A0A0A0">  73</span> <span style="color: #228B22; background: #FFFFFF;">%   algorithms as possible. The reverse communication interfaces are</span><br/>               <span style="color: #A0A0A0">  74</span> <span style="color: #228B22; background: #FFFFFF;">%   documented in the ARPACK Users' Guide, ISBN 0-89871-407-9.</span><br/>               <span style="color: #A0A0A0">  75</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  76</span> <span style="color: #000000; background: #FFFFFF;">cputms = zeros(5,1); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  77</span> <span style="color: #000000; background: #FFFFFF;">t0 = cputime; % start timing pre-processing </span><br/>               <span style="color: #A0A0A0">  78</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  79</span> <span style="color: #228B22; background: #FFFFFF;">% Process inputs and do error-checking</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  80</span> <span style="color: #000000; background: #FFFFFF;">if (nargout &gt; 3) </span><br/>               <span style="color: #A0A0A0">  81</span> <span style="color: #A0A0A0; background: #FFFFFF;">    error('MATLAB:eigs:TooManyOutputs', 'Too many output arguments.')</span><br/>               <span style="color: #A0A0A0">  82</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0">  83</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  84</span> <span style="color: #228B22; background: #FFFFFF;">% Platform dependent integer type</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  85</span> <span style="color: #000000; background: #FFFFFF;">if strfind(computer, '64') </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  86</span> <span style="color: #000000; background: #FFFFFF;">    intconvert = @(arraytoconvert) int64(arraytoconvert); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  87</span> <span style="color: #000000; background: #FFFFFF;">    inttype = 'int64'; </span><br/>               <span style="color: #A0A0A0">  88</span> <span style="color: #228B22; background: #FFFFFF;">else</span><br/>               <span style="color: #A0A0A0">  89</span> <span style="color: #A0A0A0; background: #FFFFFF;">    intconvert = @(arraytoconvert) int32(arraytoconvert);</span><br/>               <span style="color: #A0A0A0">  90</span> <span style="color: #A0A0A0; background: #FFFFFF;">    inttype = 'int32';</span><br/>               <span style="color: #A0A0A0">  91</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0">  92</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  93</span> <span style="color: #228B22; background: #FFFFFF;">% Error check inputs and derive some information from them</span><br/><span style="color: #FF0000">  2.68 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  94</span> <a name="Line94"></a><span style="color: #000000; background: #FF8080;">[A,Amatrix,isrealprob,issymA,n,B,classAB,k,eigs_sigma,whch, ... </span><br/>               <span style="color: #A0A0A0">  95</span> <span style="color: #000000; background: #FF8080;">    sigma,tol,maxit,p,info,eigs_display,cholB,permB,resid,useeig, ...</span><br/>               <span style="color: #A0A0A0">  96</span> <span style="color: #000000; background: #FF8080;">    afunNargs,style,mode,Afactors,Bfactors] = ...</span><br/>               <span style="color: #A0A0A0">  97</span> <span style="color: #000000; background: #FF8080;">    checkInputs(varargin{:});</span><br/>               <span style="color: #A0A0A0">  98</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  99</span> <span style="color: #228B22; background: #FFFFFF;">% Now have enough information to do early return on cases EIGS does not</span><br/>               <span style="color: #A0A0A0"> 100</span> <span style="color: #228B22; background: #FFFFFF;">% handle. For these cases, use the full EIG code.</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 101</span> <span style="color: #000000; background: #FFFFFF;">if useeig </span><br/>               <span style="color: #A0A0A0"> 102</span> <span style="color: #A0A0A0; background: #FFFFFF;">    fullEig(nargout);</span><br/>               <span style="color: #A0A0A0"> 103</span> <span style="color: #A0A0A0; background: #FFFFFF;">    return</span><br/>               <span style="color: #A0A0A0"> 104</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 105</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 106</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(Afactors) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 107</span> <span style="color: #000000; background: #FFFFFF;">    L = Afactors.L;     Afactors.L = []; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 108</span> <span style="color: #000000; background: #FFFFFF;">    U = Afactors.U;     Afactors.U = []; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 109</span> <span style="color: #000000; background: #FFFFFF;">    pp = Afactors.pp;   Afactors.pp = []; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 110</span> <span style="color: #000000; background: #FFFFFF;">    qq = Afactors.qq;   Afactors.qq = []; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 111</span> <span style="color: #000000; background: #FFFFFF;">    dgAsB = Afactors.dgAsB;    Afactors.dgAsB = []; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 112</span> <span style="color: #000000; background: #FFFFFF;">    clear Afactors; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 113</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0"> 114</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 115</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(Bfactors) </span><br/>               <span style="color: #A0A0A0"> 116</span> <span style="color: #A0A0A0; background: #FFFFFF;">    BisHpd = Bfactors.BisHpd;</span><br/>               <span style="color: #A0A0A0"> 117</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if BisHpd</span><br/>               <span style="color: #A0A0A0"> 118</span> <span style="color: #A0A0A0; background: #FFFFFF;">        RB = Bfactors.RB;       Bfactors.RB = [];</span><br/>               <span style="color: #A0A0A0"> 119</span> <span style="color: #A0A0A0; background: #FFFFFF;">        RBT = Bfactors.RBT;     Bfactors.RBT = [];</span><br/>               <span style="color: #A0A0A0"> 120</span> <span style="color: #A0A0A0; background: #FFFFFF;">        permB = Bfactors.permB; Bfactors.permB = [];</span><br/>               <span style="color: #A0A0A0"> 121</span> <span style="color: #228B22; background: #FFFFFF;">    else</span><br/>               <span style="color: #A0A0A0"> 122</span> <span style="color: #A0A0A0; background: #FFFFFF;">        LB = Bfactors.LB;       Bfactors.LB = [];</span><br/>               <span style="color: #A0A0A0"> 123</span> <span style="color: #A0A0A0; background: #FFFFFF;">        UB = Bfactors.UB;       Bfactors.UB = [];</span><br/>               <span style="color: #A0A0A0"> 124</span> <span style="color: #A0A0A0; background: #FFFFFF;">        ppB = Bfactors.ppB;     Bfactors.ppB = [];</span><br/>               <span style="color: #A0A0A0"> 125</span> <span style="color: #A0A0A0; background: #FFFFFF;">        qqB = Bfactors.qqB;     Bfactors.qqB = [];</span><br/>               <span style="color: #A0A0A0"> 126</span> <span style="color: #A0A0A0; background: #FFFFFF;">        dgB = Bfactors.dgB;     Bfactors.dgB = [];</span><br/>               <span style="color: #A0A0A0"> 127</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 128</span> <span style="color: #A0A0A0; background: #FFFFFF;">    clear Bfactors;</span><br/>               <span style="color: #A0A0A0"> 129</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 130</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 131</span> <span style="color: #000000; background: #FFFFFF;">if isempty(B) </span><br/><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 132</span> <span style="color: #000000; background: #FFFFFF;">    if mode ~= 3 </span><br/>               <span style="color: #A0A0A0"> 133</span> <span style="color: #228B22; background: #FFFFFF;">        % OP = A</span><br/>               <span style="color: #A0A0A0"> 134</span> <span style="color: #A0A0A0; background: #FFFFFF;">        applyOP = @(v)Amtimes(v);</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 135</span> <span style="color: #228B22; background: #FFFFFF;">    else </span><br/>               <span style="color: #A0A0A0"> 136</span> <span style="color: #228B22; background: #FFFFFF;">        % OP = (A-\sigma*I)^{-1}</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 137</span> <span style="color: #000000; background: #FFFFFF;">        applyOP = @(v)<a href="file126.html">AminusSigmaBsolve</a>(v); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 138</span> <span style="color: #000000; background: #FFFFFF;">    end </span><br/>               <span style="color: #A0A0A0"> 139</span> <span style="color: #228B22; background: #FFFFFF;">else</span><br/>               <span style="color: #A0A0A0"> 140</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if mode ~= 3 &amp;&amp; BisHpd == true</span><br/>               <span style="color: #A0A0A0"> 141</span> <span style="color: #228B22; background: #FFFFFF;">        % OP = L^{-1}AL^{-T} (B = LL^T)</span><br/>               <span style="color: #A0A0A0"> 142</span> <span style="color: #A0A0A0; background: #FFFFFF;">        applyOP = @(v)RBTsolve(Amtimes(RBsolve(v)));</span><br/>               <span style="color: #A0A0A0"> 143</span> <span style="color: #A0A0A0; background: #FFFFFF;">    elseif mode ~= 3 &amp;&amp; BisHpd == false</span><br/>               <span style="color: #A0A0A0"> 144</span> <span style="color: #228B22; background: #FFFFFF;">        % OP = U^{-1}L^{-1}A (B = LU)</span><br/>               <span style="color: #A0A0A0"> 145</span> <span style="color: #A0A0A0; background: #FFFFFF;">        applyOP = @(v)Bsolve(Amtimes(v));</span><br/>               <span style="color: #A0A0A0"> 146</span> <span style="color: #228B22; background: #FFFFFF;">    else</span><br/>               <span style="color: #A0A0A0"> 147</span> <span style="color: #228B22; background: #FFFFFF;">        % OP = (A-\sigma*B)^{-1}B</span><br/>               <span style="color: #A0A0A0"> 148</span> <span style="color: #A0A0A0; background: #FFFFFF;">        applyOP = @(v)AminusSigmaBsolve(Bmtimes(v));</span><br/>               <span style="color: #A0A0A0"> 149</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 150</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 151</span> <span style="color: #000000; background: #FFFFFF;">if strcmp(style,'G') </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 152</span> <span style="color: #000000; background: #FFFFFF;">    if ~isempty(B) &amp;&amp; BisHpd == true &amp;&amp; mode == 3 </span><br/>               <span style="color: #A0A0A0"> 153</span> <span style="color: #A0A0A0; background: #FFFFFF;">        applyM = @(v) Bmtimes(v);</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 154</span> <span style="color: #228B22; background: #FFFFFF;">    else </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 155</span> <span style="color: #000000; background: #FFFFFF;">        applyM = @(v) v; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 156</span> <span style="color: #000000; background: #FFFFFF;">    end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 157</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0"> 158</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 159</span> <span style="color: #228B22; background: #FFFFFF;">% Allocate outputs and ARPACK work variables</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 160</span> <span style="color: #000000; background: #FFFFFF;">if isrealprob </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 161</span> <span style="color: #000000; background: #FFFFFF;">    if issymA % real and symmetric </span><br/>               <span style="color: #A0A0A0"> 162</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if strcmp(classAB,'single')</span><br/>               <span style="color: #A0A0A0"> 163</span> <span style="color: #A0A0A0; background: #FFFFFF;">            aupdfun = 'ssaupd';</span><br/>               <span style="color: #A0A0A0"> 164</span> <span style="color: #A0A0A0; background: #FFFFFF;">            eupdfun = 'sseupd';</span><br/>               <span style="color: #A0A0A0"> 165</span> <span style="color: #228B22; background: #FFFFFF;">        else</span><br/>               <span style="color: #A0A0A0"> 166</span> <span style="color: #A0A0A0; background: #FFFFFF;">            aupdfun = 'dsaupd';</span><br/>               <span style="color: #A0A0A0"> 167</span> <span style="color: #A0A0A0; background: #FFFFFF;">            eupdfun = 'dseupd';</span><br/>               <span style="color: #A0A0A0"> 168</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 169</span> <span style="color: #A0A0A0; background: #FFFFFF;">      lworkl = intconvert(p*(p+8));</span><br/>               <span style="color: #A0A0A0"> 170</span> <span style="color: #A0A0A0; background: #FFFFFF;">        d = zeros(k,1,classAB);</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 171</span> <span style="color: #228B22; background: #FFFFFF;">    else % real but not symmetric </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 172</span> <span style="color: #000000; background: #FFFFFF;">        if strcmp(classAB,'single') </span><br/>               <span style="color: #A0A0A0"> 173</span> <span style="color: #A0A0A0; background: #FFFFFF;">            aupdfun = 'snaupd';</span><br/>               <span style="color: #A0A0A0"> 174</span> <span style="color: #A0A0A0; background: #FFFFFF;">            eupdfun = 'sneupd';</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 175</span> <span style="color: #228B22; background: #FFFFFF;">        else </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 176</span> <span style="color: #000000; background: #FFFFFF;">            aupdfun = 'dnaupd'; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 177</span> <span style="color: #000000; background: #FFFFFF;">            eupdfun = 'dneupd'; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 178</span> <span style="color: #000000; background: #FFFFFF;">        end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 179</span> <span style="color: #000000; background: #FFFFFF;">      lworkl = intconvert(3*p*(p+2)); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 180</span> <span style="color: #000000; background: #FFFFFF;">        workev = zeros(3*p,1,classAB); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 181</span> <span style="color: #000000; background: #FFFFFF;">        d = zeros(k+1,1,classAB); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 182</span> <span style="color: #000000; background: #FFFFFF;">        di = zeros(k+1,1,classAB); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 183</span> <span style="color: #000000; background: #FFFFFF;">    end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 184</span> <span style="color: #000000; background: #FFFFFF;">    v = zeros(n,p,classAB); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 185</span> <span style="color: #000000; background: #FFFFFF;">    workd = zeros(n,3,classAB); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 186</span> <span style="color: #000000; background: #FFFFFF;">    workl = zeros(lworkl,1,classAB); </span><br/>               <span style="color: #A0A0A0"> 187</span> <span style="color: #228B22; background: #FFFFFF;">else % complex</span><br/>               <span style="color: #A0A0A0"> 188</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if strcmp(classAB,'single')</span><br/>               <span style="color: #A0A0A0"> 189</span> <span style="color: #A0A0A0; background: #FFFFFF;">        aupdfun = 'cnaupd';</span><br/>               <span style="color: #A0A0A0"> 190</span> <span style="color: #A0A0A0; background: #FFFFFF;">        eupdfun = 'cneupd';</span><br/>               <span style="color: #A0A0A0"> 191</span> <span style="color: #228B22; background: #FFFFFF;">    else</span><br/>               <span style="color: #A0A0A0"> 192</span> <span style="color: #A0A0A0; background: #FFFFFF;">        aupdfun = 'znaupd';</span><br/>               <span style="color: #A0A0A0"> 193</span> <span style="color: #A0A0A0; background: #FFFFFF;">        eupdfun = 'zneupd';</span><br/>               <span style="color: #A0A0A0"> 194</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 195</span> <span style="color: #A0A0A0; background: #FFFFFF;">    zv = zeros(2*n*p,1,classAB);</span><br/>               <span style="color: #A0A0A0"> 196</span> <span style="color: #A0A0A0; background: #FFFFFF;">    workd = complex(zeros(n,3,classAB));</span><br/>               <span style="color: #A0A0A0"> 197</span> <span style="color: #A0A0A0; background: #FFFFFF;">    zworkd = zeros(2*numel(workd),1,classAB);</span><br/>               <span style="color: #A0A0A0"> 198</span> <span style="color: #A0A0A0; background: #FFFFFF;">   lworkl = intconvert(2*(3*p^2+5*p));</span><br/>               <span style="color: #A0A0A0"> 199</span> <span style="color: #A0A0A0; background: #FFFFFF;">   workl = zeros(lworkl,1,classAB);</span><br/>               <span style="color: #A0A0A0"> 200</span> <span style="color: #A0A0A0; background: #FFFFFF;">    workev = zeros(2*2*p,1,classAB);</span><br/>               <span style="color: #A0A0A0"> 201</span> <span style="color: #A0A0A0; background: #FFFFFF;">    zd = zeros(2*(k+1),1,classAB);</span><br/>               <span style="color: #A0A0A0"> 202</span> <span style="color: #A0A0A0; background: #FFFFFF;">    rwork = zeros(p,1,classAB);</span><br/>               <span style="color: #A0A0A0"> 203</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 204</span> <span style="color: #000000; background: #FFFFFF;">ldv = intconvert(n); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 205</span> <span style="color: #000000; background: #FFFFFF;">ipntr = zeros(15,1,inttype); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 206</span> <span style="color: #000000; background: #FFFFFF;">ido = intconvert(0); % reverse communication parameter, initial value </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 207</span> <span style="color: #000000; background: #FFFFFF;">if strcmp(style,'S') </span><br/>               <span style="color: #A0A0A0"> 208</span> <span style="color: #A0A0A0; background: #FFFFFF;">    bmat = 'I'; % standard eigenvalue problem</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 209</span> <span style="color: #228B22; background: #FFFFFF;">else </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 210</span> <span style="color: #000000; background: #FFFFFF;">    bmat = 'G'; % generalized eigenvalue problem </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 211</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 212</span> <span style="color: #000000; background: #FFFFFF;">nev = intconvert(k); % number of eigenvalues requested </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 213</span> <span style="color: #000000; background: #FFFFFF;">ncv = intconvert(p); % number of Lanczos vectors </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 214</span> <span style="color: #000000; background: #FFFFFF;">iparam = zeros(11,1,inttype); </span><br/>               <span style="color: #A0A0A0"> 215</span> <span style="color: #228B22; background: #FFFFFF;">% iparam(1) = ishift = 1 ensures we are never asked to handle ido=3</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 216</span> <span style="color: #000000; background: #FFFFFF;">iparam([1 3 7]) = [1 maxit mode]; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 217</span> <span style="color: #000000; background: #FFFFFF;">select = zeros(p,1,inttype); </span><br/>               <span style="color: #A0A0A0"> 218</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 219</span> <span style="color: #228B22; background: #FFFFFF;">% To Do: Remove this error when ARPACKC supports singles</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 220</span> <span style="color: #000000; background: #FFFFFF;">if strcmp(classAB,'single') </span><br/>               <span style="color: #A0A0A0"> 221</span> <span style="color: #A0A0A0; background: #FFFFFF;">    error('MATLAB:eigs:single', ...</span><br/>               <span style="color: #A0A0A0"> 222</span> <span style="color: #A0A0A0; background: #FFFFFF;">        'EIGS does not support single precision inputs.')</span><br/>               <span style="color: #A0A0A0"> 223</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 224</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 225</span> <span style="color: #228B22; background: #FFFFFF;">% The ARPACK routines return to EIGS many times per each iteration but we</span><br/>               <span style="color: #A0A0A0"> 226</span> <span style="color: #228B22; background: #FFFFFF;">% only want to display the Ritz values once per iteration (if opts.disp&gt;0).</span><br/>               <span style="color: #A0A0A0"> 227</span> <span style="color: #228B22; background: #FFFFFF;">% Keep track of whether we've displayed this iteration yet in eigs_iter.</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 228</span> <span style="color: #000000; background: #FFFFFF;">eigs_iter = 0; </span><br/>               <span style="color: #A0A0A0"> 229</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 230</span> <span style="color: #000000; background: #FFFFFF;">cputms(1) = cputime - t0; % end timing pre-processing </span><br/>               <span style="color: #A0A0A0"> 231</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 232</span> <span style="color: #228B22; background: #FFFFFF;">% Iterate until ARPACK's reverse communication parameter ido says to stop</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 233</span> <span style="color: #000000; background: #FFFFFF;">while (ido ~= 99) </span><br/>               <span style="color: #A0A0A0"> 234</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>       <span style="color: #0000FF">    218 </span><span style="color: #000000; font-weight: bold"> 235</span> <span style="color: #000000; background: #FFFFFF;">    t0 = cputime; % start timing ARPACK calls **aupd </span><br/>               <span style="color: #A0A0A0"> 236</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>       <span style="color: #0000FF">    218 </span><span style="color: #000000; font-weight: bold"> 237</span> <span style="color: #000000; background: #FFFFFF;">    if isrealprob </span><br/><span style="color: #FF0000">  0.04 </span><span style="color: #0000FF">    218 </span><span style="color: #000000; font-weight: bold"> 238</span> <a name="Line238"></a><span style="color: #000000; background: #FFFFFF;">        <a href="file123.html">arpackc</a>( aupdfun, ido, ... </span><br/>               <span style="color: #A0A0A0"> 239</span> <span style="color: #000000; background: #FFFFFF;">         bmat, intconvert(n), whch, nev, tol, resid, ncv, ...</span><br/>               <span style="color: #A0A0A0"> 240</span> <span style="color: #000000; background: #FFFFFF;">            v, ldv, iparam, ipntr, workd, workl, lworkl, info );</span><br/>               <span style="color: #A0A0A0"> 241</span> <span style="color: #228B22; background: #FFFFFF;">    else</span><br/>               <span style="color: #A0A0A0"> 242</span> <span style="color: #228B22; background: #FFFFFF;">        % The FORTRAN ARPACK routine expects the complex input zworkd to have</span><br/>               <span style="color: #A0A0A0"> 243</span> <span style="color: #228B22; background: #FFFFFF;">        % real and imaginary parts interleaved, but the OP about to be</span><br/>               <span style="color: #A0A0A0"> 244</span> <span style="color: #228B22; background: #FFFFFF;">        % applied to workd expects it in MATLAB's complex representation with</span><br/>               <span style="color: #A0A0A0"> 245</span> <span style="color: #228B22; background: #FFFFFF;">        % separate real and imaginary parts. Thus we need both.</span><br/>               <span style="color: #A0A0A0"> 246</span> <span style="color: #A0A0A0; background: #FFFFFF;">        zworkd(1:2:end-1) = real(workd);</span><br/>               <span style="color: #A0A0A0"> 247</span> <span style="color: #A0A0A0; background: #FFFFFF;">        zworkd(2:2:end) = imag(workd);</span><br/>               <span style="color: #A0A0A0"> 248</span> <span style="color: #A0A0A0; background: #FFFFFF;">        arpackc( aupdfun, ido, ...</span><br/>               <span style="color: #A0A0A0"> 249</span> <span style="color: #A0A0A0; background: #FFFFFF;">         bmat, intconvert(n), whch, nev, tol, resid, ncv, ...</span><br/>               <span style="color: #A0A0A0"> 250</span> <span style="color: #A0A0A0; background: #FFFFFF;">            zv, ldv, iparam, ipntr, zworkd, workl, lworkl, rwork, info );</span><br/>               <span style="color: #A0A0A0"> 251</span> <span style="color: #A0A0A0; background: #FFFFFF;">        workd = reshape(complex(zworkd(1:2:end-1),zworkd(2:2:end)),[n,3]);</span><br/>               <span style="color: #A0A0A0"> 252</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 253</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>       <span style="color: #0000FF">    218 </span><span style="color: #000000; font-weight: bold"> 254</span> <span style="color: #000000; background: #FFFFFF;">    if (info &lt; 0) </span><br/>               <span style="color: #A0A0A0"> 255</span> <span style="color: #A0A0A0; background: #FFFFFF;">        error('MATLAB:eigs:ARPACKroutineError', ...</span><br/>               <span style="color: #A0A0A0"> 256</span> <span style="color: #A0A0A0; background: #FFFFFF;">            'Error with ARPACK routine %s: info = %d', ...</span><br/>               <span style="color: #A0A0A0"> 257</span> <span style="color: #A0A0A0; background: #FFFFFF;">            aupdfun,full(double(info)))</span><br/>               <span style="color: #A0A0A0"> 258</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 259</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>       <span style="color: #0000FF">    218 </span><span style="color: #000000; font-weight: bold"> 260</span> <span style="color: #000000; background: #FFFFFF;">    cputms(2) = cputms(2) + (cputime-t0); % end timing ARPACK calls **aupd </span><br/>       <span style="color: #0000FF">    218 </span><span style="color: #000000; font-weight: bold"> 261</span> <span style="color: #000000; background: #FFFFFF;">    t0 = cputime; % start timing MATLAB OP(X) </span><br/>               <span style="color: #A0A0A0"> 262</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>               <span style="color: #A0A0A0"> 263</span> <span style="color: #228B22; background: #FFFFFF;">    % Compute which columns of workd ipntr references</span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">    218 </span><span style="color: #000000; font-weight: bold"> 264</span> <a name="Line264"></a><span style="color: #000000; background: #FFFFFF;">    cols = <a href="file124.html">checkIpntr</a>; </span><br/>               <span style="color: #A0A0A0"> 265</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>               <span style="color: #A0A0A0"> 266</span> <span style="color: #228B22; background: #FFFFFF;">    % The ARPACK reverse communication parameter ido tells EIGS what to do</span><br/>               <span style="color: #A0A0A0"> 267</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>       <span style="color: #0000FF">    218 </span><span style="color: #000000; font-weight: bold"> 268</span> <span style="color: #000000; background: #FFFFFF;">    switch ido </span><br/><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">    218 </span><span style="color: #000000; font-weight: bold"> 269</span> <span style="color: #000000; background: #FFFFFF;">        case -1 </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 270</span> <span style="color: #000000; background: #FFFFFF;">            workd(:,cols(2)) = applyOP(workd(:,cols(1))); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 271</span> <span style="color: #000000; background: #FFFFFF;">            if strcmp(style,'G') &amp;&amp; mode ~= 3 </span><br/>               <span style="color: #A0A0A0"> 272</span> <span style="color: #A0A0A0; background: #FFFFFF;">                workd(:,cols(1)) = workd(:,cols(2));</span><br/>               <span style="color: #A0A0A0"> 273</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>       <span style="color: #0000FF">    217 </span><span style="color: #000000; font-weight: bold"> 274</span> <span style="color: #000000; background: #FFFFFF;">        case 1 </span><br/>       <span style="color: #0000FF">     53 </span><span style="color: #000000; font-weight: bold"> 275</span> <span style="color: #000000; background: #FFFFFF;">            if strcmp(style,'G') &amp;&amp; mode == 3 &amp;&amp; (isempty(B) || BisHpd) </span><br/>               <span style="color: #A0A0A0"> 276</span> <span style="color: #228B22; background: #FFFFFF;">                % use with B-inner product for mode 3; see applyM</span><br/><span style="color: #FF0000">  0.25 </span><span style="color: #0000FF">     53 </span><span style="color: #000000; font-weight: bold"> 277</span> <a name="Line277"></a><span style="color: #000000; background: #FFFFFF;">                workd(:,cols(2)) = <a href="file126.html">AminusSigmaBsolve</a>(workd(:,cols(3))); </span><br/>               <span style="color: #A0A0A0"> 278</span> <span style="color: #228B22; background: #FFFFFF;">            else</span><br/>               <span style="color: #A0A0A0"> 279</span> <span style="color: #228B22; background: #FFFFFF;">                % same work as case -1</span><br/>               <span style="color: #A0A0A0"> 280</span> <span style="color: #A0A0A0; background: #FFFFFF;">                workd(:,cols(2)) = applyOP(workd(:,cols(1)));</span><br/>               <span style="color: #A0A0A0"> 281</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if strcmp(style,'G') &amp;&amp; mode ~= 3</span><br/>               <span style="color: #A0A0A0"> 282</span> <span style="color: #228B22; background: #FFFFFF;">                    % use with std inner product; see applyM</span><br/>               <span style="color: #A0A0A0"> 283</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    workd(:,cols(1)) = workd(:,cols(2));</span><br/>               <span style="color: #A0A0A0"> 284</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 285</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>       <span style="color: #0000FF">    164 </span><span style="color: #000000; font-weight: bold"> 286</span> <span style="color: #000000; background: #FFFFFF;">        case 2 </span><br/>       <span style="color: #0000FF">    163 </span><span style="color: #000000; font-weight: bold"> 287</span> <span style="color: #000000; background: #FFFFFF;">            workd(:,cols(2)) = applyM(workd(:,cols(1))); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 288</span> <span style="color: #000000; background: #FFFFFF;">        case 99 </span><br/>               <span style="color: #A0A0A0"> 289</span> <span style="color: #228B22; background: #FFFFFF;">            % ARPACK has converged</span><br/>               <span style="color: #A0A0A0"> 290</span> <span style="color: #A0A0A0; background: #FFFFFF;">        otherwise</span><br/>               <span style="color: #A0A0A0"> 291</span> <span style="color: #A0A0A0; background: #FFFFFF;">            error('MATLAB:eigs:UnknownIdo','Unknown ido.');</span><br/>               <span style="color: #A0A0A0"> 292</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 293</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>       <span style="color: #0000FF">    218 </span><span style="color: #000000; font-weight: bold"> 294</span> <span style="color: #000000; background: #FFFFFF;">    cputms(3) = cputms(3) + (cputime-t0); % end timing MATLAB OP(X) </span><br/>               <span style="color: #A0A0A0"> 295</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>       <span style="color: #0000FF">    218 </span><span style="color: #000000; font-weight: bold"> 296</span> <span style="color: #000000; background: #FFFFFF;">    if eigs_display </span><br/>               <span style="color: #A0A0A0"> 297</span> <span style="color: #A0A0A0; background: #FFFFFF;">        displayRitzValues;</span><br/>               <span style="color: #A0A0A0"> 298</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 299</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">    218 </span><span style="color: #000000; font-weight: bold"> 300</span> <span style="color: #000000; background: #FFFFFF;">end % while (ido ~= 99) </span><br/>               <span style="color: #A0A0A0"> 301</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 302</span> <span style="color: #000000; background: #FFFFFF;">t0 = cputime; % start timing post-processing </span><br/>               <span style="color: #A0A0A0"> 303</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 304</span> <span style="color: #000000; background: #FFFFFF;">if (info &lt; 0) </span><br/>               <span style="color: #A0A0A0"> 305</span> <span style="color: #A0A0A0; background: #FFFFFF;">    error('MATLAB:eigs:ARPACKroutineError', ...</span><br/>               <span style="color: #A0A0A0"> 306</span> <span style="color: #A0A0A0; background: #FFFFFF;">        'Error with ARPACK routine %s: info = %d',aupdfun,full(info));</span><br/>               <span style="color: #A0A0A0"> 307</span> <span style="color: #A0A0A0; background: #FFFFFF;">end % if (info &lt; 0)</span><br/>               <span style="color: #A0A0A0"> 308</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 309</span> <span style="color: #000000; background: #FFFFFF;">if (nargout &gt;= 2) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 310</span> <span style="color: #000000; background: #FFFFFF;">   rvec = intconvert(true); % compute eigenvectors </span><br/>               <span style="color: #A0A0A0"> 311</span> <span style="color: #228B22; background: #FFFFFF;">else</span><br/>               <span style="color: #A0A0A0"> 312</span> <span style="color: #A0A0A0; background: #FFFFFF;">   rvec = intconvert(false); % do not compute eigenvectors</span><br/>               <span style="color: #A0A0A0"> 313</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 314</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 315</span> <span style="color: #000000; background: #FFFFFF;">if isrealprob </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 316</span> <span style="color: #000000; background: #FFFFFF;">    if issymA </span><br/>               <span style="color: #A0A0A0"> 317</span> <span style="color: #A0A0A0; background: #FFFFFF;">        arpackc( eupdfun, rvec, 'A', select, ...</span><br/>               <span style="color: #A0A0A0"> 318</span> <span style="color: #A0A0A0; background: #FFFFFF;">            d, v, ldv, sigma, ...</span><br/>               <span style="color: #A0A0A0"> 319</span> <span style="color: #A0A0A0; background: #FFFFFF;">         bmat, intconvert(n), whch, nev, tol, resid, ncv, ...</span><br/>               <span style="color: #A0A0A0"> 320</span> <span style="color: #A0A0A0; background: #FFFFFF;">            v, ldv, iparam, ipntr, workd, workl, lworkl, info );</span><br/>               <span style="color: #A0A0A0"> 321</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if strcmp(whch,'LM') || strcmp(whch,'LA')</span><br/>               <span style="color: #A0A0A0"> 322</span> <span style="color: #A0A0A0; background: #FFFFFF;">            d = flipud(d);</span><br/>               <span style="color: #A0A0A0"> 323</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if (rvec == 1)</span><br/>               <span style="color: #A0A0A0"> 324</span> <span style="color: #A0A0A0; background: #FFFFFF;">                v(:,1:k) = v(:,k:-1:1);</span><br/>               <span style="color: #A0A0A0"> 325</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 326</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 327</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if ((strcmp(whch,'SM') || strcmp(whch,'SA')) &amp;&amp; (rvec == 0))</span><br/>               <span style="color: #A0A0A0"> 328</span> <span style="color: #A0A0A0; background: #FFFFFF;">            d = flipud(d);</span><br/>               <span style="color: #A0A0A0"> 329</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 330</span> <span style="color: #228B22; background: #FFFFFF;">    else </span><br/>               <span style="color: #A0A0A0"> 331</span> <span style="color: #228B22; background: #FFFFFF;">        % If sigma is complex, isrealprob=true and we use [c,z]neupd.</span><br/>               <span style="color: #A0A0A0"> 332</span> <span style="color: #228B22; background: #FFFFFF;">        % So use sigmar=sigma and sigmai=0 here in dneupd.</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 333</span> <span style="color: #000000; background: #FFFFFF;">        <a href="file123.html">arpackc</a>( eupdfun, rvec, 'A', select, ... </span><br/>               <span style="color: #A0A0A0"> 334</span> <span style="color: #000000; background: #FFFFFF;">            d, di, v, ldv, sigma, 0, workev, ...</span><br/>               <span style="color: #A0A0A0"> 335</span> <span style="color: #000000; background: #FFFFFF;">         bmat, intconvert(n), whch, nev, tol, resid, ncv, ...</span><br/>               <span style="color: #A0A0A0"> 336</span> <span style="color: #000000; background: #FFFFFF;">            v, ldv, iparam, ipntr, workd, workl, lworkl, info );</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 337</span> <span style="color: #000000; background: #FFFFFF;">        d = complex(d,di); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 338</span> <span style="color: #000000; background: #FFFFFF;">        if rvec </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 339</span> <span style="color: #000000; background: #FFFFFF;">            d(k+1) = []; </span><br/>               <span style="color: #A0A0A0"> 340</span> <span style="color: #228B22; background: #FFFFFF;">        else</span><br/>               <span style="color: #A0A0A0"> 341</span> <span style="color: #A0A0A0; background: #FFFFFF;">            zind = find(d == 0);</span><br/>               <span style="color: #A0A0A0"> 342</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if isempty(zind)</span><br/>               <span style="color: #A0A0A0"> 343</span> <span style="color: #A0A0A0; background: #FFFFFF;">                d = d(k+1:-1:2);</span><br/>               <span style="color: #A0A0A0"> 344</span> <span style="color: #228B22; background: #FFFFFF;">            else</span><br/>               <span style="color: #A0A0A0"> 345</span> <span style="color: #A0A0A0; background: #FFFFFF;">                d(max(zind)) = [];</span><br/>               <span style="color: #A0A0A0"> 346</span> <span style="color: #A0A0A0; background: #FFFFFF;">                d = flipud(d);</span><br/>               <span style="color: #A0A0A0"> 347</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 348</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 349</span> <span style="color: #000000; background: #FFFFFF;">    end </span><br/>               <span style="color: #A0A0A0"> 350</span> <span style="color: #228B22; background: #FFFFFF;">else</span><br/>               <span style="color: #A0A0A0"> 351</span> <span style="color: #A0A0A0; background: #FFFFFF;">    zsigma = [real(sigma); imag(sigma)];</span><br/>               <span style="color: #A0A0A0"> 352</span> <span style="color: #A0A0A0; background: #FFFFFF;">    arpackc( eupdfun, rvec, 'A', select, ...</span><br/>               <span style="color: #A0A0A0"> 353</span> <span style="color: #A0A0A0; background: #FFFFFF;">        zd, zv, ldv, zsigma, workev, ...</span><br/>               <span style="color: #A0A0A0"> 354</span> <span style="color: #A0A0A0; background: #FFFFFF;">      bmat, intconvert(n), whch, nev, tol, resid, ncv, zv, ...</span><br/>               <span style="color: #A0A0A0"> 355</span> <span style="color: #A0A0A0; background: #FFFFFF;">        ldv, iparam, ipntr, zworkd, workl, lworkl, ...</span><br/>               <span style="color: #A0A0A0"> 356</span> <span style="color: #A0A0A0; background: #FFFFFF;">        rwork, info );</span><br/>               <span style="color: #A0A0A0"> 357</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if issymA</span><br/>               <span style="color: #A0A0A0"> 358</span> <span style="color: #A0A0A0; background: #FFFFFF;">        d = zd(1:2:end-1);</span><br/>               <span style="color: #A0A0A0"> 359</span> <span style="color: #228B22; background: #FFFFFF;">    else</span><br/>               <span style="color: #A0A0A0"> 360</span> <span style="color: #A0A0A0; background: #FFFFFF;">        d = complex(zd(1:2:end-1),zd(2:2:end));</span><br/>               <span style="color: #A0A0A0"> 361</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 362</span> <span style="color: #A0A0A0; background: #FFFFFF;">    v = reshape(complex(zv(1:2:end-1),zv(2:2:end)),[n p]);</span><br/>               <span style="color: #A0A0A0"> 363</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 364</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 365</span> <span style="color: #000000; background: #FFFFFF;">flag = <a href="file128.html">processEUPDinfo</a>(nargin&lt;3); </span><br/>               <span style="color: #A0A0A0"> 366</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 367</span> <span style="color: #000000; background: #FFFFFF;">if (issymA) || (~isrealprob) </span><br/>               <span style="color: #A0A0A0"> 368</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if (nargout &lt;= 1)</span><br/>               <span style="color: #A0A0A0"> 369</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if isrealprob</span><br/>               <span style="color: #A0A0A0"> 370</span> <span style="color: #A0A0A0; background: #FFFFFF;">            varargout{1} = d;</span><br/>               <span style="color: #A0A0A0"> 371</span> <span style="color: #228B22; background: #FFFFFF;">        else</span><br/>               <span style="color: #A0A0A0"> 372</span> <span style="color: #A0A0A0; background: #FFFFFF;">            varargout{1} = d(k:-1:1,1);</span><br/>               <span style="color: #A0A0A0"> 373</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 374</span> <span style="color: #228B22; background: #FFFFFF;">    else</span><br/>               <span style="color: #A0A0A0"> 375</span> <span style="color: #A0A0A0; background: #FFFFFF;">        varargout{1} = v(:,1:k);</span><br/>               <span style="color: #A0A0A0"> 376</span> <span style="color: #A0A0A0; background: #FFFFFF;">        varargout{2} = diag(d(1:k,1));</span><br/>               <span style="color: #A0A0A0"> 377</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if (nargout &gt;= 3)</span><br/>               <span style="color: #A0A0A0"> 378</span> <span style="color: #A0A0A0; background: #FFFFFF;">            varargout{3} = flag;</span><br/>               <span style="color: #A0A0A0"> 379</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 380</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 381</span> <span style="color: #228B22; background: #FFFFFF;">else </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 382</span> <span style="color: #000000; background: #FFFFFF;">    if (nargout &lt;= 1) </span><br/>               <span style="color: #A0A0A0"> 383</span> <span style="color: #A0A0A0; background: #FFFFFF;">        varargout{1} = d;</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 384</span> <span style="color: #228B22; background: #FFFFFF;">    else </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 385</span> <span style="color: #000000; background: #FFFFFF;">        cplxd = find(di ~= 0); </span><br/>               <span style="color: #A0A0A0"> 386</span> <span style="color: #228B22; background: #FFFFFF;">        % complex conjugate pairs of eigenvalues occur together</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 387</span> <span style="color: #000000; background: #FFFFFF;">        cplxd = cplxd(1:2:end); </span><br/><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 388</span> <a name="Line388"></a><span style="color: #000000; background: #FFFFFF;">        v(:,[cplxd cplxd+1]) = [complex(v(:,cplxd),v(:,cplxd+1)) ... </span><br/>               <span style="color: #A0A0A0"> 389</span> <span style="color: #000000; background: #FFFFFF;">            complex(v(:,cplxd),-v(:,cplxd+1))];</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 390</span> <span style="color: #000000; background: #FFFFFF;">        varargout{1} = v(:,1:k); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 391</span> <span style="color: #000000; background: #FFFFFF;">        varargout{2} = diag(d); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 392</span> <span style="color: #000000; background: #FFFFFF;">        if (nargout &gt;= 3) </span><br/>               <span style="color: #A0A0A0"> 393</span> <span style="color: #A0A0A0; background: #FFFFFF;">            varargout{3} = flag;</span><br/>               <span style="color: #A0A0A0"> 394</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 395</span> <span style="color: #000000; background: #FFFFFF;">    end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 396</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0"> 397</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 398</span> <span style="color: #000000; background: #FFFFFF;">if (nargout &gt;= 2) &amp;&amp; (mode ~= 3) &amp;&amp; ~isempty(B) &amp;&amp; BisHpd == true </span><br/>               <span style="color: #A0A0A0"> 399</span> <span style="color: #A0A0A0; background: #FFFFFF;">    varargout{1} = RBsolve(varargout{1});</span><br/>               <span style="color: #A0A0A0"> 400</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 401</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 402</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(B) </span><br/>               <span style="color: #A0A0A0"> 403</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if nargout &gt;= 2</span><br/>               <span style="color: #A0A0A0"> 404</span> <span style="color: #A0A0A0; background: #FFFFFF;">        varargout{2} = varargout{2}/scaleB;</span><br/>               <span style="color: #A0A0A0"> 405</span> <span style="color: #228B22; background: #FFFFFF;">    else</span><br/>               <span style="color: #A0A0A0"> 406</span> <span style="color: #A0A0A0; background: #FFFFFF;">        varargout{1} = varargout{1}/scaleB;</span><br/>               <span style="color: #A0A0A0"> 407</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 408</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 409</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 410</span> <span style="color: #000000; background: #FFFFFF;">if BisHpd == true &amp;&amp; (nargout &gt;= 2) </span><br/>               <span style="color: #A0A0A0"> 411</span> <span style="color: #A0A0A0; background: #FFFFFF;">    vnorms = zeros(k,1);</span><br/>               <span style="color: #A0A0A0"> 412</span> <span style="color: #A0A0A0; background: #FFFFFF;">    for ii = 1 : k</span><br/>               <span style="color: #A0A0A0"> 413</span> <span style="color: #A0A0A0; background: #FFFFFF;">        vnorms(ii) = scaleB*(varargout{1}(:,ii)'*(Bmtimes(varargout{1}(:,ii))));</span><br/>               <span style="color: #A0A0A0"> 414</span> <span style="color: #A0A0A0; background: #FFFFFF;">        varargout{1}(:,ii) = varargout{1}(:,ii)/sqrt(vnorms(ii));</span><br/>               <span style="color: #A0A0A0"> 415</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 416</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 417</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 418</span> <span style="color: #000000; background: #FFFFFF;">cputms(4) = cputime-t0; % end timing post-processing </span><br/>               <span style="color: #A0A0A0"> 419</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 420</span> <span style="color: #000000; background: #FFFFFF;">cputms(5) = sum(cputms(1:4)); % total time </span><br/>               <span style="color: #A0A0A0"> 421</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 422</span> <span style="color: #000000; background: #FFFFFF;">if (eigs_display == 2) </span><br/>               <span style="color: #A0A0A0"> 423</span> <span style="color: #A0A0A0; background: #FFFFFF;">    printTimings;</span><br/>               <span style="color: #A0A0A0"> 424</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 425</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 426</span> <span style="color: #228B22; background: #FFFFFF;">%-------------------------------------------------------------------------%</span><br/>               <span style="color: #A0A0A0"> 427</span> <span style="color: #228B22; background: #FFFFFF;">% Nested functions</span><br/>               <span style="color: #A0A0A0"> 428</span> <span style="color: #228B22; background: #FFFFFF;">%-------------------------------------------------------------------------%</span><br/>               <span style="color: #A0A0A0"> 429</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 430</span> <span style="color: #228B22; background: #FFFFFF;">% checkInputs error checks the inputs to EIGS and also derives some</span><br/>               <span style="color: #A0A0A0"> 431</span> <span style="color: #228B22; background: #FFFFFF;">%   variables from them:</span><br/>               <span style="color: #A0A0A0"> 432</span> <span style="color: #228B22; background: #FFFFFF;">% A may be a matrix or a function applying OP.</span><br/>               <span style="color: #A0A0A0"> 433</span> <span style="color: #228B22; background: #FFFFFF;">% Amatrix is true if A is a matrix, false if A is a function.</span><br/>               <span style="color: #A0A0A0"> 434</span> <span style="color: #228B22; background: #FFFFFF;">% isrealprob is true if all of A, B and sigma are real, false otherwise.</span><br/>               <span style="color: #A0A0A0"> 435</span> <span style="color: #228B22; background: #FFFFFF;">% issymA is true if A is symmetric, false otherwise.</span><br/>               <span style="color: #A0A0A0"> 436</span> <span style="color: #228B22; background: #FFFFFF;">% n is the size of (square) A and B.</span><br/>               <span style="color: #A0A0A0"> 437</span> <span style="color: #228B22; background: #FFFFFF;">% B is [] for the standard problem. Otherwise it may be one of B, CHOL(B)</span><br/>               <span style="color: #A0A0A0"> 438</span> <span style="color: #228B22; background: #FFFFFF;">%   or CHOL(B(permB,permB)).</span><br/>               <span style="color: #A0A0A0"> 439</span> <span style="color: #228B22; background: #FFFFFF;">% classAB is single if either A or B is single, otherwise double.</span><br/>               <span style="color: #A0A0A0"> 440</span> <span style="color: #228B22; background: #FFFFFF;">% k is the number of eigenvalues to be computed.</span><br/>               <span style="color: #A0A0A0"> 441</span> <span style="color: #228B22; background: #FFFFFF;">% eigs_sigma is the value for sigma passed in by the user, 'LM' if it was</span><br/>               <span style="color: #A0A0A0"> 442</span> <span style="color: #228B22; background: #FFFFFF;">%   unspecified. eigs_sigma may be either a string or a scalar value.</span><br/>               <span style="color: #A0A0A0"> 443</span> <span style="color: #228B22; background: #FFFFFF;">% whch is the ARPACK string corresponding to eigs_sigma and mode.</span><br/>               <span style="color: #A0A0A0"> 444</span> <span style="color: #228B22; background: #FFFFFF;">% sigma is the ARPACK scalar corresponding to eigs_sigma and mode.</span><br/>               <span style="color: #A0A0A0"> 445</span> <span style="color: #228B22; background: #FFFFFF;">% tol is the convergence tolerance.</span><br/>               <span style="color: #A0A0A0"> 446</span> <span style="color: #228B22; background: #FFFFFF;">% maxit is the maximum number of iterations.</span><br/>               <span style="color: #A0A0A0"> 447</span> <span style="color: #228B22; background: #FFFFFF;">% p is the number of Lanczos vectors.</span><br/>               <span style="color: #A0A0A0"> 448</span> <span style="color: #228B22; background: #FFFFFF;">% info is the start value, initialized to 1 or 0 to indicate whether to use</span><br/>               <span style="color: #A0A0A0"> 449</span> <span style="color: #228B22; background: #FFFFFF;">% resid as the start vector or not.</span><br/>               <span style="color: #A0A0A0"> 450</span> <span style="color: #228B22; background: #FFFFFF;">% eigs_display is true if Ritz values should be displayed, false otherwise.</span><br/>               <span style="color: #A0A0A0"> 451</span> <span style="color: #228B22; background: #FFFFFF;">% cholB is true if CHOL(B) was passed in instead of B, false otherwise.</span><br/>               <span style="color: #A0A0A0"> 452</span> <span style="color: #228B22; background: #FFFFFF;">% permB may be [], otherwise it is the permutation in CHOL(B(permB,permB)).</span><br/>               <span style="color: #A0A0A0"> 453</span> <span style="color: #228B22; background: #FFFFFF;">% resid is the start vector if specified and info=1, otherwise all zero.</span><br/>               <span style="color: #A0A0A0"> 454</span> <span style="color: #228B22; background: #FFFFFF;">% useeig is true if we need to use EIG instead of ARPACK, otherwise false.</span><br/>               <span style="color: #A0A0A0"> 455</span> <span style="color: #228B22; background: #FFFFFF;">% afunNargs is the range of EIGS' varargin that are to be passed as</span><br/>               <span style="color: #A0A0A0"> 456</span> <span style="color: #228B22; background: #FFFFFF;">%   trailing parameters to the function as in afun(X,P1,P2,...).</span><br/>               <span style="color: #A0A0A0"> 457</span> <span style="color: #A0A0A0; background: #FFFFFF;">    function [A,Amatrix,isrealprob,issymA,n,B,classAB,k, ...</span><br/>               <span style="color: #A0A0A0"> 458</span> <span style="color: #A0A0A0; background: #FFFFFF;">            eigs_sigma,whch,sigma,tol,maxit,p,info,eigs_display,cholB,...</span><br/>               <span style="color: #A0A0A0"> 459</span> <span style="color: #A0A0A0; background: #FFFFFF;">            permB,resid,useeig,afunNargs,style,mode,Afactors,Bfactors] = checkInputs(varargin)</span><br/>               <span style="color: #A0A0A0"> 460</span> <span style="color: #228B22; background: #FFFFFF;">        % Process inputs and do error-checking</span><br/>               <span style="color: #A0A0A0"> 461</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 462</span> <span style="color: #228B22; background: #FFFFFF;">        % Process the input A or the inputs AFUN and N</span><br/>               <span style="color: #A0A0A0"> 463</span> <span style="color: #228B22; background: #FFFFFF;">        % Start to derive some qualities (real, symmetric) about the problem</span><br/>               <span style="color: #A0A0A0"> 464</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if isfloat(varargin{1})</span><br/>               <span style="color: #A0A0A0"> 465</span> <span style="color: #A0A0A0; background: #FFFFFF;">            A = varargin{1};</span><br/>               <span style="color: #A0A0A0"> 466</span> <span style="color: #A0A0A0; background: #FFFFFF;">            Amatrix = true;</span><br/>               <span style="color: #A0A0A0"> 467</span> <span style="color: #228B22; background: #FFFFFF;">        else</span><br/>               <span style="color: #A0A0A0"> 468</span> <span style="color: #228B22; background: #FFFFFF;">            % By checking the function A with fcnchk, we can now use direct</span><br/>               <span style="color: #A0A0A0"> 469</span> <span style="color: #228B22; background: #FFFFFF;">            % function evaluation on the result, without resorting to feval</span><br/>               <span style="color: #A0A0A0"> 470</span> <span style="color: #A0A0A0; background: #FFFFFF;">            A = fcnchk(varargin{1});</span><br/>               <span style="color: #A0A0A0"> 471</span> <span style="color: #A0A0A0; background: #FFFFFF;">            Amatrix = false;</span><br/>               <span style="color: #A0A0A0"> 472</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 473</span> <span style="color: #A0A0A0; background: #FFFFFF;">        isrealprob = true;</span><br/>               <span style="color: #A0A0A0"> 474</span> <span style="color: #A0A0A0; background: #FFFFFF;">        issymA = false;</span><br/>               <span style="color: #A0A0A0"> 475</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if Amatrix</span><br/>               <span style="color: #A0A0A0"> 476</span> <span style="color: #A0A0A0; background: #FFFFFF;">            isrealprob = isreal(A);</span><br/>               <span style="color: #A0A0A0"> 477</span> <span style="color: #A0A0A0; background: #FFFFFF;">            issymA = ishermitian(A);</span><br/>               <span style="color: #A0A0A0"> 478</span> <span style="color: #A0A0A0; background: #FFFFFF;">            [m,n] = size(A);</span><br/>               <span style="color: #A0A0A0"> 479</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if (m ~= n)</span><br/>               <span style="color: #A0A0A0"> 480</span> <span style="color: #A0A0A0; background: #FFFFFF;">                error('MATLAB:eigs:NonSquareMatrixOrFunction',...</span><br/>               <span style="color: #A0A0A0"> 481</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    'A must be a square matrix or a function.')</span><br/>               <span style="color: #A0A0A0"> 482</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 483</span> <span style="color: #228B22; background: #FFFFFF;">        else</span><br/>               <span style="color: #A0A0A0"> 484</span> <span style="color: #A0A0A0; background: #FFFFFF;">            n = varargin{2};</span><br/>               <span style="color: #A0A0A0"> 485</span> <span style="color: #A0A0A0; background: #FFFFFF;">            nstr = 'Size of problem, ''n'', must be a positive integer.';</span><br/>               <span style="color: #A0A0A0"> 486</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if ~isscalar(n) || ~isreal(n)</span><br/>               <span style="color: #A0A0A0"> 487</span> <span style="color: #A0A0A0; background: #FFFFFF;">                error('MATLAB:eigs:NonPosIntSize', nstr)</span><br/>               <span style="color: #A0A0A0"> 488</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 489</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if issparse(n)</span><br/>               <span style="color: #A0A0A0"> 490</span> <span style="color: #A0A0A0; background: #FFFFFF;">                n = full(n);</span><br/>               <span style="color: #A0A0A0"> 491</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 492</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if (round(n) ~= n)</span><br/>               <span style="color: #A0A0A0"> 493</span> <span style="color: #A0A0A0; background: #FFFFFF;">                warning('MATLAB:eigs:NonPosIntSize',['%s\n         ' ...</span><br/>               <span style="color: #A0A0A0"> 494</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    'Rounding input size.'],nstr)</span><br/>               <span style="color: #A0A0A0"> 495</span> <span style="color: #A0A0A0; background: #FFFFFF;">                n = round(n);</span><br/>               <span style="color: #A0A0A0"> 496</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 497</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 498</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 499</span> <span style="color: #228B22; background: #FFFFFF;">        % Process the input B and derive the class of the problem.</span><br/>               <span style="color: #A0A0A0"> 500</span> <span style="color: #228B22; background: #FFFFFF;">        % Is B present in the eigs call or not?</span><br/>               <span style="color: #A0A0A0"> 501</span> <span style="color: #A0A0A0; background: #FFFFFF;">        Bpresent = true;</span><br/>               <span style="color: #A0A0A0"> 502</span> <span style="color: #A0A0A0; background: #FFFFFF;">        Bstr = 'Generalized matrix B must be the same size as A.';</span><br/>               <span style="color: #A0A0A0"> 503</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if (nargin &lt; (3-Amatrix))</span><br/>               <span style="color: #A0A0A0"> 504</span> <span style="color: #A0A0A0; background: #FFFFFF;">            B = [];</span><br/>               <span style="color: #A0A0A0"> 505</span> <span style="color: #A0A0A0; background: #FFFFFF;">            Bpresent = false;</span><br/>               <span style="color: #A0A0A0"> 506</span> <span style="color: #228B22; background: #FFFFFF;">        else</span><br/>               <span style="color: #A0A0A0"> 507</span> <span style="color: #228B22; background: #FFFFFF;">            % Is the next input B or K?</span><br/>               <span style="color: #A0A0A0"> 508</span> <span style="color: #A0A0A0; background: #FFFFFF;">            B = varargin{3-Amatrix};</span><br/>               <span style="color: #A0A0A0"> 509</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if ~isempty(B) % allow eigs(A,[],k,sigma,opts);</span><br/>               <span style="color: #A0A0A0"> 510</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if isscalar(B)</span><br/>               <span style="color: #A0A0A0"> 511</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    if n ~= 1</span><br/>               <span style="color: #A0A0A0"> 512</span> <span style="color: #228B22; background: #FFFFFF;">                        % this input is really K and B is not specified</span><br/>               <span style="color: #A0A0A0"> 513</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        B = [];</span><br/>               <span style="color: #A0A0A0"> 514</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        Bpresent = false;</span><br/>               <span style="color: #A0A0A0"> 515</span> <span style="color: #228B22; background: #FFFFFF;">                    else</span><br/>               <span style="color: #A0A0A0"> 516</span> <span style="color: #228B22; background: #FFFFFF;">                        % This input could be B or K.</span><br/>               <span style="color: #A0A0A0"> 517</span> <span style="color: #228B22; background: #FFFFFF;">                        % If A is scalar, then the only valid value for k is 1.</span><br/>               <span style="color: #A0A0A0"> 518</span> <span style="color: #228B22; background: #FFFFFF;">                        % So if this input is scalar, let it be B, namely</span><br/>               <span style="color: #A0A0A0"> 519</span> <span style="color: #228B22; background: #FFFFFF;">                        % eigs(4,2,...) assumes A=4, B=2, NOT A=4, k=2</span><br/>               <span style="color: #A0A0A0"> 520</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        if ~isnumeric(B)</span><br/>               <span style="color: #A0A0A0"> 521</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            error('MATLAB:eigs:BsizeMismatchA', Bstr);</span><br/>               <span style="color: #A0A0A0"> 522</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        end</span><br/>               <span style="color: #A0A0A0"> 523</span> <span style="color: #228B22; background: #FFFFFF;">                        % Unless, of course, the scalar is 1, in which case</span><br/>               <span style="color: #A0A0A0"> 524</span> <span style="color: #228B22; background: #FFFFFF;">                        % assume the that it is meant to be K.</span><br/>               <span style="color: #A0A0A0"> 525</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        if (B == 1) &amp;&amp; ((Amatrix &amp;&amp; nargin &lt;= 3) || ...</span><br/>               <span style="color: #A0A0A0"> 526</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                (~Amatrix &amp;&amp; nargin &lt;= 4))</span><br/>               <span style="color: #A0A0A0"> 527</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            B = [];</span><br/>               <span style="color: #A0A0A0"> 528</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            Bpresent = false;</span><br/>               <span style="color: #A0A0A0"> 529</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        elseif ~isfloat(B)</span><br/>               <span style="color: #A0A0A0"> 530</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            error('MATLAB:eigs:BsizeMismatchA', Bstr);</span><br/>               <span style="color: #A0A0A0"> 531</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        end</span><br/>               <span style="color: #A0A0A0"> 532</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    end</span><br/>               <span style="color: #A0A0A0"> 533</span> <span style="color: #228B22; background: #FFFFFF;">                else</span><br/>               <span style="color: #A0A0A0"> 534</span> <span style="color: #228B22; background: #FFFFFF;">                    % B is a not a scalar.</span><br/>               <span style="color: #A0A0A0"> 535</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    if ~isfloat(B) || ~isequal(size(B),[n,n])</span><br/>               <span style="color: #A0A0A0"> 536</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        error('MATLAB:eigs:BsizeMismatchA', Bstr);</span><br/>               <span style="color: #A0A0A0"> 537</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    end</span><br/>               <span style="color: #A0A0A0"> 538</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    isrealprob = isrealprob &amp;&amp; isreal(B);</span><br/>               <span style="color: #A0A0A0"> 539</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 540</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 541</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 542</span> <span style="color: #228B22; background: #FFFFFF;">        % ARPACK can only handle homogeneous inputs</span><br/>               <span style="color: #A0A0A0"> 543</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if Amatrix</span><br/>               <span style="color: #A0A0A0"> 544</span> <span style="color: #A0A0A0; background: #FFFFFF;">            classAB = superiorfloat(A,B);</span><br/>               <span style="color: #A0A0A0"> 545</span> <span style="color: #A0A0A0; background: #FFFFFF;">            A = cast(A,classAB);</span><br/>               <span style="color: #A0A0A0"> 546</span> <span style="color: #A0A0A0; background: #FFFFFF;">            B = cast(B,classAB);</span><br/>               <span style="color: #A0A0A0"> 547</span> <span style="color: #228B22; background: #FFFFFF;">        else</span><br/>               <span style="color: #A0A0A0"> 548</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if ~isempty(B)</span><br/>               <span style="color: #A0A0A0"> 549</span> <span style="color: #A0A0A0; background: #FFFFFF;">                classAB = class(B);</span><br/>               <span style="color: #A0A0A0"> 550</span> <span style="color: #228B22; background: #FFFFFF;">            else</span><br/>               <span style="color: #A0A0A0"> 551</span> <span style="color: #A0A0A0; background: #FFFFFF;">                classAB = 'double';</span><br/>               <span style="color: #A0A0A0"> 552</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 553</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 554</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 555</span> <span style="color: #228B22; background: #FFFFFF;">        % argOffset tells us where to get the eigs inputs K, SIGMA and OPTS.</span><br/>               <span style="color: #A0A0A0"> 556</span> <span style="color: #228B22; background: #FFFFFF;">        % If A is really the function afun, then it also helps us find the</span><br/>               <span style="color: #A0A0A0"> 557</span> <span style="color: #228B22; background: #FFFFFF;">        % trailing parameters in eigs(afun,n,[B],k,sigma,opts,P1,P2,...)</span><br/>               <span style="color: #A0A0A0"> 558</span> <span style="color: #228B22; background: #FFFFFF;">        % Values of argOffset:</span><br/>               <span style="color: #A0A0A0"> 559</span> <span style="color: #228B22; background: #FFFFFF;">        %  0: Amatrix is false and Bpresent is true:</span><br/>               <span style="color: #A0A0A0"> 560</span> <span style="color: #228B22; background: #FFFFFF;">        %     eigs(afun,n,B,k,sigma,opts,P1,P2,...)</span><br/>               <span style="color: #A0A0A0"> 561</span> <span style="color: #228B22; background: #FFFFFF;">        %  1: Amatrix and Bpresent are both true, or both false</span><br/>               <span style="color: #A0A0A0"> 562</span> <span style="color: #228B22; background: #FFFFFF;">        %     eigs(A,B,k,sigma,opts)</span><br/>               <span style="color: #A0A0A0"> 563</span> <span style="color: #228B22; background: #FFFFFF;">        %     eigs(afun,n,k,sigma,opts,P1,P2,...)</span><br/>               <span style="color: #A0A0A0"> 564</span> <span style="color: #228B22; background: #FFFFFF;">        %  2: Amatrix is true and Bpresent is false:</span><br/>               <span style="color: #A0A0A0"> 565</span> <span style="color: #228B22; background: #FFFFFF;">        %     eigs(A,k,sigma,opts)</span><br/>               <span style="color: #A0A0A0"> 566</span> <span style="color: #A0A0A0; background: #FFFFFF;">        argOffset = Amatrix + ~Bpresent;</span><br/>               <span style="color: #A0A0A0"> 567</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 568</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if Amatrix &amp;&amp; ((nargin - Bpresent)&gt;4)</span><br/>               <span style="color: #A0A0A0"> 569</span> <span style="color: #A0A0A0; background: #FFFFFF;">            error('MATLAB:eigs:TooManyInputs', 'Too many inputs.')</span><br/>               <span style="color: #A0A0A0"> 570</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 571</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 572</span> <span style="color: #228B22; background: #FFFFFF;">        % Process the input K.</span><br/>               <span style="color: #A0A0A0"> 573</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if (nargin &lt; (4-argOffset))</span><br/>               <span style="color: #A0A0A0"> 574</span> <span style="color: #A0A0A0; background: #FFFFFF;">            k = min(n,6);</span><br/>               <span style="color: #A0A0A0"> 575</span> <span style="color: #228B22; background: #FFFFFF;">        else</span><br/>               <span style="color: #A0A0A0"> 576</span> <span style="color: #A0A0A0; background: #FFFFFF;">            k = varargin{4-argOffset};</span><br/>               <span style="color: #A0A0A0"> 577</span> <span style="color: #A0A0A0; background: #FFFFFF;">            kstr = ['Number of eigenvalues requested, k, must be a' ...</span><br/>               <span style="color: #A0A0A0"> 578</span> <span style="color: #A0A0A0; background: #FFFFFF;">                ' positive integer &lt;= n.'];</span><br/>               <span style="color: #A0A0A0"> 579</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if ~isnumeric(k) || ~isscalar(k) || ~isreal(k) || (k&gt;n)</span><br/>               <span style="color: #A0A0A0"> 580</span> <span style="color: #A0A0A0; background: #FFFFFF;">                error('MATLAB:eigs:NonIntegerEigQty', kstr)</span><br/>               <span style="color: #A0A0A0"> 581</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 582</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if issparse(k)</span><br/>               <span style="color: #A0A0A0"> 583</span> <span style="color: #A0A0A0; background: #FFFFFF;">                k = full(k);</span><br/>               <span style="color: #A0A0A0"> 584</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 585</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if (round(k) ~= k)</span><br/>               <span style="color: #A0A0A0"> 586</span> <span style="color: #A0A0A0; background: #FFFFFF;">                warning('MATLAB:eigs:NonIntegerEigQty',['%s\n         ' ...</span><br/>               <span style="color: #A0A0A0"> 587</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    'Rounding number of eigenvalues.'],kstr)</span><br/>               <span style="color: #A0A0A0"> 588</span> <span style="color: #A0A0A0; background: #FFFFFF;">                k = round(k);</span><br/>               <span style="color: #A0A0A0"> 589</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 590</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 591</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 592</span> <span style="color: #228B22; background: #FFFFFF;">        % Process the input SIGMA and derive ARPACK values whch and sigma.</span><br/>               <span style="color: #A0A0A0"> 593</span> <span style="color: #228B22; background: #FFFFFF;">        % eigs_sigma is the value documented in the help as "SIGMA" that is</span><br/>               <span style="color: #A0A0A0"> 594</span> <span style="color: #228B22; background: #FFFFFF;">        % passed in to EIGS. eigs_sigma may be either a scalar, including 0,</span><br/>               <span style="color: #A0A0A0"> 595</span> <span style="color: #228B22; background: #FFFFFF;">        % or a string, including 'SM'.</span><br/>               <span style="color: #A0A0A0"> 596</span> <span style="color: #228B22; background: #FFFFFF;">        % In ARPACK, eigs_sigma corresponds to two variables:</span><br/>               <span style="color: #A0A0A0"> 597</span> <span style="color: #228B22; background: #FFFFFF;">        % 1.  which, called "whch" to avoid conflict with MATLAB's function</span><br/>               <span style="color: #A0A0A0"> 598</span> <span style="color: #228B22; background: #FFFFFF;">        % 2.  sigma</span><br/>               <span style="color: #A0A0A0"> 599</span> <span style="color: #228B22; background: #FFFFFF;">        % whch is always a string. sigma is always a scalar.</span><br/>               <span style="color: #A0A0A0"> 600</span> <span style="color: #228B22; background: #FFFFFF;">        % Valid combinations are shown below. Note eigs_sigma = 0/'SM' has</span><br/>               <span style="color: #A0A0A0"> 601</span> <span style="color: #228B22; background: #FFFFFF;">        % the same sigma/whch values as eigs_sigma='LM' (default) so these</span><br/>               <span style="color: #A0A0A0"> 602</span> <span style="color: #228B22; background: #FFFFFF;">        % must be distinguished by the mode.</span><br/>               <span style="color: #A0A0A0"> 603</span> <span style="color: #228B22; background: #FFFFFF;">        % eigs_sigma = 'SM' or 0 =&gt; sigma = 0, whch = 'LM' (mode=3)</span><br/>               <span style="color: #A0A0A0"> 604</span> <span style="color: #228B22; background: #FFFFFF;">        % eigs_sigma is a string not 'SM' =&gt; sigma = 0, whch = eigs_sigma (mode=1)</span><br/>               <span style="color: #A0A0A0"> 605</span> <span style="color: #228B22; background: #FFFFFF;">        % eigs_sigma is any scalar =&gt; sigma = eigs_sigma, whch = 'LM'</span><br/>               <span style="color: #A0A0A0"> 606</span> <span style="color: #228B22; background: #FFFFFF;">        % (mode=1)</span><br/>               <span style="color: #A0A0A0"> 607</span> <span style="color: #A0A0A0; background: #FFFFFF;">        whchstr = 'Eigenvalue range sigma must be a valid 2-element string.';</span><br/>               <span style="color: #A0A0A0"> 608</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if (nargin &lt; (5-argOffset))</span><br/>               <span style="color: #A0A0A0"> 609</span> <span style="color: #228B22; background: #FFFFFF;">            % default: eigs 'LM' =&gt; ARPACK which='LM', sigma=0</span><br/>               <span style="color: #A0A0A0"> 610</span> <span style="color: #A0A0A0; background: #FFFFFF;">            eigs_sigma = 'LM';</span><br/>               <span style="color: #A0A0A0"> 611</span> <span style="color: #A0A0A0; background: #FFFFFF;">            whch = 'LM';</span><br/>               <span style="color: #A0A0A0"> 612</span> <span style="color: #A0A0A0; background: #FFFFFF;">            sigma = 0;</span><br/>               <span style="color: #A0A0A0"> 613</span> <span style="color: #228B22; background: #FFFFFF;">        else</span><br/>               <span style="color: #A0A0A0"> 614</span> <span style="color: #A0A0A0; background: #FFFFFF;">            eigs_sigma = varargin{5-argOffset};</span><br/>               <span style="color: #A0A0A0"> 615</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if ischar(eigs_sigma)</span><br/>               <span style="color: #A0A0A0"> 616</span> <span style="color: #228B22; background: #FFFFFF;">                % eigs(string) =&gt; ARPACK which=string, sigma=0</span><br/>               <span style="color: #A0A0A0"> 617</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if ~isequal(size(eigs_sigma),[1,2])</span><br/>               <span style="color: #A0A0A0"> 618</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    error('MATLAB:eigs:EigenvalueRangeNotValid', ...</span><br/>               <span style="color: #A0A0A0"> 619</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        [whchstr '\nFor real symmetric A, the' ...</span><br/>               <span style="color: #A0A0A0"> 620</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        ' choices are ''%s'', ''%s'', ''%s'', ''%s'' or ''%s''.' ...</span><br/>               <span style="color: #A0A0A0"> 621</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        '\nFor non-symmetric or complex' ...</span><br/>               <span style="color: #A0A0A0"> 622</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        ' A, the choices are ''%s'', ''%s'', ''%s'', ''%s'',' ...</span><br/>               <span style="color: #A0A0A0"> 623</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        ' ''%s'' or ''%s''.\n'], ...</span><br/>               <span style="color: #A0A0A0"> 624</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        'LM','SM','LA','SA','BE','LM','SM','LR','SR','LI','SI')</span><br/>               <span style="color: #A0A0A0"> 625</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 626</span> <span style="color: #A0A0A0; background: #FFFFFF;">                eigs_sigma = upper(eigs_sigma);</span><br/>               <span style="color: #A0A0A0"> 627</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if strcmp(eigs_sigma,'SM')</span><br/>               <span style="color: #A0A0A0"> 628</span> <span style="color: #228B22; background: #FFFFFF;">                    % eigs('SM') =&gt; ARPACK which='LM', sigma=0</span><br/>               <span style="color: #A0A0A0"> 629</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    whch = 'LM';</span><br/>               <span style="color: #A0A0A0"> 630</span> <span style="color: #228B22; background: #FFFFFF;">                else</span><br/>               <span style="color: #A0A0A0"> 631</span> <span style="color: #228B22; background: #FFFFFF;">                    % eigs(string), where string~='SM' =&gt; ARPACK which=string, sigma=0</span><br/>               <span style="color: #A0A0A0"> 632</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    whch = eigs_sigma;</span><br/>               <span style="color: #A0A0A0"> 633</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 634</span> <span style="color: #A0A0A0; background: #FFFFFF;">                sigma = zeros(classAB);</span><br/>               <span style="color: #A0A0A0"> 635</span> <span style="color: #228B22; background: #FFFFFF;">            else</span><br/>               <span style="color: #A0A0A0"> 636</span> <span style="color: #228B22; background: #FFFFFF;">                % eigs(scalar) =&gt; ARPACK which='LM', sigma=scalar</span><br/>               <span style="color: #A0A0A0"> 637</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if ~isfloat(eigs_sigma) || ~isscalar(eigs_sigma)</span><br/>               <span style="color: #A0A0A0"> 638</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    error('MATLAB:eigs:EigenvalueShiftNonScalar',...</span><br/>               <span style="color: #A0A0A0"> 639</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        'Eigenvalue shift sigma must be a scalar.')</span><br/>               <span style="color: #A0A0A0"> 640</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 641</span> <span style="color: #A0A0A0; background: #FFFFFF;">                sigma = eigs_sigma;</span><br/>               <span style="color: #A0A0A0"> 642</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if issparse(sigma)</span><br/>               <span style="color: #A0A0A0"> 643</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    sigma = full(sigma);</span><br/>               <span style="color: #A0A0A0"> 644</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 645</span> <span style="color: #A0A0A0; background: #FFFFFF;">                sigma = cast(sigma,classAB);</span><br/>               <span style="color: #A0A0A0"> 646</span> <span style="color: #A0A0A0; background: #FFFFFF;">                isrealprob = isrealprob &amp;&amp; isreal(sigma);</span><br/>               <span style="color: #A0A0A0"> 647</span> <span style="color: #A0A0A0; background: #FFFFFF;">                whch = 'LM';</span><br/>               <span style="color: #A0A0A0"> 648</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 649</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 650</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 651</span> <span style="color: #228B22; background: #FFFFFF;">        % Process the input OPTS and derive some ARPACK values.</span><br/>               <span style="color: #A0A0A0"> 652</span> <span style="color: #228B22; background: #FFFFFF;">        % ARPACK's minimum tolerance is eps/2 ([S/D]LAMCH's EPS)</span><br/>               <span style="color: #A0A0A0"> 653</span> <span style="color: #A0A0A0; background: #FFFFFF;">        tol = eps(classAB);</span><br/>               <span style="color: #A0A0A0"> 654</span> <span style="color: #A0A0A0; background: #FFFFFF;">        maxit = [];</span><br/>               <span style="color: #A0A0A0"> 655</span> <span style="color: #A0A0A0; background: #FFFFFF;">        p = [];</span><br/>               <span style="color: #A0A0A0"> 656</span> <span style="color: #A0A0A0; background: #FFFFFF;">        style = [];</span><br/>               <span style="color: #A0A0A0"> 657</span> <span style="color: #228B22; background: #FFFFFF;">        % Always use resid as the start vector, whether it is OPTS.v0 or</span><br/>               <span style="color: #A0A0A0"> 658</span> <span style="color: #228B22; background: #FFFFFF;">        % randomly generated within eigs.  We default resid to empty here.</span><br/>               <span style="color: #A0A0A0"> 659</span> <span style="color: #228B22; background: #FFFFFF;">        % If the user does not initialize it, we provide a random residual</span><br/>               <span style="color: #A0A0A0"> 660</span> <span style="color: #228B22; background: #FFFFFF;">        % below.</span><br/>               <span style="color: #A0A0A0"> 661</span> <span style="color: #A0A0A0; background: #FFFFFF;">      info = intconvert(1);</span><br/>               <span style="color: #A0A0A0"> 662</span> <span style="color: #A0A0A0; background: #FFFFFF;">        resid = [];</span><br/>               <span style="color: #A0A0A0"> 663</span> <span style="color: #A0A0A0; background: #FFFFFF;">        eigs_display = 0;</span><br/>               <span style="color: #A0A0A0"> 664</span> <span style="color: #A0A0A0; background: #FFFFFF;">        cholB = false; % do we have B or its Cholesky factor?</span><br/>               <span style="color: #A0A0A0"> 665</span> <span style="color: #A0A0A0; background: #FFFFFF;">        permB = []; % if cholB, is it chol(B), or chol(B(permB,permB))?</span><br/>               <span style="color: #A0A0A0"> 666</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if (nargin &gt;= (6-argOffset))</span><br/>               <span style="color: #A0A0A0"> 667</span> <span style="color: #A0A0A0; background: #FFFFFF;">            opts = varargin{6-argOffset};</span><br/>               <span style="color: #A0A0A0"> 668</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if ~isa(opts,'struct')</span><br/>               <span style="color: #A0A0A0"> 669</span> <span style="color: #A0A0A0; background: #FFFFFF;">                error('MATLAB:eigs:OptionsNotStructure',...</span><br/>               <span style="color: #A0A0A0"> 670</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    'Options argument must be a structure.')</span><br/>               <span style="color: #A0A0A0"> 671</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 672</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if isfield(opts,'issym') &amp;&amp; ~Amatrix</span><br/>               <span style="color: #A0A0A0"> 673</span> <span style="color: #A0A0A0; background: #FFFFFF;">                issymA = opts.issym;</span><br/>               <span style="color: #A0A0A0"> 674</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if (issymA ~= false) &amp;&amp; (issymA ~= true)</span><br/>               <span style="color: #A0A0A0"> 675</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    error('MATLAB:eigs:InvalidOptsIssym', ...</span><br/>               <span style="color: #A0A0A0"> 676</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        'opts.issym must be true or false.')</span><br/>               <span style="color: #A0A0A0"> 677</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 678</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 679</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if isfield(opts,'isreal') &amp;&amp; ~Amatrix</span><br/>               <span style="color: #A0A0A0"> 680</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if (opts.isreal ~= false) &amp;&amp; (opts.isreal ~= true)</span><br/>               <span style="color: #A0A0A0"> 681</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    error('MATLAB:eigs:InvalidOptsIsreal', ...</span><br/>               <span style="color: #A0A0A0"> 682</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        'opts.isreal must be true or false.')</span><br/>               <span style="color: #A0A0A0"> 683</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 684</span> <span style="color: #A0A0A0; background: #FFFFFF;">                isrealprob = isrealprob &amp;&amp; opts.isreal;</span><br/>               <span style="color: #A0A0A0"> 685</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 686</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if ~isempty(B) &amp;&amp; (isfield(opts,'cholB') || isfield(opts,'permB'))</span><br/>               <span style="color: #A0A0A0"> 687</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if isfield(opts,'cholB')</span><br/>               <span style="color: #A0A0A0"> 688</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    cholB = opts.cholB;</span><br/>               <span style="color: #A0A0A0"> 689</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    if (cholB ~= false) &amp;&amp; (cholB ~= true)</span><br/>               <span style="color: #A0A0A0"> 690</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        error('MATLAB:eigs:InvalidOptsCholB', ...</span><br/>               <span style="color: #A0A0A0"> 691</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            'opts.cholB must be true or false.')</span><br/>               <span style="color: #A0A0A0"> 692</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    end</span><br/>               <span style="color: #A0A0A0"> 693</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    if isfield(opts,'permB')</span><br/>               <span style="color: #A0A0A0"> 694</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        if issparse(B) &amp;&amp; cholB</span><br/>               <span style="color: #A0A0A0"> 695</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            permB = opts.permB;</span><br/>               <span style="color: #A0A0A0"> 696</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            if ~isvector(permB) || ~isequal(sort(permB(:)),(1:n)')</span><br/>               <span style="color: #A0A0A0"> 697</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                error('MATLAB:eigs:InvalidOptsPermB',...</span><br/>               <span style="color: #A0A0A0"> 698</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                    'opts.permB must be a permutation of 1:n.')</span><br/>               <span style="color: #A0A0A0"> 699</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            end</span><br/>               <span style="color: #A0A0A0"> 700</span> <span style="color: #228B22; background: #FFFFFF;">                        else</span><br/>               <span style="color: #A0A0A0"> 701</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            warning('MATLAB:eigs:IgnoredOptionPermB', ...</span><br/>               <span style="color: #A0A0A0"> 702</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                ['Ignoring opts.permB since B is not its sparse' ...</span><br/>               <span style="color: #A0A0A0"> 703</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                ' Cholesky factor.'])</span><br/>               <span style="color: #A0A0A0"> 704</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        end</span><br/>               <span style="color: #A0A0A0"> 705</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    end</span><br/>               <span style="color: #A0A0A0"> 706</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 707</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 708</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if isfield(opts,'tol')</span><br/>               <span style="color: #A0A0A0"> 709</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if ~isfloat(tol) || ~isscalar(opts.tol) || ~isreal(opts.tol) || (opts.tol&lt;=0)</span><br/>               <span style="color: #A0A0A0"> 710</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    error('MATLAB:eigs:InvalidOptsTol',...</span><br/>               <span style="color: #A0A0A0"> 711</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        ['Convergence tolerance opts.tol must be a strictly' ...</span><br/>               <span style="color: #A0A0A0"> 712</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        ' positive real scalar.'])</span><br/>               <span style="color: #A0A0A0"> 713</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 714</span> <span style="color: #A0A0A0; background: #FFFFFF;">                tol = cast(full(opts.tol),classAB);</span><br/>               <span style="color: #A0A0A0"> 715</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 716</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if isfield(opts,'p')</span><br/>               <span style="color: #A0A0A0"> 717</span> <span style="color: #A0A0A0; background: #FFFFFF;">                p = opts.p;</span><br/>               <span style="color: #A0A0A0"> 718</span> <span style="color: #A0A0A0; background: #FFFFFF;">                pstr = ['Number of basis vectors opts.p must be a positive' ...</span><br/>               <span style="color: #A0A0A0"> 719</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ' integer &lt;= n.'];</span><br/>               <span style="color: #A0A0A0"> 720</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if ~isnumeric(p) || ~isscalar(p) || ~isreal(p) || (p&lt;=0) || (p&gt;n)</span><br/>               <span style="color: #A0A0A0"> 721</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    error('MATLAB:eigs:InvalidOptsP', pstr)</span><br/>               <span style="color: #A0A0A0"> 722</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 723</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if issparse(p)</span><br/>               <span style="color: #A0A0A0"> 724</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    p = full(p);</span><br/>               <span style="color: #A0A0A0"> 725</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 726</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if (round(p) ~= p)</span><br/>               <span style="color: #A0A0A0"> 727</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    warning('MATLAB:eigs:NonIntegerVecQty',['%s\n         ' ...</span><br/>               <span style="color: #A0A0A0"> 728</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        'Rounding number of basis vectors.'],pstr)</span><br/>               <span style="color: #A0A0A0"> 729</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    p = round(p);</span><br/>               <span style="color: #A0A0A0"> 730</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 731</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 732</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if isfield(opts,'maxit')</span><br/>               <span style="color: #A0A0A0"> 733</span> <span style="color: #A0A0A0; background: #FFFFFF;">                maxit = opts.maxit;</span><br/>               <span style="color: #A0A0A0"> 734</span> <span style="color: #A0A0A0; background: #FFFFFF;">                str = ['Maximum number of iterations opts.maxit must be' ...</span><br/>               <span style="color: #A0A0A0"> 735</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ' a positive integer.'];</span><br/>               <span style="color: #A0A0A0"> 736</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if ~isnumeric(maxit) || ~isscalar(maxit) || ~isreal(maxit) || (maxit&lt;=0)</span><br/>               <span style="color: #A0A0A0"> 737</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    error('MATLAB:eigs:OptsMaxitNotPosInt', str)</span><br/>               <span style="color: #A0A0A0"> 738</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 739</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if issparse(maxit)</span><br/>               <span style="color: #A0A0A0"> 740</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    maxit = full(maxit);</span><br/>               <span style="color: #A0A0A0"> 741</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 742</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if (round(maxit) ~= maxit)</span><br/>               <span style="color: #A0A0A0"> 743</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    warning('MATLAB:eigs:NonIntegerIterationQty',['%s\n         ' ...</span><br/>               <span style="color: #A0A0A0"> 744</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        'Rounding number of iterations.'],str)</span><br/>               <span style="color: #A0A0A0"> 745</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    maxit = round(maxit);</span><br/>               <span style="color: #A0A0A0"> 746</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 747</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 748</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if isfield(opts,'v0')</span><br/>               <span style="color: #A0A0A0"> 749</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if ~isfloat(opts.v0) || ~isequal(size(opts.v0),[n,1])</span><br/>               <span style="color: #A0A0A0"> 750</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    error('MATLAB:eigs:WrongSizeOptsV0',...</span><br/>               <span style="color: #A0A0A0"> 751</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        'Start vector opts.v0 must be n-by-1.')</span><br/>               <span style="color: #A0A0A0"> 752</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 753</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if isrealprob</span><br/>               <span style="color: #A0A0A0"> 754</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    if ~isreal(opts.v0)</span><br/>               <span style="color: #A0A0A0"> 755</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        error('MATLAB:eigs:NotRealOptsV0',...</span><br/>               <span style="color: #A0A0A0"> 756</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            'Start vector opts.v0 must be real for real problems.')</span><br/>               <span style="color: #A0A0A0"> 757</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    end</span><br/>               <span style="color: #A0A0A0"> 758</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    resid(1:n,1) = full(opts.v0);</span><br/>               <span style="color: #A0A0A0"> 759</span> <span style="color: #228B22; background: #FFFFFF;">                else</span><br/>               <span style="color: #A0A0A0"> 760</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    resid(2:2:2*n,1) = full(imag(opts.v0));</span><br/>               <span style="color: #A0A0A0"> 761</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    resid(1:2:(2*n-1),1) = full(real(opts.v0));</span><br/>               <span style="color: #A0A0A0"> 762</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 763</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 764</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if isfield(opts,'disp')</span><br/>               <span style="color: #A0A0A0"> 765</span> <span style="color: #A0A0A0; background: #FFFFFF;">                eigs_display = opts.disp;</span><br/>               <span style="color: #A0A0A0"> 766</span> <span style="color: #A0A0A0; background: #FFFFFF;">                dispstr = 'Diagnostic level opts.disp must be an integer.';</span><br/>               <span style="color: #A0A0A0"> 767</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if ~isnumeric(eigs_display) || ~isscalar(eigs_display) || ...</span><br/>               <span style="color: #A0A0A0"> 768</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        ~isreal(eigs_display) || (eigs_display&lt;0)</span><br/>               <span style="color: #A0A0A0"> 769</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    error('MATLAB:eigs:NonIntegerDiagnosticLevel', dispstr)</span><br/>               <span style="color: #A0A0A0"> 770</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 771</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if (round(eigs_display) ~= eigs_display)</span><br/>               <span style="color: #A0A0A0"> 772</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    warning('MATLAB:eigs:NonIntegerDiagnosticLevel', ...</span><br/>               <span style="color: #A0A0A0"> 773</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        '%s\n         Rounding diagnostic level.',dispstr)</span><br/>               <span style="color: #A0A0A0"> 774</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    eigs_display = round(eigs_display);</span><br/>               <span style="color: #A0A0A0"> 775</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 776</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 777</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if isfield(opts,'cheb')</span><br/>               <span style="color: #A0A0A0"> 778</span> <span style="color: #A0A0A0; background: #FFFFFF;">                error('MATLAB:eigs:ObsoleteOptionCheb', ...</span><br/>               <span style="color: #A0A0A0"> 779</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    'Polynomial acceleration opts.cheb is an obsolete option.');</span><br/>               <span style="color: #A0A0A0"> 780</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 781</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if isfield(opts,'stagtol')</span><br/>               <span style="color: #A0A0A0"> 782</span> <span style="color: #A0A0A0; background: #FFFFFF;">                error('MATLAB:eigs:ObsoleteOptionStagtol', ...</span><br/>               <span style="color: #A0A0A0"> 783</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    'Stagnation tolerance opts.stagtol is an obsolete option.');</span><br/>               <span style="color: #A0A0A0"> 784</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 785</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if isfield(opts,'style')</span><br/>               <span style="color: #A0A0A0"> 786</span> <span style="color: #A0A0A0; background: #FFFFFF;">                style = opts.style;</span><br/>               <span style="color: #A0A0A0"> 787</span> <span style="color: #A0A0A0; background: #FFFFFF;">                str = 'style must be ''S'' or ''G''.';</span><br/>               <span style="color: #A0A0A0"> 788</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if ~ischar(style)</span><br/>               <span style="color: #A0A0A0"> 789</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    error('MATLAB:eigs:InvalidStyle',str);</span><br/>               <span style="color: #A0A0A0"> 790</span> <span style="color: #A0A0A0; background: #FFFFFF;">                elseif ~(strcmp(style,'S') || strcmp(style,'G'))</span><br/>               <span style="color: #A0A0A0"> 791</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    error('MATLAB:eigs:InvalidStyle',str);</span><br/>               <span style="color: #A0A0A0"> 792</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 793</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 794</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 795</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if (isempty(resid))</span><br/>               <span style="color: #A0A0A0"> 796</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if isrealprob</span><br/>               <span style="color: #A0A0A0"> 797</span> <span style="color: #A0A0A0; background: #FFFFFF;">                resid = cast(rand(n,1),classAB);</span><br/>               <span style="color: #A0A0A0"> 798</span> <span style="color: #228B22; background: #FFFFFF;">            else</span><br/>               <span style="color: #A0A0A0"> 799</span> <span style="color: #A0A0A0; background: #FFFFFF;">                resid = cast(rand(2*n,1),classAB);</span><br/>               <span style="color: #A0A0A0"> 800</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 801</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 802</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 803</span> <span style="color: #A0A0A0; background: #FFFFFF;">        afunNargs = zeros(1,0);</span><br/>               <span style="color: #A0A0A0"> 804</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if ~Amatrix</span><br/>               <span style="color: #A0A0A0"> 805</span> <span style="color: #228B22; background: #FFFFFF;">            % The trailing parameters for afun start at varargin{7-argOffset}</span><br/>               <span style="color: #A0A0A0"> 806</span> <span style="color: #228B22; background: #FFFFFF;">            % in eigs(afun,n,[B],k,sigma,opts,P1,P2,...). If there are no</span><br/>               <span style="color: #A0A0A0"> 807</span> <span style="color: #228B22; background: #FFFFFF;">            % trailing parameters in eigs, then afunNargs is a 1-by-0 empty</span><br/>               <span style="color: #A0A0A0"> 808</span> <span style="color: #228B22; background: #FFFFFF;">            % and no trailing parameters are passed to afun(x)</span><br/>               <span style="color: #A0A0A0"> 809</span> <span style="color: #A0A0A0; background: #FFFFFF;">            afunNargs = 7-argOffset:nargin;</span><br/>               <span style="color: #A0A0A0"> 810</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 811</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 812</span> <span style="color: #228B22; background: #FFFFFF;">        % Now that OPTS has been processed, do final error checking and</span><br/>               <span style="color: #A0A0A0"> 813</span> <span style="color: #228B22; background: #FFFFFF;">        % assign ARPACK variables</span><br/>               <span style="color: #A0A0A0"> 814</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 815</span> <span style="color: #228B22; background: #FFFFFF;">        % Extra check on input B</span><br/>               <span style="color: #A0A0A0"> 816</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if ~isempty(B)</span><br/>               <span style="color: #A0A0A0"> 817</span> <span style="color: #228B22; background: #FFFFFF;">            % B must be symmetric (Hermitian) positive (semi-)definite</span><br/>               <span style="color: #A0A0A0"> 818</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if cholB</span><br/>               <span style="color: #A0A0A0"> 819</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if ~isequal(triu(B),B)</span><br/>               <span style="color: #A0A0A0"> 820</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    error('MATLAB:eigs:BNotChol', ...</span><br/>               <span style="color: #A0A0A0"> 821</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        'opts.CHOLB specified, but B is not upper triangular.');</span><br/>               <span style="color: #A0A0A0"> 822</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 823</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 824</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 825</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 826</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if isempty(style)</span><br/>               <span style="color: #A0A0A0"> 827</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if strcmp(eigs_sigma,'SM') || isscalar(eigs_sigma) || ~isempty(B)</span><br/>               <span style="color: #A0A0A0"> 828</span> <span style="color: #A0A0A0; background: #FFFFFF;">                style = 'G';</span><br/>               <span style="color: #A0A0A0"> 829</span> <span style="color: #228B22; background: #FFFFFF;">            else</span><br/>               <span style="color: #A0A0A0"> 830</span> <span style="color: #A0A0A0; background: #FFFFFF;">                style = 'S';</span><br/>               <span style="color: #A0A0A0"> 831</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 832</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 833</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 834</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if ~isempty(B)</span><br/>               <span style="color: #A0A0A0"> 835</span> <span style="color: #A0A0A0; background: #FFFFFF;">            scaleB = norm(B,'fro')/sqrt(n);</span><br/>               <span style="color: #A0A0A0"> 836</span> <span style="color: #A0A0A0; background: #FFFFFF;">            scaleB = 2^(floor(log2(scaleB+1)));</span><br/>               <span style="color: #A0A0A0"> 837</span> <span style="color: #A0A0A0; background: #FFFFFF;">            B = B/scaleB;</span><br/>               <span style="color: #A0A0A0"> 838</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if cholB</span><br/>               <span style="color: #A0A0A0"> 839</span> <span style="color: #A0A0A0; background: #FFFFFF;">                scaleB = scaleB^2;</span><br/>               <span style="color: #A0A0A0"> 840</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 841</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if isscalar(eigs_sigma)</span><br/>               <span style="color: #A0A0A0"> 842</span> <span style="color: #A0A0A0; background: #FFFFFF;">                sigma = scaleB*eigs_sigma;</span><br/>               <span style="color: #A0A0A0"> 843</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 844</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 845</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 846</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 847</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if strcmp(eigs_sigma,'SM') || ~ischar(eigs_sigma)</span><br/>               <span style="color: #A0A0A0"> 848</span> <span style="color: #228B22; background: #FFFFFF;">            % eigs(A,B,k,scalarSigma) or eigs(A,B,k,'SM'), B may be []</span><br/>               <span style="color: #A0A0A0"> 849</span> <span style="color: #228B22; background: #FFFFFF;">            % Note: sigma must be real for [s,d]saupd and [s,d]naupd</span><br/>               <span style="color: #A0A0A0"> 850</span> <span style="color: #228B22; background: #FFFFFF;">            % If sigma is complex, even if A and B are both real, we use</span><br/>               <span style="color: #A0A0A0"> 851</span> <span style="color: #228B22; background: #FFFFFF;">            % [c,z]naupd.</span><br/>               <span style="color: #A0A0A0"> 852</span> <span style="color: #228B22; background: #FFFFFF;">            % This means that mode=3 in [s,d]naupd, which has</span><br/>               <span style="color: #A0A0A0"> 853</span> <span style="color: #228B22; background: #FFFFFF;">            % OP = real(inv(A - sigma*M)*M) and B = M</span><br/>               <span style="color: #A0A0A0"> 854</span> <span style="color: #228B22; background: #FFFFFF;">            % reduces to the same OP as [s,d]saupd and [c,z]naupd.</span><br/>               <span style="color: #A0A0A0"> 855</span> <span style="color: #228B22; background: #FFFFFF;">            % A*x = lambda*M*x, M symmetric (positive) semi-definite</span><br/>               <span style="color: #A0A0A0"> 856</span> <span style="color: #228B22; background: #FFFFFF;">            % =&gt; OP = inv(A - sigma*M)*M and B = M</span><br/>               <span style="color: #A0A0A0"> 857</span> <span style="color: #228B22; background: #FFFFFF;">            % =&gt; shift-and-invert mode</span><br/>               <span style="color: #A0A0A0"> 858</span> <span style="color: #A0A0A0; background: #FFFFFF;">            mode = 3;</span><br/>               <span style="color: #A0A0A0"> 859</span> <span style="color: #A0A0A0; background: #FFFFFF;">        elseif strcmp(style,'S')</span><br/>               <span style="color: #A0A0A0"> 860</span> <span style="color: #228B22; background: #FFFFFF;">            % eigs(A,k,stringSigma) or eigs(A,[],k,stringSigma),</span><br/>               <span style="color: #A0A0A0"> 861</span> <span style="color: #228B22; background: #FFFFFF;">            % stringSigma~='SM'</span><br/>               <span style="color: #A0A0A0"> 862</span> <span style="color: #228B22; background: #FFFFFF;">            % A*x = lambda*x</span><br/>               <span style="color: #A0A0A0"> 863</span> <span style="color: #228B22; background: #FFFFFF;">            % =&gt; OP = A and B = I</span><br/>               <span style="color: #A0A0A0"> 864</span> <span style="color: #A0A0A0; background: #FFFFFF;">            mode = 1;</span><br/>               <span style="color: #A0A0A0"> 865</span> <span style="color: #228B22; background: #FFFFFF;">        else</span><br/>               <span style="color: #A0A0A0"> 866</span> <span style="color: #228B22; background: #FFFFFF;">            % eigs(A,B,k,stringSigma), stringSigma~='SM'</span><br/>               <span style="color: #A0A0A0"> 867</span> <span style="color: #228B22; background: #FFFFFF;">            % A*x = lambda*B*x</span><br/>               <span style="color: #A0A0A0"> 868</span> <span style="color: #228B22; background: #FFFFFF;">            % =&gt; OP = inv(B)*A and use standard inner product.</span><br/>               <span style="color: #A0A0A0"> 869</span> <span style="color: #A0A0A0; background: #FFFFFF;">            mode = 2;</span><br/>               <span style="color: #A0A0A0"> 870</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 871</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 872</span> <span style="color: #A0A0A0; background: #FFFFFF;">        BisHpd = false;</span><br/>               <span style="color: #A0A0A0"> 873</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if cholB || (~isempty(B) &amp;&amp; ishermitian(B))</span><br/>               <span style="color: #A0A0A0"> 874</span> <span style="color: #228B22; background: #FFFFFF;">            % The reordering permutation permB is [] unless B is sparse</span><br/>               <span style="color: #A0A0A0"> 875</span> <span style="color: #A0A0A0; background: #FFFFFF;">            [RB,RBT,permB,BisHpd] = CHOLfactorB;</span><br/>               <span style="color: #A0A0A0"> 876</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if mode == 3 &amp;&amp; ~cholB</span><br/>               <span style="color: #A0A0A0"> 877</span> <span style="color: #A0A0A0; background: #FFFFFF;">                RB = [];    RBT = [];   permB = [];</span><br/>               <span style="color: #A0A0A0"> 878</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 879</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 880</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 881</span> <span style="color: #A0A0A0; background: #FFFFFF;">        qqB = [];</span><br/>               <span style="color: #A0A0A0"> 882</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if BisHpd == false &amp;&amp; (mode == 1 || mode == 2)</span><br/>               <span style="color: #A0A0A0"> 883</span> <span style="color: #A0A0A0; background: #FFFFFF;">            [LB,UB,ppB,qqB,dgB] = LUfactorB;</span><br/>               <span style="color: #A0A0A0"> 884</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 885</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 886</span> <span style="color: #A0A0A0; background: #FFFFFF;">        Bfactors = [];</span><br/>               <span style="color: #A0A0A0"> 887</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if ~isempty(B)</span><br/>               <span style="color: #A0A0A0"> 888</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if BisHpd == true</span><br/>               <span style="color: #A0A0A0"> 889</span> <span style="color: #A0A0A0; background: #FFFFFF;">                Bfactors = struct('RB',RB,'RBT',RBT,'permB',permB,'BisHpd',BisHpd);</span><br/>               <span style="color: #A0A0A0"> 890</span> <span style="color: #A0A0A0; background: #FFFFFF;">            elseif (mode == 1 || mode == 2)</span><br/>               <span style="color: #A0A0A0"> 891</span> <span style="color: #A0A0A0; background: #FFFFFF;">                Bfactors = struct('LB',LB,'UB',UB,'ppB',ppB,'qqB',qqB,'dgB',dgB,'BisHpd',BisHpd);</span><br/>               <span style="color: #A0A0A0"> 892</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 893</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 894</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 895</span> <span style="color: #A0A0A0; background: #FFFFFF;">        Afactors = [];</span><br/>               <span style="color: #A0A0A0"> 896</span> <span style="color: #A0A0A0; background: #FFFFFF;">        qq = [];</span><br/>               <span style="color: #A0A0A0"> 897</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if (mode == 3) &amp;&amp; Amatrix % need lu(A-sigma*B)</span><br/>               <span style="color: #A0A0A0"> 898</span> <span style="color: #228B22; background: #FFFFFF;">            % The reordering permutation permAsB is [] unless A-sigma*B is sparse</span><br/>               <span style="color: #A0A0A0"> 899</span> <span style="color: #A0A0A0; background: #FFFFFF;">            [L,U,pp,qq,dgAsB] = LUfactorAminusSigmaB;</span><br/>               <span style="color: #A0A0A0"> 900</span> <span style="color: #A0A0A0; background: #FFFFFF;">            Afactors = struct('L',L,'U',U,'pp',pp,'qq',qq,'dgAsB',dgAsB);</span><br/>               <span style="color: #A0A0A0"> 901</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end % if (mode == 3) &amp;&amp; Amatrix        </span><br/>               <span style="color: #A0A0A0"> 902</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 903</span> <span style="color: #228B22; background: #FFFFFF;">        % under these conditions, OP must be unsymmetric</span><br/>               <span style="color: #A0A0A0"> 904</span> <span style="color: #228B22; background: #FFFFFF;">        % note that OP = inv(A-\sigma*B)*B IS symmetric if A is symmetric</span><br/>               <span style="color: #A0A0A0"> 905</span> <span style="color: #228B22; background: #FFFFFF;">        % and B-inner product is used!</span><br/>               <span style="color: #A0A0A0"> 906</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if ~isempty(B) &amp;&amp; (BisHpd == false || (strcmp(style,'S') &amp;&amp; mode == 3))</span><br/>               <span style="color: #A0A0A0"> 907</span> <span style="color: #A0A0A0; background: #FFFFFF;">            issymA = false;</span><br/>               <span style="color: #A0A0A0"> 908</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 909</span> <span style="color: #228B22; background: #FFFFFF;">        % Extra check on input K</span><br/>               <span style="color: #A0A0A0"> 910</span> <span style="color: #228B22; background: #FFFFFF;">        % We fall back on using the full EIG code if K is too large.</span><br/>               <span style="color: #A0A0A0"> 911</span> <span style="color: #A0A0A0; background: #FFFFFF;">        useeig = false;</span><br/>               <span style="color: #A0A0A0"> 912</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if isrealprob &amp;&amp; issymA</span><br/>               <span style="color: #A0A0A0"> 913</span> <span style="color: #A0A0A0; background: #FFFFFF;">            knstr = sprintf(['For real symmetric problems, must have' ...</span><br/>               <span style="color: #A0A0A0"> 914</span> <span style="color: #A0A0A0; background: #FFFFFF;">                ' number of eigenvalues k &lt; n.\n']);</span><br/>               <span style="color: #A0A0A0"> 915</span> <span style="color: #228B22; background: #FFFFFF;">        else</span><br/>               <span style="color: #A0A0A0"> 916</span> <span style="color: #A0A0A0; background: #FFFFFF;">            knstr = sprintf(['For nonsymmetric and complex problems,' ...</span><br/>               <span style="color: #A0A0A0"> 917</span> <span style="color: #A0A0A0; background: #FFFFFF;">                ' must have number of eigenvalues k &lt; n-1.\n']);</span><br/>               <span style="color: #A0A0A0"> 918</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 919</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if isempty(B)</span><br/>               <span style="color: #A0A0A0"> 920</span> <span style="color: #A0A0A0; background: #FFFFFF;">            knstr = [knstr 'Using eig(full(A)) instead.'];</span><br/>               <span style="color: #A0A0A0"> 921</span> <span style="color: #228B22; background: #FFFFFF;">        else</span><br/>               <span style="color: #A0A0A0"> 922</span> <span style="color: #A0A0A0; background: #FFFFFF;">            knstr = [knstr 'Using eig(full(A),full(B)) instead.'];</span><br/>               <span style="color: #A0A0A0"> 923</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 924</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if (k == 0)</span><br/>               <span style="color: #A0A0A0"> 925</span> <span style="color: #A0A0A0; background: #FFFFFF;">            useeig = true;</span><br/>               <span style="color: #A0A0A0"> 926</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 927</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if isrealprob &amp;&amp; issymA</span><br/>               <span style="color: #A0A0A0"> 928</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if (k &gt; n-1)</span><br/>               <span style="color: #A0A0A0"> 929</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if (n &gt;= 6)</span><br/>               <span style="color: #A0A0A0"> 930</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    warning('MATLAB:eigs:TooManyRequestedEigsForRealSym', ...</span><br/>               <span style="color: #A0A0A0"> 931</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        '%s',knstr)</span><br/>               <span style="color: #A0A0A0"> 932</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 933</span> <span style="color: #A0A0A0; background: #FFFFFF;">                useeig = true;</span><br/>               <span style="color: #A0A0A0"> 934</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 935</span> <span style="color: #228B22; background: #FFFFFF;">        else</span><br/>               <span style="color: #A0A0A0"> 936</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if (k &gt; n-2)</span><br/>               <span style="color: #A0A0A0"> 937</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if (n &gt;= 7)</span><br/>               <span style="color: #A0A0A0"> 938</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    warning('MATLAB:eigs:TooManyRequestedEigsForComplexNonsym', ...</span><br/>               <span style="color: #A0A0A0"> 939</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        '%s',knstr)</span><br/>               <span style="color: #A0A0A0"> 940</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 941</span> <span style="color: #A0A0A0; background: #FFFFFF;">                useeig = true;</span><br/>               <span style="color: #A0A0A0"> 942</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 943</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 944</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 945</span> <span style="color: #228B22; background: #FFFFFF;">        % Extra check on input SIGMA</span><br/>               <span style="color: #A0A0A0"> 946</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if isrealprob &amp;&amp; issymA</span><br/>               <span style="color: #A0A0A0"> 947</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if ~isreal(sigma)</span><br/>               <span style="color: #A0A0A0"> 948</span> <span style="color: #A0A0A0; background: #FFFFFF;">                error('MATLAB:eigs:ComplexShiftForRealSymProblem',...</span><br/>               <span style="color: #A0A0A0"> 949</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ['For real symmetric problems, eigenvalue shift sigma must' ...</span><br/>               <span style="color: #A0A0A0"> 950</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ' be real.'])</span><br/>               <span style="color: #A0A0A0"> 951</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 952</span> <span style="color: #228B22; background: #FFFFFF;">        else</span><br/>               <span style="color: #A0A0A0"> 953</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if ~isrealprob &amp;&amp; issymA &amp;&amp; ~isreal(sigma)</span><br/>               <span style="color: #A0A0A0"> 954</span> <span style="color: #A0A0A0; background: #FFFFFF;">                warning('MATLAB:eigs:ComplexShiftForHermitianProblem', ...</span><br/>               <span style="color: #A0A0A0"> 955</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ['Complex eigenvalue shift sigma on a Hermitian problem' ...</span><br/>               <span style="color: #A0A0A0"> 956</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ' (all real eigenvalues).'])</span><br/>               <span style="color: #A0A0A0"> 957</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 958</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 959</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if isrealprob &amp;&amp; issymA</span><br/>               <span style="color: #A0A0A0"> 960</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if strcmp(whch,'LR')</span><br/>               <span style="color: #A0A0A0"> 961</span> <span style="color: #A0A0A0; background: #FFFFFF;">                whch = 'LA';</span><br/>               <span style="color: #A0A0A0"> 962</span> <span style="color: #A0A0A0; background: #FFFFFF;">                warning('MATLAB:eigs:SigmaChangedToLA', ...</span><br/>               <span style="color: #A0A0A0"> 963</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ['For real symmetric problems, sigma value ''LR''' ...</span><br/>               <span style="color: #A0A0A0"> 964</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ' (Largest Real) is now ''LA'' (Largest Algebraic).'])</span><br/>               <span style="color: #A0A0A0"> 965</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 966</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if strcmp(whch,'SR')</span><br/>               <span style="color: #A0A0A0"> 967</span> <span style="color: #A0A0A0; background: #FFFFFF;">                whch = 'SA';</span><br/>               <span style="color: #A0A0A0"> 968</span> <span style="color: #A0A0A0; background: #FFFFFF;">                warning('MATLAB:eigs:SigmaChangedToSA', ...</span><br/>               <span style="color: #A0A0A0"> 969</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ['For real symmetric problems, sigma value ''SR''' ...</span><br/>               <span style="color: #A0A0A0"> 970</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ' (Smallest Real) is now ''SA'' (Smallest Algebraic).'])</span><br/>               <span style="color: #A0A0A0"> 971</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 972</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if ~ismember(whch,{'LM', 'SM', 'LA', 'SA', 'BE'})</span><br/>               <span style="color: #A0A0A0"> 973</span> <span style="color: #A0A0A0; background: #FFFFFF;">                error('MATLAB:eigs:EigenvalueRangeNotValid', ...</span><br/>               <span style="color: #A0A0A0"> 974</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    [whchstr '\nFor real symmetric A, the' ...</span><br/>               <span style="color: #A0A0A0"> 975</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ' choices are ''%s'', ''%s'', ''%s'', ''%s'' or ''%s''.'], ...</span><br/>               <span style="color: #A0A0A0"> 976</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    'LM','SM','LA','SA','BE');</span><br/>               <span style="color: #A0A0A0"> 977</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 978</span> <span style="color: #228B22; background: #FFFFFF;">        else</span><br/>               <span style="color: #A0A0A0"> 979</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if strcmp(whch,'BE')</span><br/>               <span style="color: #A0A0A0"> 980</span> <span style="color: #A0A0A0; background: #FFFFFF;">                warning('MATLAB:eigs:SigmaChangedToLM', ...</span><br/>               <span style="color: #A0A0A0"> 981</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ['Sigma value ''BE'' is now only available for real' ...</span><br/>               <span style="color: #A0A0A0"> 982</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ' symmetric problems.  Computing ''LM'' eigenvalues instead.'])</span><br/>               <span style="color: #A0A0A0"> 983</span> <span style="color: #A0A0A0; background: #FFFFFF;">                whch = 'LM';</span><br/>               <span style="color: #A0A0A0"> 984</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 985</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if ~ismember(whch,{'LM', 'SM', 'LR', 'SR', 'LI', 'SI'})</span><br/>               <span style="color: #A0A0A0"> 986</span> <span style="color: #A0A0A0; background: #FFFFFF;">                error('MATLAB:eigs:EigenvalueRangeNotValid', ...</span><br/>               <span style="color: #A0A0A0"> 987</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    [whchstr '\nFor non-symmetric or complex' ...</span><br/>               <span style="color: #A0A0A0"> 988</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ' A, the choices are ''%s'', ''%s'', ''%s'', ''%s'',' ...</span><br/>               <span style="color: #A0A0A0"> 989</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ' ''%s'' or ''%s''.\n'],'LM','SM','LR','SR','LI','SI');</span><br/>               <span style="color: #A0A0A0"> 990</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 991</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 992</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 993</span> <span style="color: #228B22; background: #FFFFFF;">        % The remainder of the error checking does not apply for the large</span><br/>               <span style="color: #A0A0A0"> 994</span> <span style="color: #228B22; background: #FFFFFF;">        % values of K that force us to use full EIG instead of ARPACK.</span><br/>               <span style="color: #A0A0A0"> 995</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if useeig</span><br/>               <span style="color: #A0A0A0"> 996</span> <span style="color: #A0A0A0; background: #FFFFFF;">            return</span><br/>               <span style="color: #A0A0A0"> 997</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 998</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 999</span> <span style="color: #228B22; background: #FFFFFF;">        % Extra check on input OPTS.p</span><br/>               <span style="color: #A0A0A0">1000</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if isempty(p)</span><br/>               <span style="color: #A0A0A0">1001</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if isrealprob &amp;&amp; ~issymA</span><br/>               <span style="color: #A0A0A0">1002</span> <span style="color: #A0A0A0; background: #FFFFFF;">                p = min(max(2*k+1,20),n);</span><br/>               <span style="color: #A0A0A0">1003</span> <span style="color: #228B22; background: #FFFFFF;">            else</span><br/>               <span style="color: #A0A0A0">1004</span> <span style="color: #A0A0A0; background: #FFFFFF;">                p = min(max(2*k,20),n);</span><br/>               <span style="color: #A0A0A0">1005</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0">1006</span> <span style="color: #228B22; background: #FFFFFF;">        else</span><br/>               <span style="color: #A0A0A0">1007</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if isrealprob &amp;&amp; issymA</span><br/>               <span style="color: #A0A0A0">1008</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if (p &lt;= k)</span><br/>               <span style="color: #A0A0A0">1009</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    error('MATLAB:eigs:InvalidOptsPforRealSymProb',...</span><br/>               <span style="color: #A0A0A0">1010</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        ['For real symmetric problems, must have number of' ...</span><br/>               <span style="color: #A0A0A0">1011</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        ' basis vectors opts.p &gt; k.'])</span><br/>               <span style="color: #A0A0A0">1012</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0">1013</span> <span style="color: #228B22; background: #FFFFFF;">            else</span><br/>               <span style="color: #A0A0A0">1014</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if (p &lt;= k+1)</span><br/>               <span style="color: #A0A0A0">1015</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    error('MATLAB:eigs:InvalidOptsPforComplexOrNonSymProb',...</span><br/>               <span style="color: #A0A0A0">1016</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        ['For nonsymmetric and complex problems, must have number of' ...</span><br/>               <span style="color: #A0A0A0">1017</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        ' basis vectors opts.p &gt; k+1.'])</span><br/>               <span style="color: #A0A0A0">1018</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0">1019</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0">1020</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0">1021</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0">1022</span> <span style="color: #228B22; background: #FFFFFF;">        % Extra check on input OPTS.maxit</span><br/>               <span style="color: #A0A0A0">1023</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if isempty(maxit)</span><br/>               <span style="color: #A0A0A0">1024</span> <span style="color: #A0A0A0; background: #FFFFFF;">            maxit = max(300,ceil(2*n/max(p,1)));</span><br/>               <span style="color: #A0A0A0">1025</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0">1026</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0">1027</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0">1028</span> <span style="color: #228B22; background: #FFFFFF;">        % Nested functions in checkInputs</span><br/>               <span style="color: #A0A0A0">1029</span> <span style="color: #228B22; background: #FFFFFF;">        %-------------------------------------------------------------------------%</span><br/>               <span style="color: #A0A0A0">1030</span> <span style="color: #A0A0A0; background: #FFFFFF;">        function [RB,RBT,ppB,BisHpd] = CHOLfactorB</span><br/>               <span style="color: #A0A0A0">1031</span> <span style="color: #228B22; background: #FFFFFF;">            % permB may be [] (from checkInputs) if the problem is not sparse</span><br/>               <span style="color: #A0A0A0">1032</span> <span style="color: #228B22; background: #FFFFFF;">            % or if it was not passed in as opts.permB</span><br/>               <span style="color: #A0A0A0">1033</span> <span style="color: #A0A0A0; background: #FFFFFF;">            ppB = permB;</span><br/>               <span style="color: #A0A0A0">1034</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if cholB</span><br/>               <span style="color: #A0A0A0">1035</span> <span style="color: #228B22; background: #FFFFFF;">                % CHOL(B) was passed in as B</span><br/>               <span style="color: #A0A0A0">1036</span> <span style="color: #A0A0A0; background: #FFFFFF;">                RB = B;</span><br/>               <span style="color: #A0A0A0">1037</span> <span style="color: #A0A0A0; background: #FFFFFF;">                RBT = B';</span><br/>               <span style="color: #A0A0A0">1038</span> <span style="color: #A0A0A0; background: #FFFFFF;">                BisHpd = true;</span><br/>               <span style="color: #A0A0A0">1039</span> <span style="color: #228B22; background: #FFFFFF;">            else</span><br/>               <span style="color: #A0A0A0">1040</span> <span style="color: #228B22; background: #FFFFFF;">                % CHOL(B) was not passed into EIGS</span><br/>               <span style="color: #A0A0A0">1041</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if ~isempty(B)</span><br/>               <span style="color: #A0A0A0">1042</span> <span style="color: #228B22; background: #FFFFFF;">                    % Algorithm requires CHOL(B) to be computed</span><br/>               <span style="color: #A0A0A0">1043</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    if issparse(B)</span><br/>               <span style="color: #A0A0A0">1044</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        ppB = symamd(B);</span><br/>               <span style="color: #A0A0A0">1045</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        [RB,idxB] = chol(B(ppB,ppB));</span><br/>               <span style="color: #A0A0A0">1046</span> <span style="color: #228B22; background: #FFFFFF;">                    else</span><br/>               <span style="color: #A0A0A0">1047</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        [RB,idxB] = chol(B);</span><br/>               <span style="color: #A0A0A0">1048</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    end</span><br/>               <span style="color: #A0A0A0">1049</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    if mode == 3</span><br/>               <span style="color: #A0A0A0">1050</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        RB = [];    ppB = [];</span><br/>               <span style="color: #A0A0A0">1051</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    end</span><br/>               <span style="color: #A0A0A0">1052</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    RBT = RB';</span><br/>               <span style="color: #A0A0A0">1053</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    if (idxB == 0)</span><br/>               <span style="color: #A0A0A0">1054</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        BisHpd = true;</span><br/>               <span style="color: #A0A0A0">1055</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    elseif mode == 3 &amp;&amp; isreal(B)</span><br/>               <span style="color: #A0A0A0">1056</span> <span style="color: #228B22; background: #FFFFFF;">                        % LDL decomposition is only for 'SM' eigenvalues of the</span><br/>               <span style="color: #A0A0A0">1057</span> <span style="color: #228B22; background: #FFFFFF;">                        % pair (A,B) where B is Hermitian positive</span><br/>               <span style="color: #A0A0A0">1058</span> <span style="color: #228B22; background: #FFFFFF;">                        % semi-definite; in this case, as ARPACK users' guide</span><br/>               <span style="color: #A0A0A0">1059</span> <span style="color: #228B22; background: #FFFFFF;">                        % suggests, one should still use B-(semi)inner product</span><br/>               <span style="color: #A0A0A0">1060</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        [LB,DB,pvB] = ldl(B,'vector'); %#ok</span><br/>               <span style="color: #A0A0A0">1061</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        BisHpd = checkTridiagForHSD(diag(DB), diag(DB,1));</span><br/>               <span style="color: #A0A0A0">1062</span> <span style="color: #228B22; background: #FFFFFF;">                    else</span><br/>               <span style="color: #A0A0A0">1063</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        BisHpd = false;</span><br/>               <span style="color: #A0A0A0">1064</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    end</span><br/>               <span style="color: #A0A0A0">1065</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0">1066</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0">1067</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if ~isempty(B) &amp;&amp; issparse(B)</span><br/>               <span style="color: #A0A0A0">1068</span> <span style="color: #A0A0A0; background: #FFFFFF;">               tmp = speye(length(B));               </span><br/>               <span style="color: #A0A0A0">1069</span> <span style="color: #A0A0A0; background: #FFFFFF;">               ppB = tmp(ppB,1:length(B));</span><br/>               <span style="color: #A0A0A0">1070</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0">1071</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end % CHOLfactorB</span><br/>               <span style="color: #A0A0A0">1072</span> <span style="color: #228B22; background: #FFFFFF;">        %-------------------------------------------------------------------------%</span><br/>               <span style="color: #A0A0A0">1073</span> <span style="color: #A0A0A0; background: #FFFFFF;">        function [LB,UB,ppB,qqB,dgB] = LUfactorB</span><br/>               <span style="color: #A0A0A0">1074</span> <span style="color: #228B22; background: #FFFFFF;">            % LU factor B, including a reordering perm if it is sparse</span><br/>               <span style="color: #A0A0A0">1075</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if issparse(B)</span><br/>               <span style="color: #A0A0A0">1076</span> <span style="color: #A0A0A0; background: #FFFFFF;">                [LB,UB,ppB,qqB,dgB] = lu(B);</span><br/>               <span style="color: #A0A0A0">1077</span> <span style="color: #228B22; background: #FFFFFF;">            else</span><br/>               <span style="color: #A0A0A0">1078</span> <span style="color: #A0A0A0; background: #FFFFFF;">                [LB,UB,ppB] = lu(B,'vector');</span><br/>               <span style="color: #A0A0A0">1079</span> <span style="color: #A0A0A0; background: #FFFFFF;">                qqB = []; dgB = [];</span><br/>               <span style="color: #A0A0A0">1080</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end            </span><br/>               <span style="color: #A0A0A0">1081</span> <span style="color: #228B22; background: #FFFFFF;">            % Warn if lu(B) is ill-conditioned</span><br/>               <span style="color: #A0A0A0">1082</span> <span style="color: #A0A0A0; background: #FFFFFF;">            dUB = diag(UB);</span><br/>               <span style="color: #A0A0A0">1083</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if any(dUB == 0) || any(diag(LB) == 0)</span><br/>               <span style="color: #A0A0A0">1084</span> <span style="color: #A0A0A0; background: #FFFFFF;">                error('MATLAB:eigs:SingularB', ...</span><br/>               <span style="color: #A0A0A0">1085</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ['B is singular.\nUnable to compute the specified eigenvalues'...</span><br/>               <span style="color: #A0A0A0">1086</span> <span style="color: #A0A0A0; background: #FFFFFF;">                     ' because infinite eigenvalue(s) exist']);</span><br/>               <span style="color: #A0A0A0">1087</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0">1088</span> <span style="color: #A0A0A0; background: #FFFFFF;">            rcondestUB = full(min(abs(dUB)) / max(abs(dUB)));</span><br/>               <span style="color: #A0A0A0">1089</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if (rcondestUB &lt; eps)</span><br/>               <span style="color: #A0A0A0">1090</span> <span style="color: #A0A0A0; background: #FFFFFF;">                warning('MATLAB:eigs:IllConditionedB',...</span><br/>               <span style="color: #A0A0A0">1091</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ['B has small reciprocal condition' ...</span><br/>               <span style="color: #A0A0A0">1092</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ' estimate: %f\n' ...</span><br/>               <span style="color: #A0A0A0">1093</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    '         indicating that B^{-1}A might not be applied accurately.\n' ...</span><br/>               <span style="color: #A0A0A0">1094</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    '         and there may be infinite eigenvalue(s).\n'],...</span><br/>               <span style="color: #A0A0A0">1095</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    rcondestUB);</span><br/>               <span style="color: #A0A0A0">1096</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0">1097</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end % LUfactorB</span><br/>               <span style="color: #A0A0A0">1098</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0">1099</span> <span style="color: #228B22; background: #FFFFFF;">        %-------------------------------------------------------------------------%</span><br/>               <span style="color: #A0A0A0">1100</span> <span style="color: #A0A0A0; background: #FFFFFF;">        function [L,U,pp,qq,dgAsB] = LUfactorAminusSigmaB</span><br/>               <span style="color: #A0A0A0">1101</span> <span style="color: #228B22; background: #FFFFFF;">            % LU factor A-sigma*B, including a reordering perm if it is sparse</span><br/>               <span style="color: #A0A0A0">1102</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if sigma == 0</span><br/>               <span style="color: #A0A0A0">1103</span> <span style="color: #A0A0A0; background: #FFFFFF;">                AsB = A;</span><br/>               <span style="color: #A0A0A0">1104</span> <span style="color: #A0A0A0; background: #FFFFFF;">            elseif isempty(B)</span><br/>               <span style="color: #A0A0A0">1105</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if issparse(A)</span><br/>               <span style="color: #A0A0A0">1106</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    AsB = A - sigma * speye(n);</span><br/>               <span style="color: #A0A0A0">1107</span> <span style="color: #228B22; background: #FFFFFF;">                else</span><br/>               <span style="color: #A0A0A0">1108</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    AsB = A - sigma * eye(n);</span><br/>               <span style="color: #A0A0A0">1109</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0">1110</span> <span style="color: #228B22; background: #FFFFFF;">            else</span><br/>               <span style="color: #A0A0A0">1111</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if cholB</span><br/>               <span style="color: #A0A0A0">1112</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    if issparse(B)</span><br/>               <span style="color: #A0A0A0">1113</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        AsB = A - sigma * checkInputBmtimes(speye(n));</span><br/>               <span style="color: #A0A0A0">1114</span> <span style="color: #228B22; background: #FFFFFF;">                    else</span><br/>               <span style="color: #A0A0A0">1115</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        AsB = A - sigma * checkInputBmtimes(eye(n));</span><br/>               <span style="color: #A0A0A0">1116</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    end</span><br/>               <span style="color: #A0A0A0">1117</span> <span style="color: #228B22; background: #FFFFFF;">                else</span><br/>               <span style="color: #A0A0A0">1118</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    AsB = A - sigma * B;</span><br/>               <span style="color: #A0A0A0">1119</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0">1120</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0">1121</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if issparse(AsB)</span><br/>               <span style="color: #A0A0A0">1122</span> <span style="color: #A0A0A0; background: #FFFFFF;">                [L,U,pp,qq,dgAsB] = lu(AsB);</span><br/>               <span style="color: #A0A0A0">1123</span> <span style="color: #228B22; background: #FFFFFF;">            else</span><br/>               <span style="color: #A0A0A0">1124</span> <span style="color: #A0A0A0; background: #FFFFFF;">                [L,U,pp] = lu(AsB,'vector');</span><br/>               <span style="color: #A0A0A0">1125</span> <span style="color: #A0A0A0; background: #FFFFFF;">                qq = []; dgAsB = [];</span><br/>               <span style="color: #A0A0A0">1126</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0">1127</span> <span style="color: #228B22; background: #FFFFFF;">            % Warn if lu(A-sigma*B) is ill-conditioned</span><br/>               <span style="color: #A0A0A0">1128</span> <span style="color: #228B22; background: #FFFFFF;">            % =&gt; sigma is close to an exact eigenvalue of (A,B)</span><br/>               <span style="color: #A0A0A0">1129</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if isempty(B)</span><br/>               <span style="color: #A0A0A0">1130</span> <span style="color: #A0A0A0; background: #FFFFFF;">                ds = '(A-sigma*I)';</span><br/>               <span style="color: #A0A0A0">1131</span> <span style="color: #228B22; background: #FFFFFF;">            else</span><br/>               <span style="color: #A0A0A0">1132</span> <span style="color: #A0A0A0; background: #FFFFFF;">                ds = '(A-sigma*B)';</span><br/>               <span style="color: #A0A0A0">1133</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0">1134</span> <span style="color: #A0A0A0; background: #FFFFFF;">            dU = diag(U);</span><br/>               <span style="color: #A0A0A0">1135</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if any(dU == 0) || any(diag(L) == 0)</span><br/>               <span style="color: #A0A0A0">1136</span> <span style="color: #A0A0A0; background: #FFFFFF;">                error('MATLAB:eigs:AminusBSingular', ...</span><br/>               <span style="color: #A0A0A0">1137</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    [ds 'is singular. The shift is an eigenvalue.\n' ...</span><br/>               <span style="color: #A0A0A0">1138</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    'Try to use some other shift please.\n']);</span><br/>               <span style="color: #A0A0A0">1139</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0">1140</span> <span style="color: #A0A0A0; background: #FFFFFF;">            rcondestU = full(min(abs(dU)) / max(abs(dU)));</span><br/>               <span style="color: #A0A0A0">1141</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if (rcondestU &lt; eps)                </span><br/>               <span style="color: #A0A0A0">1142</span> <span style="color: #A0A0A0; background: #FFFFFF;">                warning('MATLAB:eigs:SigmaNearExactEig',...</span><br/>               <span style="color: #A0A0A0">1143</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    [ds ' has small reciprocal condition' ...</span><br/>               <span style="color: #A0A0A0">1144</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ' estimate: %f\n' ...</span><br/>               <span style="color: #A0A0A0">1145</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    '         indicating that sigma is near an exact' ...</span><br/>               <span style="color: #A0A0A0">1146</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ' eigenvalue.\n         The algorithm may not converge unless' ...</span><br/>               <span style="color: #A0A0A0">1147</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ' you try a new value for sigma.\n'], ...</span><br/>               <span style="color: #A0A0A0">1148</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    rcondestU);</span><br/>               <span style="color: #A0A0A0">1149</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0">1150</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end % LUfactorAminusSigmaB</span><br/>               <span style="color: #A0A0A0">1151</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0">1152</span> <span style="color: #228B22; background: #FFFFFF;">%-------------------------------------------------------------------------%        </span><br/>               <span style="color: #A0A0A0">1153</span> <span style="color: #A0A0A0; background: #FFFFFF;">        function v = checkInputBmtimes(u)</span><br/>               <span style="color: #A0A0A0">1154</span> <span style="color: #228B22; background: #FFFFFF;">            % Matrix-vector multiply v = B*u</span><br/>               <span style="color: #A0A0A0">1155</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if cholB % use B's cholesky factor and its transpose</span><br/>               <span style="color: #A0A0A0">1156</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if ~isempty(permB)</span><br/>               <span style="color: #A0A0A0">1157</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    v = permB'*(RBT * (RB * (permB*u)));</span><br/>               <span style="color: #A0A0A0">1158</span> <span style="color: #228B22; background: #FFFFFF;">                else</span><br/>               <span style="color: #A0A0A0">1159</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    v = RBT * (RB * u);</span><br/>               <span style="color: #A0A0A0">1160</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0">1161</span> <span style="color: #228B22; background: #FFFFFF;">            else</span><br/>               <span style="color: #A0A0A0">1162</span> <span style="color: #A0A0A0; background: #FFFFFF;">                v = B * u;</span><br/>               <span style="color: #A0A0A0">1163</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0">1164</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0">1165</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0">1166</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end % checkInputs</span><br/>               <span style="color: #A0A0A0">1167</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1168</span> <span style="color: #228B22; background: #FFFFFF;">%-------------------------------------------------------------------------%</span><br/>               <span style="color: #A0A0A0">1169</span> <span style="color: #A0A0A0; background: #FFFFFF;">    function fullEig(nOutputs)</span><br/>               <span style="color: #A0A0A0">1170</span> <span style="color: #228B22; background: #FFFFFF;">        % Use EIG(FULL(A)) or EIG(FULL(A),FULL(B)) instead of ARPACK</span><br/>               <span style="color: #A0A0A0">1171</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if ~isempty(B)</span><br/>               <span style="color: #A0A0A0">1172</span> <span style="color: #A0A0A0; background: #FFFFFF;">            B = Bmtimes(eye(n));</span><br/>               <span style="color: #A0A0A0">1173</span> <span style="color: #A0A0A0; background: #FFFFFF;">            B = B*scaleB;</span><br/>               <span style="color: #A0A0A0">1174</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0">1175</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if isfloat(A)</span><br/>               <span style="color: #A0A0A0">1176</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if issparse(A);</span><br/>               <span style="color: #A0A0A0">1177</span> <span style="color: #A0A0A0; background: #FFFFFF;">                A = full(A);</span><br/>               <span style="color: #A0A0A0">1178</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0">1179</span> <span style="color: #228B22; background: #FFFFFF;">        else</span><br/>               <span style="color: #A0A0A0">1180</span> <span style="color: #228B22; background: #FFFFFF;">            % A is specified by a function.</span><br/>               <span style="color: #A0A0A0">1181</span> <span style="color: #228B22; background: #FFFFFF;">            % Form the matrix A by applying the function.</span><br/>               <span style="color: #A0A0A0">1182</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if ischar(eigs_sigma) &amp;&amp; ~strcmp(eigs_sigma,'SM')</span><br/>               <span style="color: #A0A0A0">1183</span> <span style="color: #228B22; background: #FFFFFF;">                % A is a function multiplying A*x</span><br/>               <span style="color: #A0A0A0">1184</span> <span style="color: #A0A0A0; background: #FFFFFF;">                AA = eye(n);</span><br/>               <span style="color: #A0A0A0">1185</span> <span style="color: #A0A0A0; background: #FFFFFF;">                for i = 1:n</span><br/>               <span style="color: #A0A0A0">1186</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    AA(:,i) = A(AA(:,i),varargin{afunNargs});</span><br/>               <span style="color: #A0A0A0">1187</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0">1188</span> <span style="color: #A0A0A0; background: #FFFFFF;">                A = AA;</span><br/>               <span style="color: #A0A0A0">1189</span> <span style="color: #228B22; background: #FFFFFF;">            else</span><br/>               <span style="color: #A0A0A0">1190</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if (isfloat(eigs_sigma) &amp;&amp; eigs_sigma == 0) || strcmp(eigs_sigma,'SM')</span><br/>               <span style="color: #A0A0A0">1191</span> <span style="color: #228B22; background: #FFFFFF;">                    % A is a function solving A\x</span><br/>               <span style="color: #A0A0A0">1192</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    invA = eye(n);</span><br/>               <span style="color: #A0A0A0">1193</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    for i = 1:n</span><br/>               <span style="color: #A0A0A0">1194</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        invA(:,i) = A(invA(:,i),varargin{afunNargs});</span><br/>               <span style="color: #A0A0A0">1195</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    end</span><br/>               <span style="color: #A0A0A0">1196</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    A = eye(n) / invA;</span><br/>               <span style="color: #A0A0A0">1197</span> <span style="color: #228B22; background: #FFFFFF;">                else</span><br/>               <span style="color: #A0A0A0">1198</span> <span style="color: #228B22; background: #FFFFFF;">                    % A is a function solving (A-sigma*B)\x</span><br/>               <span style="color: #A0A0A0">1199</span> <span style="color: #228B22; background: #FFFFFF;">                    % B may be [], indicating the identity matrix</span><br/>               <span style="color: #A0A0A0">1200</span> <span style="color: #228B22; background: #FFFFFF;">                    % U = (A-sigma*B)\sigma*B</span><br/>               <span style="color: #A0A0A0">1201</span> <span style="color: #228B22; background: #FFFFFF;">                    % =&gt; (A-sigma*B)*U = sigma*B</span><br/>               <span style="color: #A0A0A0">1202</span> <span style="color: #228B22; background: #FFFFFF;">                    % =&gt; A*U = sigma*B(U + eye(n))</span><br/>               <span style="color: #A0A0A0">1203</span> <span style="color: #228B22; background: #FFFFFF;">                    % =&gt; A = sigma*B(U + eye(n)) / U</span><br/>               <span style="color: #A0A0A0">1204</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    if isempty(B)</span><br/>               <span style="color: #A0A0A0">1205</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        sB = eigs_sigma*eye(n);</span><br/>               <span style="color: #A0A0A0">1206</span> <span style="color: #228B22; background: #FFFFFF;">                    else</span><br/>               <span style="color: #A0A0A0">1207</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        sB = eigs_sigma*B;</span><br/>               <span style="color: #A0A0A0">1208</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    end</span><br/>               <span style="color: #A0A0A0">1209</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    U = zeros(n,n);</span><br/>               <span style="color: #A0A0A0">1210</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    for i = 1:n</span><br/>               <span style="color: #A0A0A0">1211</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        U(:,i) = A(sB(:,i),varargin{afunNargs});</span><br/>               <span style="color: #A0A0A0">1212</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    end</span><br/>               <span style="color: #A0A0A0">1213</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    A = sB*(U+eye(n)) / U;</span><br/>               <span style="color: #A0A0A0">1214</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0">1215</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0">1216</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0">1217</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0">1218</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if isempty(B)</span><br/>               <span style="color: #A0A0A0">1219</span> <span style="color: #A0A0A0; background: #FFFFFF;">            eigInputs = {A};</span><br/>               <span style="color: #A0A0A0">1220</span> <span style="color: #228B22; background: #FFFFFF;">        else</span><br/>               <span style="color: #A0A0A0">1221</span> <span style="color: #A0A0A0; background: #FFFFFF;">            eigInputs = {A,B};</span><br/>               <span style="color: #A0A0A0">1222</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0">1223</span> <span style="color: #228B22; background: #FFFFFF;">        % Now with full floating point matrices A and B, use EIG:</span><br/>               <span style="color: #A0A0A0">1224</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if (nOutputs &lt;= 1)</span><br/>               <span style="color: #A0A0A0">1225</span> <span style="color: #A0A0A0; background: #FFFFFF;">            d = eig(eigInputs{:});</span><br/>               <span style="color: #A0A0A0">1226</span> <span style="color: #228B22; background: #FFFFFF;">        else</span><br/>               <span style="color: #A0A0A0">1227</span> <span style="color: #A0A0A0; background: #FFFFFF;">            [V,D] = eig(eigInputs{:});</span><br/>               <span style="color: #A0A0A0">1228</span> <span style="color: #A0A0A0; background: #FFFFFF;">            d = diag(D);</span><br/>               <span style="color: #A0A0A0">1229</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0">1230</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0">1231</span> <span style="color: #228B22; background: #FFFFFF;">        % Grab the eigenvalues we want, based on sigma</span><br/>               <span style="color: #A0A0A0">1232</span> <span style="color: #A0A0A0; background: #FFFFFF;">        firstKindices = 1:k;</span><br/>               <span style="color: #A0A0A0">1233</span> <span style="color: #A0A0A0; background: #FFFFFF;">        lastKindices = n:-1:n-k+1;</span><br/>               <span style="color: #A0A0A0">1234</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if ischar(eigs_sigma)</span><br/>               <span style="color: #A0A0A0">1235</span> <span style="color: #A0A0A0; background: #FFFFFF;">            switch eigs_sigma</span><br/>               <span style="color: #A0A0A0">1236</span> <span style="color: #A0A0A0; background: #FFFFFF;">                case 'LM'</span><br/>               <span style="color: #A0A0A0">1237</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    [~,ind] = sort(abs(d));</span><br/>               <span style="color: #A0A0A0">1238</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    range = lastKindices;</span><br/>               <span style="color: #A0A0A0">1239</span> <span style="color: #A0A0A0; background: #FFFFFF;">                case 'SM'</span><br/>               <span style="color: #A0A0A0">1240</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    [~,ind] = sort(abs(d));</span><br/>               <span style="color: #A0A0A0">1241</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    range = firstKindices;</span><br/>               <span style="color: #A0A0A0">1242</span> <span style="color: #A0A0A0; background: #FFFFFF;">                case 'LA'</span><br/>               <span style="color: #A0A0A0">1243</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    [~,ind] = sort(d);</span><br/>               <span style="color: #A0A0A0">1244</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    range = lastKindices;</span><br/>               <span style="color: #A0A0A0">1245</span> <span style="color: #A0A0A0; background: #FFFFFF;">                case 'SA'</span><br/>               <span style="color: #A0A0A0">1246</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    [~,ind] = sort(d);</span><br/>               <span style="color: #A0A0A0">1247</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    range = firstKindices;</span><br/>               <span style="color: #A0A0A0">1248</span> <span style="color: #A0A0A0; background: #FFFFFF;">                case 'LR'</span><br/>               <span style="color: #A0A0A0">1249</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    [~,ind] = sort(abs(real(d)));</span><br/>               <span style="color: #A0A0A0">1250</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    range = lastKindices;</span><br/>               <span style="color: #A0A0A0">1251</span> <span style="color: #A0A0A0; background: #FFFFFF;">                case 'SR'</span><br/>               <span style="color: #A0A0A0">1252</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    [~,ind] = sort(abs(real(d)));</span><br/>               <span style="color: #A0A0A0">1253</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    range = firstKindices;</span><br/>               <span style="color: #A0A0A0">1254</span> <span style="color: #A0A0A0; background: #FFFFFF;">                case 'LI'</span><br/>               <span style="color: #A0A0A0">1255</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    [~,ind] = sort(abs(imag(d)));</span><br/>               <span style="color: #A0A0A0">1256</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    range = lastKindices;</span><br/>               <span style="color: #A0A0A0">1257</span> <span style="color: #A0A0A0; background: #FFFFFF;">                case 'SI'</span><br/>               <span style="color: #A0A0A0">1258</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    [~,ind] = sort(abs(imag(d)));</span><br/>               <span style="color: #A0A0A0">1259</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    range = firstKindices;</span><br/>               <span style="color: #A0A0A0">1260</span> <span style="color: #A0A0A0; background: #FFFFFF;">                case 'BE'</span><br/>               <span style="color: #A0A0A0">1261</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    [~,ind] = sort(abs(d));</span><br/>               <span style="color: #A0A0A0">1262</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    range = [1:floor(k/2), n-ceil(k/2)+1:n];</span><br/>               <span style="color: #A0A0A0">1263</span> <span style="color: #A0A0A0; background: #FFFFFF;">                otherwise</span><br/>               <span style="color: #A0A0A0">1264</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    error('MATLAB:eigs:fullEigSigma','Unknown value of sigma');</span><br/>               <span style="color: #A0A0A0">1265</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0">1266</span> <span style="color: #228B22; background: #FFFFFF;">        else</span><br/>               <span style="color: #A0A0A0">1267</span> <span style="color: #228B22; background: #FFFFFF;">            % sigma is a scalar</span><br/>               <span style="color: #A0A0A0">1268</span> <span style="color: #A0A0A0; background: #FFFFFF;">            [~,ind] = sort(abs(d-eigs_sigma));</span><br/>               <span style="color: #A0A0A0">1269</span> <span style="color: #A0A0A0; background: #FFFFFF;">            range = 1:k;</span><br/>               <span style="color: #A0A0A0">1270</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0">1271</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0">1272</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if (nOutputs &lt;= 1)</span><br/>               <span style="color: #A0A0A0">1273</span> <span style="color: #A0A0A0; background: #FFFFFF;">            varargout{1} = d(ind(range));</span><br/>               <span style="color: #A0A0A0">1274</span> <span style="color: #228B22; background: #FFFFFF;">        else</span><br/>               <span style="color: #A0A0A0">1275</span> <span style="color: #A0A0A0; background: #FFFFFF;">            varargout{1} = V(:,ind(range));</span><br/>               <span style="color: #A0A0A0">1276</span> <span style="color: #A0A0A0; background: #FFFFFF;">            varargout{2} = D(ind(range),ind(range));</span><br/>               <span style="color: #A0A0A0">1277</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if (nOutputs == 3)</span><br/>               <span style="color: #A0A0A0">1278</span> <span style="color: #228B22; background: #FFFFFF;">                % flag indicates "convergence"</span><br/>               <span style="color: #A0A0A0">1279</span> <span style="color: #A0A0A0; background: #FFFFFF;">                varargout{3} = 0;</span><br/>               <span style="color: #A0A0A0">1280</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0">1281</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0">1282</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0">1283</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end % FULLEIG</span><br/>               <span style="color: #A0A0A0">1284</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1285</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1286</span> <span style="color: #228B22; background: #FFFFFF;">%-------------------------------------------------------------------------%</span><br/>               <span style="color: #A0A0A0">1287</span> <span style="color: #A0A0A0; background: #FFFFFF;">    function cols = checkIpntr</span><br/>               <span style="color: #A0A0A0">1288</span> <span style="color: #228B22; background: #FFFFFF;">        % Check that ipntr returned from ARPACK refers to the start of a</span><br/>               <span style="color: #A0A0A0">1289</span> <span style="color: #228B22; background: #FFFFFF;">        % column of workd.</span><br/>               <span style="color: #A0A0A0">1290</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if (ido == 1) &amp;&amp; (mode == 3) &amp;&amp; strcmp(style,'G') </span><br/>               <span style="color: #A0A0A0">1291</span> <span style="color: #A0A0A0; background: #FFFFFF;">            inds = double(ipntr(1:3));</span><br/>               <span style="color: #A0A0A0">1292</span> <span style="color: #228B22; background: #FFFFFF;">        else</span><br/>               <span style="color: #A0A0A0">1293</span> <span style="color: #A0A0A0; background: #FFFFFF;">            inds = double(ipntr(1:2));</span><br/>               <span style="color: #A0A0A0">1294</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0">1295</span> <span style="color: #A0A0A0; background: #FFFFFF;">        rows = mod(inds-1,n)+1;</span><br/>               <span style="color: #A0A0A0">1296</span> <span style="color: #A0A0A0; background: #FFFFFF;">        cols = (inds-rows)/n+1;</span><br/>               <span style="color: #A0A0A0">1297</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if ~all(rows==1)</span><br/>               <span style="color: #A0A0A0">1298</span> <span style="color: #A0A0A0; background: #FFFFFF;">            error('MATLAB:eigs:ipntrMismatchWorkdColumn', ...</span><br/>               <span style="color: #A0A0A0">1299</span> <span style="color: #A0A0A0; background: #FFFFFF;">                ['One of ipntr(1:3) does not refer to the start' ...</span><br/>               <span style="color: #A0A0A0">1300</span> <span style="color: #A0A0A0; background: #FFFFFF;">                ' of a column of the %d-by-3 array workd.'],n)</span><br/>               <span style="color: #A0A0A0">1301</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0">1302</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end % checkIpntr</span><br/>               <span style="color: #A0A0A0">1303</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1304</span> <span style="color: #228B22; background: #FFFFFF;">%-------------------------------------------------------------------------%</span><br/>               <span style="color: #A0A0A0">1305</span> <span style="color: #A0A0A0; background: #FFFFFF;">    function v = Amtimes(u)</span><br/>               <span style="color: #A0A0A0">1306</span> <span style="color: #228B22; background: #FFFFFF;">        % Matrix-vector multiply v = A*u</span><br/>               <span style="color: #A0A0A0">1307</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if Amatrix</span><br/>               <span style="color: #A0A0A0">1308</span> <span style="color: #A0A0A0; background: #FFFFFF;">            v = A * u;</span><br/>               <span style="color: #A0A0A0">1309</span> <span style="color: #228B22; background: #FFFFFF;">        else % A is a function</span><br/>               <span style="color: #A0A0A0">1310</span> <span style="color: #A0A0A0; background: #FFFFFF;">            v = A(u,varargin{afunNargs});</span><br/>               <span style="color: #A0A0A0">1311</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if isrealprob &amp;&amp; ~isreal(v)</span><br/>               <span style="color: #A0A0A0">1312</span> <span style="color: #A0A0A0; background: #FFFFFF;">                error('MATLAB:eigs:complexFunction', ...</span><br/>               <span style="color: #A0A0A0">1313</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    'AFUN is complex; set opts.isreal = false.');</span><br/>               <span style="color: #A0A0A0">1314</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0">1315</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0">1316</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0">1317</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1318</span> <span style="color: #228B22; background: #FFFFFF;">%-------------------------------------------------------------------------%</span><br/>               <span style="color: #A0A0A0">1319</span> <span style="color: #A0A0A0; background: #FFFFFF;">    function v = Bmtimes(u)</span><br/>               <span style="color: #A0A0A0">1320</span> <span style="color: #228B22; background: #FFFFFF;">        % Matrix-vector multiply v = B*u</span><br/>               <span style="color: #A0A0A0">1321</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if cholB % use B's cholesky factor and its transpose</span><br/>               <span style="color: #A0A0A0">1322</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if ~isempty(permB)</span><br/>               <span style="color: #A0A0A0">1323</span> <span style="color: #A0A0A0; background: #FFFFFF;">                v = permB'*(RBT * (RB * (permB*u)));</span><br/>               <span style="color: #A0A0A0">1324</span> <span style="color: #228B22; background: #FFFFFF;">            else</span><br/>               <span style="color: #A0A0A0">1325</span> <span style="color: #A0A0A0; background: #FFFFFF;">                v = RBT * (RB * u);</span><br/>               <span style="color: #A0A0A0">1326</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0">1327</span> <span style="color: #228B22; background: #FFFFFF;">        else</span><br/>               <span style="color: #A0A0A0">1328</span> <span style="color: #A0A0A0; background: #FFFFFF;">            v = B * u;</span><br/>               <span style="color: #A0A0A0">1329</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0">1330</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0">1331</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1332</span> <span style="color: #228B22; background: #FFFFFF;">%-------------------------------------------------------------------------%</span><br/>               <span style="color: #A0A0A0">1333</span> <span style="color: #A0A0A0; background: #FFFFFF;">    function v = RBsolve(u)</span><br/>               <span style="color: #A0A0A0">1334</span> <span style="color: #228B22; background: #FFFFFF;">        % Solve v = RB\u for v</span><br/>               <span style="color: #A0A0A0">1335</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if issparse(B)</span><br/>               <span style="color: #A0A0A0">1336</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if ~isempty(permB)</span><br/>               <span style="color: #A0A0A0">1337</span> <span style="color: #A0A0A0; background: #FFFFFF;">                v = permB'*(RB \ u);</span><br/>               <span style="color: #A0A0A0">1338</span> <span style="color: #228B22; background: #FFFFFF;">            else</span><br/>               <span style="color: #A0A0A0">1339</span> <span style="color: #A0A0A0; background: #FFFFFF;">                v = RB \ u;</span><br/>               <span style="color: #A0A0A0">1340</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0">1341</span> <span style="color: #228B22; background: #FFFFFF;">        else</span><br/>               <span style="color: #A0A0A0">1342</span> <span style="color: #A0A0A0; background: #FFFFFF;">            RBopts.UT = true;</span><br/>               <span style="color: #A0A0A0">1343</span> <span style="color: #A0A0A0; background: #FFFFFF;">            v = linsolve(RB,u,RBopts);</span><br/>               <span style="color: #A0A0A0">1344</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0">1345</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0">1346</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1347</span> <span style="color: #228B22; background: #FFFFFF;">%-------------------------------------------------------------------------%</span><br/>               <span style="color: #A0A0A0">1348</span> <span style="color: #A0A0A0; background: #FFFFFF;">    function v = RBTsolve(u)</span><br/>               <span style="color: #A0A0A0">1349</span> <span style="color: #228B22; background: #FFFFFF;">        % Solve v = RB'\u for v</span><br/>               <span style="color: #A0A0A0">1350</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if issparse(B)</span><br/>               <span style="color: #A0A0A0">1351</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if ~isempty(permB)</span><br/>               <span style="color: #A0A0A0">1352</span> <span style="color: #A0A0A0; background: #FFFFFF;">                v = RBT \ (permB*u);</span><br/>               <span style="color: #A0A0A0">1353</span> <span style="color: #228B22; background: #FFFFFF;">            else</span><br/>               <span style="color: #A0A0A0">1354</span> <span style="color: #A0A0A0; background: #FFFFFF;">                v = RBT \ u;</span><br/>               <span style="color: #A0A0A0">1355</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0">1356</span> <span style="color: #228B22; background: #FFFFFF;">        else</span><br/>               <span style="color: #A0A0A0">1357</span> <span style="color: #A0A0A0; background: #FFFFFF;">            RBTopts.LT = true;</span><br/>               <span style="color: #A0A0A0">1358</span> <span style="color: #A0A0A0; background: #FFFFFF;">            v = linsolve(RBT,u,RBTopts);</span><br/>               <span style="color: #A0A0A0">1359</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0">1360</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0">1361</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1362</span> <span style="color: #228B22; background: #FFFFFF;">%-------------------------------------------------------------------------%</span><br/>               <span style="color: #A0A0A0">1363</span> <span style="color: #A0A0A0; background: #FFFFFF;">    function v = AminusSigmaBsolve(u)</span><br/>               <span style="color: #A0A0A0">1364</span> <span style="color: #228B22; background: #FFFFFF;">        % Solve v = (A-sigma*B)\u for v</span><br/>               <span style="color: #A0A0A0">1365</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if Amatrix</span><br/>               <span style="color: #A0A0A0">1366</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if ~isempty(dgAsB)</span><br/>               <span style="color: #A0A0A0">1367</span> <span style="color: #228B22; background: #FFFFFF;">                % use LU reordering permAsB</span><br/>               <span style="color: #A0A0A0">1368</span> <span style="color: #A0A0A0; background: #FFFFFF;">                v = qq*(U \ (L \ (pp*(dgAsB\u))));</span><br/>               <span style="color: #A0A0A0">1369</span> <span style="color: #228B22; background: #FFFFFF;">            else</span><br/>               <span style="color: #A0A0A0">1370</span> <span style="color: #A0A0A0; background: #FFFFFF;">                v = U \ (L \ u(pp));</span><br/>               <span style="color: #A0A0A0">1371</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0">1372</span> <span style="color: #228B22; background: #FFFFFF;">        else % A is a function</span><br/>               <span style="color: #A0A0A0">1373</span> <span style="color: #A0A0A0; background: #FFFFFF;">            v = A(u,varargin{afunNargs});</span><br/>               <span style="color: #A0A0A0">1374</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if isrealprob &amp;&amp; ~isreal(v)</span><br/>               <span style="color: #A0A0A0">1375</span> <span style="color: #A0A0A0; background: #FFFFFF;">                error('MATLAB:eigs:complexFunction', ...</span><br/>               <span style="color: #A0A0A0">1376</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    'AFUN is complex; set opts.isreal = false.');</span><br/>               <span style="color: #A0A0A0">1377</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0">1378</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0">1379</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end % AminusSigmaBsolve</span><br/>               <span style="color: #A0A0A0">1380</span> <span style="color: #228B22; background: #FFFFFF;">%-------------------------------------------------------------------------%</span><br/>               <span style="color: #A0A0A0">1381</span> <span style="color: #A0A0A0; background: #FFFFFF;">    function v = Bsolve(u)</span><br/>               <span style="color: #A0A0A0">1382</span> <span style="color: #228B22; background: #FFFFFF;">        % Solve v = (A-sigma*B)\u for v</span><br/>               <span style="color: #A0A0A0">1383</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if ~isempty(dgB)</span><br/>               <span style="color: #A0A0A0">1384</span> <span style="color: #228B22; background: #FFFFFF;">            % use LU reordering permAsB</span><br/>               <span style="color: #A0A0A0">1385</span> <span style="color: #A0A0A0; background: #FFFFFF;">            v = qqB*(UB \ (LB \ (ppB*(dgB\u))));</span><br/>               <span style="color: #A0A0A0">1386</span> <span style="color: #228B22; background: #FFFFFF;">        else</span><br/>               <span style="color: #A0A0A0">1387</span> <span style="color: #A0A0A0; background: #FFFFFF;">            v = UB \ (LB \ u(ppB));</span><br/>               <span style="color: #A0A0A0">1388</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0">1389</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end % AminusSigmaBsolve</span><br/>               <span style="color: #A0A0A0">1390</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1391</span> <span style="color: #228B22; background: #FFFFFF;">%-------------------------------------------------------------------------%</span><br/>               <span style="color: #A0A0A0">1392</span> <span style="color: #A0A0A0; background: #FFFFFF;">    function displayRitzValues</span><br/>               <span style="color: #A0A0A0">1393</span> <span style="color: #228B22; background: #FFFFFF;">        % Display a few Ritz values at the current iteration</span><br/>               <span style="color: #A0A0A0">1394</span> <span style="color: #A0A0A0; background: #FFFFFF;">        iter = double(ipntr(15));</span><br/>               <span style="color: #A0A0A0">1395</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if (iter &gt; eigs_iter) &amp;&amp; (ido ~= 99)</span><br/>               <span style="color: #A0A0A0">1396</span> <span style="color: #A0A0A0; background: #FFFFFF;">            eigs_iter = iter;</span><br/>               <span style="color: #A0A0A0">1397</span> <span style="color: #A0A0A0; background: #FFFFFF;">            ds = sprintf(['Iteration %d: a few Ritz values of the' ...</span><br/>               <span style="color: #A0A0A0">1398</span> <span style="color: #A0A0A0; background: #FFFFFF;">                ' %d-by-%d matrix:'],iter,p,p);</span><br/>               <span style="color: #A0A0A0">1399</span> <span style="color: #A0A0A0; background: #FFFFFF;">            disp(ds)</span><br/>               <span style="color: #A0A0A0">1400</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if isrealprob</span><br/>               <span style="color: #A0A0A0">1401</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if issymA</span><br/>               <span style="color: #A0A0A0">1402</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    dispvec = workl(double(ipntr(6))+(0:p-1));</span><br/>               <span style="color: #A0A0A0">1403</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    if strcmp(whch,'BE')</span><br/>               <span style="color: #A0A0A0">1404</span> <span style="color: #228B22; background: #FFFFFF;">                        % roughly k Large eigenvalues and k Small eigenvalues</span><br/>               <span style="color: #A0A0A0">1405</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        disp(dispvec(max(end-2*k+1,1):end))</span><br/>               <span style="color: #A0A0A0">1406</span> <span style="color: #228B22; background: #FFFFFF;">                    else</span><br/>               <span style="color: #A0A0A0">1407</span> <span style="color: #228B22; background: #FFFFFF;">                        % k eigenvalues</span><br/>               <span style="color: #A0A0A0">1408</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        disp(dispvec(max(end-k+1,1):end))</span><br/>               <span style="color: #A0A0A0">1409</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    end</span><br/>               <span style="color: #A0A0A0">1410</span> <span style="color: #228B22; background: #FFFFFF;">                else</span><br/>               <span style="color: #A0A0A0">1411</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    dispvec = complex(workl(double(ipntr(6))+(0:p-1)), ...</span><br/>               <span style="color: #A0A0A0">1412</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        workl(double(ipntr(7))+(0:p-1)));</span><br/>               <span style="color: #A0A0A0">1413</span> <span style="color: #228B22; background: #FFFFFF;">                    % k+1 eigenvalues (keep complex conjugate pairs together)</span><br/>               <span style="color: #A0A0A0">1414</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    disp(dispvec(max(end-k,1):end))</span><br/>               <span style="color: #A0A0A0">1415</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0">1416</span> <span style="color: #228B22; background: #FFFFFF;">            else</span><br/>               <span style="color: #A0A0A0">1417</span> <span style="color: #A0A0A0; background: #FFFFFF;">                dispvec = complex(workl(2*double(ipntr(6))-1+(0:2:2*(p-1))), ...</span><br/>               <span style="color: #A0A0A0">1418</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    workl(2*double(ipntr(6))+(0:2:2*(p-1))));</span><br/>               <span style="color: #A0A0A0">1419</span> <span style="color: #A0A0A0; background: #FFFFFF;">                disp(dispvec(max(end-k+1,1):end))</span><br/>               <span style="color: #A0A0A0">1420</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0">1421</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0">1422</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0">1423</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1424</span> <span style="color: #228B22; background: #FFFFFF;">%-------------------------------------------------------------------------%</span><br/>               <span style="color: #A0A0A0">1425</span> <span style="color: #A0A0A0; background: #FFFFFF;">    function flag = processEUPDinfo(warnNonConvergence)</span><br/>               <span style="color: #A0A0A0">1426</span> <span style="color: #228B22; background: #FFFFFF;">        % Process the info flag returned by the ARPACK routine **eupd</span><br/>               <span style="color: #A0A0A0">1427</span> <span style="color: #A0A0A0; background: #FFFFFF;">        flag = 0;</span><br/>               <span style="color: #A0A0A0">1428</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if (info ~= 0)</span><br/>               <span style="color: #A0A0A0">1429</span> <span style="color: #A0A0A0; background: #FFFFFF;">            es = ['Error with ARPACK routine ' eupdfun ':\n'];</span><br/>               <span style="color: #A0A0A0">1430</span> <span style="color: #A0A0A0; background: #FFFFFF;">            switch double(info)</span><br/>               <span style="color: #A0A0A0">1431</span> <span style="color: #A0A0A0; background: #FFFFFF;">                case 2</span><br/>               <span style="color: #A0A0A0">1432</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ss = sum(select);</span><br/>               <span style="color: #A0A0A0">1433</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    if (ss &lt; k)</span><br/>               <span style="color: #A0A0A0">1434</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        error('MATLAB:eigs:ARPACKroutineError02ssLTk', ...</span><br/>               <span style="color: #A0A0A0">1435</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            [es 'The logical variable select was only set' ...</span><br/>               <span style="color: #A0A0A0">1436</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            ' with %d 1''s instead of nconv=%d (k=%d).\n' ...</span><br/>               <span style="color: #A0A0A0">1437</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            'Please report this to the ARPACK authors at' ...</span><br/>               <span style="color: #A0A0A0">1438</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            ' arpack@caam.rice.edu.'], ...</span><br/>               <span style="color: #A0A0A0">1439</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            ss,double(iparam(5)),k)</span><br/>               <span style="color: #A0A0A0">1440</span> <span style="color: #228B22; background: #FFFFFF;">                    else</span><br/>               <span style="color: #A0A0A0">1441</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        error('MATLAB:eigs:ARPACKroutineError02', ...</span><br/>               <span style="color: #A0A0A0">1442</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            [es 'The LAPACK reordering routine %strsen' ...</span><br/>               <span style="color: #A0A0A0">1443</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            ' did not return all %d eigenvalues.'], ...</span><br/>               <span style="color: #A0A0A0">1444</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            aupdfun(1),k);</span><br/>               <span style="color: #A0A0A0">1445</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    end</span><br/>               <span style="color: #A0A0A0">1446</span> <span style="color: #A0A0A0; background: #FFFFFF;">                case 1</span><br/>               <span style="color: #A0A0A0">1447</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    error('MATLAB:eigs:ARPACKroutineError01', ...</span><br/>               <span style="color: #A0A0A0">1448</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        [es 'The Schur form could not be reordered by the' ...</span><br/>               <span style="color: #A0A0A0">1449</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        ' LAPACK routine %strsen.\nPlease report this to the' ...</span><br/>               <span style="color: #A0A0A0">1450</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        ' ARPACK authors at arpack@caam.rice.edu.'], ...</span><br/>               <span style="color: #A0A0A0">1451</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        aupdfun(1))</span><br/>               <span style="color: #A0A0A0">1452</span> <span style="color: #A0A0A0; background: #FFFFFF;">                case -14</span><br/>               <span style="color: #A0A0A0">1453</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    error('MATLAB:eigs:ARPACKroutineErrorMinus14', ...</span><br/>               <span style="color: #A0A0A0">1454</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        [es aupdfun ...</span><br/>               <span style="color: #A0A0A0">1455</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        ' did not find any eigenvalues to sufficient accuracy.']);</span><br/>               <span style="color: #A0A0A0">1456</span> <span style="color: #A0A0A0; background: #FFFFFF;">                otherwise</span><br/>               <span style="color: #A0A0A0">1457</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    error('MATLAB:eigs:ARPACKroutineError', ...</span><br/>               <span style="color: #A0A0A0">1458</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        [es 'info = %d. Please consult the ARPACK Users''' ...</span><br/>               <span style="color: #A0A0A0">1459</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        ' Guide for more information.'],full(info));</span><br/>               <span style="color: #A0A0A0">1460</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0">1461</span> <span style="color: #228B22; background: #FFFFFF;">        else</span><br/>               <span style="color: #A0A0A0">1462</span> <span style="color: #A0A0A0; background: #FFFFFF;">            nconv = double(iparam(5));</span><br/>               <span style="color: #A0A0A0">1463</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if (nconv == 0)</span><br/>               <span style="color: #A0A0A0">1464</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if (warnNonConvergence)</span><br/>               <span style="color: #A0A0A0">1465</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    warning('MATLAB:eigs:NoEigsConverged', ...</span><br/>               <span style="color: #A0A0A0">1466</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        'None of the %d requested eigenvalues converged.',k)</span><br/>               <span style="color: #A0A0A0">1467</span> <span style="color: #228B22; background: #FFFFFF;">                else</span><br/>               <span style="color: #A0A0A0">1468</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    flag = 1;</span><br/>               <span style="color: #A0A0A0">1469</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0">1470</span> <span style="color: #A0A0A0; background: #FFFFFF;">            elseif (nconv &lt; k)</span><br/>               <span style="color: #A0A0A0">1471</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if (warnNonConvergence)</span><br/>               <span style="color: #A0A0A0">1472</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    warning('MATLAB:eigs:NotAllEigsConverged', ...</span><br/>               <span style="color: #A0A0A0">1473</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        'Only %d of the %d requested eigenvalues converged.', ...</span><br/>               <span style="color: #A0A0A0">1474</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        nconv,k)</span><br/>               <span style="color: #A0A0A0">1475</span> <span style="color: #228B22; background: #FFFFFF;">                else</span><br/>               <span style="color: #A0A0A0">1476</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    flag = 1;</span><br/>               <span style="color: #A0A0A0">1477</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0">1478</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0">1479</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0">1480</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end % processEUPDinfo</span><br/>               <span style="color: #A0A0A0">1481</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1482</span> <span style="color: #228B22; background: #FFFFFF;">%-------------------------------------------------------------------------%</span><br/>               <span style="color: #A0A0A0">1483</span> <span style="color: #A0A0A0; background: #FFFFFF;">    function printTimings</span><br/>               <span style="color: #A0A0A0">1484</span> <span style="color: #228B22; background: #FFFFFF;">        % Print the time taken for each major stage of the EIGS algorithm</span><br/>               <span style="color: #A0A0A0">1485</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if (mode == 1)</span><br/>               <span style="color: #A0A0A0">1486</span> <span style="color: #A0A0A0; background: #FFFFFF;">            innerstr = sprintf(['Compute A*X:' ...</span><br/>               <span style="color: #A0A0A0">1487</span> <span style="color: #A0A0A0; background: #FFFFFF;">                '                               %f\n'],cputms(3));</span><br/>               <span style="color: #A0A0A0">1488</span> <span style="color: #A0A0A0; background: #FFFFFF;">        elseif (mode == 3)</span><br/>               <span style="color: #A0A0A0">1489</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if isempty(B)</span><br/>               <span style="color: #A0A0A0">1490</span> <span style="color: #A0A0A0; background: #FFFFFF;">                innerstr = sprintf(['Solve (A-SIGMA*I)*X=Y for X:' ...</span><br/>               <span style="color: #A0A0A0">1491</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    '               %f\n'],cputms(3));</span><br/>               <span style="color: #A0A0A0">1492</span> <span style="color: #228B22; background: #FFFFFF;">            else</span><br/>               <span style="color: #A0A0A0">1493</span> <span style="color: #A0A0A0; background: #FFFFFF;">                innerstr = sprintf(['Solve (A-SIGMA*B)*X=B*Y for X:' ...</span><br/>               <span style="color: #A0A0A0">1494</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    '             %f\n'],cputms(3));</span><br/>               <span style="color: #A0A0A0">1495</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0">1496</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0">1497</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if ((mode == 3) &amp;&amp; (Amatrix))</span><br/>               <span style="color: #A0A0A0">1498</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if isempty(B)</span><br/>               <span style="color: #A0A0A0">1499</span> <span style="color: #A0A0A0; background: #FFFFFF;">                prepstr = sprintf(['Pre-processing, including lu(A-sigma*I):' ...</span><br/>               <span style="color: #A0A0A0">1500</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    '   %f\n'],cputms(1));</span><br/>               <span style="color: #A0A0A0">1501</span> <span style="color: #228B22; background: #FFFFFF;">            else</span><br/>               <span style="color: #A0A0A0">1502</span> <span style="color: #A0A0A0; background: #FFFFFF;">                prepstr = sprintf(['Pre-processing, including lu(A-sigma*B):' ...</span><br/>               <span style="color: #A0A0A0">1503</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    '   %f\n'],cputms(1));</span><br/>               <span style="color: #A0A0A0">1504</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0">1505</span> <span style="color: #228B22; background: #FFFFFF;">        else</span><br/>               <span style="color: #A0A0A0">1506</span> <span style="color: #A0A0A0; background: #FFFFFF;">            prepstr = sprintf(['Pre-processing:' ...</span><br/>               <span style="color: #A0A0A0">1507</span> <span style="color: #A0A0A0; background: #FFFFFF;">                '                            %f\n'],cputms(1));</span><br/>               <span style="color: #A0A0A0">1508</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0">1509</span> <span style="color: #A0A0A0; background: #FFFFFF;">        sstr = sprintf('***********CPU Timing Results in seconds***********');</span><br/>               <span style="color: #A0A0A0">1510</span> <span style="color: #A0A0A0; background: #FFFFFF;">        ds = sprintf(['\n' sstr '\n' ...</span><br/>               <span style="color: #A0A0A0">1511</span> <span style="color: #A0A0A0; background: #FFFFFF;">            prepstr ...</span><br/>               <span style="color: #A0A0A0">1512</span> <span style="color: #A0A0A0; background: #FFFFFF;">            'ARPACK''s %s:                           %f\n' ...</span><br/>               <span style="color: #A0A0A0">1513</span> <span style="color: #A0A0A0; background: #FFFFFF;">            innerstr ...</span><br/>               <span style="color: #A0A0A0">1514</span> <span style="color: #A0A0A0; background: #FFFFFF;">            'Post-processing with ARPACK''s %s:      %f\n' ...</span><br/>               <span style="color: #A0A0A0">1515</span> <span style="color: #A0A0A0; background: #FFFFFF;">            '***************************************************\n' ...</span><br/>               <span style="color: #A0A0A0">1516</span> <span style="color: #A0A0A0; background: #FFFFFF;">            'Total:                                     %f\n' ...</span><br/>               <span style="color: #A0A0A0">1517</span> <span style="color: #A0A0A0; background: #FFFFFF;">            sstr '\n'], ...</span><br/>               <span style="color: #A0A0A0">1518</span> <span style="color: #A0A0A0; background: #FFFFFF;">            aupdfun,cputms(2),eupdfun,cputms(4),cputms(5));</span><br/>               <span style="color: #A0A0A0">1519</span> <span style="color: #A0A0A0; background: #FFFFFF;">        disp(ds)</span><br/>               <span style="color: #A0A0A0">1520</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end % printTimings</span><br/>               <span style="color: #A0A0A0">1521</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1522</span> <span style="color: #228B22; background: #FFFFFF;">%-------------------------------------------------------------------------%</span><br/>               <span style="color: #A0A0A0">1523</span> <span style="color: #228B22; background: #FFFFFF;">% End of nested functions</span><br/>               <span style="color: #A0A0A0">1524</span> <span style="color: #228B22; background: #FFFFFF;">%-------------------------------------------------------------------------%</span><br/>               <span style="color: #A0A0A0">1525</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1526</span> <span style="color: #000000; background: #FFFFFF;">end % EIGS </span><br/></pre><p><p>Other subfunctions in this file are not included in this listing.</body></html>