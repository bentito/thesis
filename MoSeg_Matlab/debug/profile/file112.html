<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><link rel="stylesheet" href="file:////usr/local/matlab_v7.11/toolbox/matlab/codetools/matlab-report-styles.css" type="text/css" /><title>Function details for eigs>checkInputs</title><link rel="stylesheet" href="file:////usr/local/matlab_v7.11/toolbox/matlab/codetools/matlab-report-styles.css" type="text/css" /></head><body bgcolor="#F8F8F8"><strong>This is a static copy of a profile report</strong><p><a href="file0.html">Home</a><p><span style="font-size:14pt; background:#FFE4B0">eigs>checkInputs (1 call, 2.676 sec)</span><br/><i>Generated 19-May-2013 17:01:00 using cpu time.</i><br/>nested function in file /usr/local/matlab_v7.11/toolbox/matlab/sparfun/eigs.m<br/>Copy to new window for comparing multiple runs<div class="grayline"/><div class="grayline"/><strong>Parents</strong> (calling functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td></tr><tr><td class="td-linebottomrt"><a href="file110.html">eigs</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">1</td></tr></table><div class="grayline"/><strong>Lines where the most time was spent</strong><br/> <p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line Number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Code</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="#Line899">899</a></td><td class="td-linebottomrt"><pre>[L,U,pp,qq,dgAsB] = LUfactorAm...</pre></td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">2.613 s</td><td class="td-linebottomrt" class="td-linebottomrt">97.6%</td><td class="td-linebottomrt"><img src="file:////usr/local/matlab_v7.11/toolbox/matlab/codetools/private/one-pixel.gif" width=98 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line477">477</a></td><td class="td-linebottomrt"><pre>issymA = ishermitian(A);</pre></td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.031 s</td><td class="td-linebottomrt" class="td-linebottomrt">1.2%</td><td class="td-linebottomrt"><img src="file:////usr/local/matlab_v7.11/toolbox/matlab/codetools/private/one-pixel.gif" width=1 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line985">985</a></td><td class="td-linebottomrt"><pre>if ~ismember(whch,{'LM', 'SM',...</pre></td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.010 s</td><td class="td-linebottomrt" class="td-linebottomrt">0.4%</td><td class="td-linebottomrt"><img src="file:////usr/local/matlab_v7.11/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line873">873</a></td><td class="td-linebottomrt"><pre>if cholB || (~isempty(B) &amp;...</pre></td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.010 s</td><td class="td-linebottomrt" class="td-linebottomrt">0.4%</td><td class="td-linebottomrt"><img src="file:////usr/local/matlab_v7.11/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line508">508</a></td><td class="td-linebottomrt"><pre>B = varargin{3-Amatrix};</pre></td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.010 s</td><td class="td-linebottomrt" class="td-linebottomrt">0.4%</td><td class="td-linebottomrt"><img src="file:////usr/local/matlab_v7.11/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt">All other lines</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:////usr/local/matlab_v7.11/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">2.676 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><b>Children</b> (called functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="file116.html">eigs>checkInputs/LUfactorAminusSigmaB</a></td><td class="td-linebottomrt">nested function</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">2.613 s</td><td class="td-linebottomrt">97.6%</td><td class="td-linebottomrt"><img src="file:////usr/local/matlab_v7.11/toolbox/matlab/codetools/private/one-pixel.gif" width=98 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file113.html">eigs>ishermitian</a></td><td class="td-linebottomrt">subfunction</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.031 s</td><td class="td-linebottomrt">1.2%</td><td class="td-linebottomrt"><img src="file:////usr/local/matlab_v7.11/toolbox/matlab/codetools/private/one-pixel.gif" width=1 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file117.html">cell.ismember</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.010 s</td><td class="td-linebottomrt">0.4%</td><td class="td-linebottomrt"><img src="file:////usr/local/matlab_v7.11/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file115.html">...(arraytoconvert)int64(arraytoconvert)</a></td><td class="td-linebottomrt">anonymous function</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:////usr/local/matlab_v7.11/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file114.html">double.superiorfloat</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:////usr/local/matlab_v7.11/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt">Self time (built-ins, overhead, etc.)</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">0.021 s</td><td class="td-linebottomrt">0.8%</td><td class="td-linebottomrt"><img src="file:////usr/local/matlab_v7.11/toolbox/matlab/codetools/private/one-pixel.gif" width=1 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">2.676 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><strong>Code Analyzer results</strong><br/>No Code Analyzer messages.<div class="grayline"/><strong>Coverage results</strong><br/>[ Show coverage for parent directory ]<br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Total lines in function</td><td class="td-linebottomrt">710</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Non-code lines (comments, blank lines)</td><td class="td-linebottomrt">314</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines (lines that can run)</td><td class="td-linebottomrt">396</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did run</td><td class="td-linebottomrt">113</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did not run</td><td class="td-linebottomrt">283</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Coverage (did run/can run)</td><td class="td-linebottomrt">28.54 %</td></tr></table><div class="grayline"/><b>Function listing</b><br/><pre> <span style="color: #FF0000; font-weight: bold; text-decoration: none">  time</span> <span style="color: #0000FF; font-weight: bold; text-decoration: none">  calls</span>  <span style="font-weight: bold; text-decoration: none">line</span><br/>               <span style="color: #A0A0A0"> 457</span> <span style="color: #A0A0A0; background: #FFFFFF;">    function [A,Amatrix,isrealprob,issymA,n,B,classAB,k, ...</span><br/>               <span style="color: #A0A0A0"> 458</span> <span style="color: #A0A0A0; background: #FFFFFF;">            eigs_sigma,whch,sigma,tol,maxit,p,info,eigs_display,cholB,...</span><br/>               <span style="color: #A0A0A0"> 459</span> <span style="color: #A0A0A0; background: #FFFFFF;">            permB,resid,useeig,afunNargs,style,mode,Afactors,Bfactors] = checkInputs(varargin)</span><br/>               <span style="color: #A0A0A0"> 460</span> <span style="color: #228B22; background: #FFFFFF;">        % Process inputs and do error-checking</span><br/>               <span style="color: #A0A0A0"> 461</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 462</span> <span style="color: #228B22; background: #FFFFFF;">        % Process the input A or the inputs AFUN and N</span><br/>               <span style="color: #A0A0A0"> 463</span> <span style="color: #228B22; background: #FFFFFF;">        % Start to derive some qualities (real, symmetric) about the problem</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 464</span> <span style="color: #000000; background: #FFFFFF;">        if isfloat(varargin{1}) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 465</span> <span style="color: #000000; background: #FFFFFF;">            A = varargin{1}; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 466</span> <span style="color: #000000; background: #FFFFFF;">            Amatrix = true; </span><br/>               <span style="color: #A0A0A0"> 467</span> <span style="color: #228B22; background: #FFFFFF;">        else</span><br/>               <span style="color: #A0A0A0"> 468</span> <span style="color: #228B22; background: #FFFFFF;">            % By checking the function A with fcnchk, we can now use direct</span><br/>               <span style="color: #A0A0A0"> 469</span> <span style="color: #228B22; background: #FFFFFF;">            % function evaluation on the result, without resorting to feval</span><br/>               <span style="color: #A0A0A0"> 470</span> <span style="color: #A0A0A0; background: #FFFFFF;">            A = fcnchk(varargin{1});</span><br/>               <span style="color: #A0A0A0"> 471</span> <span style="color: #A0A0A0; background: #FFFFFF;">            Amatrix = false;</span><br/>               <span style="color: #A0A0A0"> 472</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 473</span> <span style="color: #000000; background: #FFFFFF;">        isrealprob = true; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 474</span> <span style="color: #000000; background: #FFFFFF;">        issymA = false; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 475</span> <span style="color: #000000; background: #FFFFFF;">        if Amatrix </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 476</span> <span style="color: #000000; background: #FFFFFF;">            isrealprob = isreal(A); </span><br/><span style="color: #FF0000">  0.03 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 477</span> <a name="Line477"></a><span style="color: #000000; background: #FFFFFF;">            issymA = <a href="file113.html">ishermitian</a>(A); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 478</span> <span style="color: #000000; background: #FFFFFF;">            [m,n] = size(A); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 479</span> <span style="color: #000000; background: #FFFFFF;">            if (m ~= n) </span><br/>               <span style="color: #A0A0A0"> 480</span> <span style="color: #A0A0A0; background: #FFFFFF;">                error('MATLAB:eigs:NonSquareMatrixOrFunction',...</span><br/>               <span style="color: #A0A0A0"> 481</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    'A must be a square matrix or a function.')</span><br/>               <span style="color: #A0A0A0"> 482</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 483</span> <span style="color: #228B22; background: #FFFFFF;">        else</span><br/>               <span style="color: #A0A0A0"> 484</span> <span style="color: #A0A0A0; background: #FFFFFF;">            n = varargin{2};</span><br/>               <span style="color: #A0A0A0"> 485</span> <span style="color: #A0A0A0; background: #FFFFFF;">            nstr = 'Size of problem, ''n'', must be a positive integer.';</span><br/>               <span style="color: #A0A0A0"> 486</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if ~isscalar(n) || ~isreal(n)</span><br/>               <span style="color: #A0A0A0"> 487</span> <span style="color: #A0A0A0; background: #FFFFFF;">                error('MATLAB:eigs:NonPosIntSize', nstr)</span><br/>               <span style="color: #A0A0A0"> 488</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 489</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if issparse(n)</span><br/>               <span style="color: #A0A0A0"> 490</span> <span style="color: #A0A0A0; background: #FFFFFF;">                n = full(n);</span><br/>               <span style="color: #A0A0A0"> 491</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 492</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if (round(n) ~= n)</span><br/>               <span style="color: #A0A0A0"> 493</span> <span style="color: #A0A0A0; background: #FFFFFF;">                warning('MATLAB:eigs:NonPosIntSize',['%s\n         ' ...</span><br/>               <span style="color: #A0A0A0"> 494</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    'Rounding input size.'],nstr)</span><br/>               <span style="color: #A0A0A0"> 495</span> <span style="color: #A0A0A0; background: #FFFFFF;">                n = round(n);</span><br/>               <span style="color: #A0A0A0"> 496</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 497</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 498</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 499</span> <span style="color: #228B22; background: #FFFFFF;">        % Process the input B and derive the class of the problem.</span><br/>               <span style="color: #A0A0A0"> 500</span> <span style="color: #228B22; background: #FFFFFF;">        % Is B present in the eigs call or not?</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 501</span> <span style="color: #000000; background: #FFFFFF;">        Bpresent = true; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 502</span> <span style="color: #000000; background: #FFFFFF;">        Bstr = 'Generalized matrix B must be the same size as A.'; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 503</span> <span style="color: #000000; background: #FFFFFF;">        if (nargin &lt; (3-Amatrix)) </span><br/>               <span style="color: #A0A0A0"> 504</span> <span style="color: #A0A0A0; background: #FFFFFF;">            B = [];</span><br/>               <span style="color: #A0A0A0"> 505</span> <span style="color: #A0A0A0; background: #FFFFFF;">            Bpresent = false;</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 506</span> <span style="color: #228B22; background: #FFFFFF;">        else </span><br/>               <span style="color: #A0A0A0"> 507</span> <span style="color: #228B22; background: #FFFFFF;">            % Is the next input B or K?</span><br/><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 508</span> <a name="Line508"></a><span style="color: #000000; background: #FFFFFF;">            B = varargin{3-Amatrix}; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 509</span> <span style="color: #000000; background: #FFFFFF;">            if ~isempty(B) % allow eigs(A,[],k,sigma,opts); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 510</span> <span style="color: #000000; background: #FFFFFF;">                if isscalar(B) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 511</span> <span style="color: #000000; background: #FFFFFF;">                    if n ~= 1 </span><br/>               <span style="color: #A0A0A0"> 512</span> <span style="color: #228B22; background: #FFFFFF;">                        % this input is really K and B is not specified</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 513</span> <span style="color: #000000; background: #FFFFFF;">                        B = []; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 514</span> <span style="color: #000000; background: #FFFFFF;">                        Bpresent = false; </span><br/>               <span style="color: #A0A0A0"> 515</span> <span style="color: #228B22; background: #FFFFFF;">                    else</span><br/>               <span style="color: #A0A0A0"> 516</span> <span style="color: #228B22; background: #FFFFFF;">                        % This input could be B or K.</span><br/>               <span style="color: #A0A0A0"> 517</span> <span style="color: #228B22; background: #FFFFFF;">                        % If A is scalar, then the only valid value for k is 1.</span><br/>               <span style="color: #A0A0A0"> 518</span> <span style="color: #228B22; background: #FFFFFF;">                        % So if this input is scalar, let it be B, namely</span><br/>               <span style="color: #A0A0A0"> 519</span> <span style="color: #228B22; background: #FFFFFF;">                        % eigs(4,2,...) assumes A=4, B=2, NOT A=4, k=2</span><br/>               <span style="color: #A0A0A0"> 520</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        if ~isnumeric(B)</span><br/>               <span style="color: #A0A0A0"> 521</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            error('MATLAB:eigs:BsizeMismatchA', Bstr);</span><br/>               <span style="color: #A0A0A0"> 522</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        end</span><br/>               <span style="color: #A0A0A0"> 523</span> <span style="color: #228B22; background: #FFFFFF;">                        % Unless, of course, the scalar is 1, in which case</span><br/>               <span style="color: #A0A0A0"> 524</span> <span style="color: #228B22; background: #FFFFFF;">                        % assume the that it is meant to be K.</span><br/>               <span style="color: #A0A0A0"> 525</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        if (B == 1) &amp;&amp; ((Amatrix &amp;&amp; nargin &lt;= 3) || ...</span><br/>               <span style="color: #A0A0A0"> 526</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                (~Amatrix &amp;&amp; nargin &lt;= 4))</span><br/>               <span style="color: #A0A0A0"> 527</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            B = [];</span><br/>               <span style="color: #A0A0A0"> 528</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            Bpresent = false;</span><br/>               <span style="color: #A0A0A0"> 529</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        elseif ~isfloat(B)</span><br/>               <span style="color: #A0A0A0"> 530</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            error('MATLAB:eigs:BsizeMismatchA', Bstr);</span><br/>               <span style="color: #A0A0A0"> 531</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        end</span><br/>               <span style="color: #A0A0A0"> 532</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    end</span><br/>               <span style="color: #A0A0A0"> 533</span> <span style="color: #228B22; background: #FFFFFF;">                else</span><br/>               <span style="color: #A0A0A0"> 534</span> <span style="color: #228B22; background: #FFFFFF;">                    % B is a not a scalar.</span><br/>               <span style="color: #A0A0A0"> 535</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    if ~isfloat(B) || ~isequal(size(B),[n,n])</span><br/>               <span style="color: #A0A0A0"> 536</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        error('MATLAB:eigs:BsizeMismatchA', Bstr);</span><br/>               <span style="color: #A0A0A0"> 537</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    end</span><br/>               <span style="color: #A0A0A0"> 538</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    isrealprob = isrealprob &amp;&amp; isreal(B);</span><br/>               <span style="color: #A0A0A0"> 539</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 540</span> <span style="color: #000000; background: #FFFFFF;">            end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 541</span> <span style="color: #000000; background: #FFFFFF;">        end </span><br/>               <span style="color: #A0A0A0"> 542</span> <span style="color: #228B22; background: #FFFFFF;">        % ARPACK can only handle homogeneous inputs</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 543</span> <span style="color: #000000; background: #FFFFFF;">        if Amatrix </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 544</span> <span style="color: #000000; background: #FFFFFF;">            classAB = superiorfloat(A,B); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 545</span> <span style="color: #000000; background: #FFFFFF;">            A = cast(A,classAB); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 546</span> <span style="color: #000000; background: #FFFFFF;">            B = cast(B,classAB); </span><br/>               <span style="color: #A0A0A0"> 547</span> <span style="color: #228B22; background: #FFFFFF;">        else</span><br/>               <span style="color: #A0A0A0"> 548</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if ~isempty(B)</span><br/>               <span style="color: #A0A0A0"> 549</span> <span style="color: #A0A0A0; background: #FFFFFF;">                classAB = class(B);</span><br/>               <span style="color: #A0A0A0"> 550</span> <span style="color: #228B22; background: #FFFFFF;">            else</span><br/>               <span style="color: #A0A0A0"> 551</span> <span style="color: #A0A0A0; background: #FFFFFF;">                classAB = 'double';</span><br/>               <span style="color: #A0A0A0"> 552</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 553</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 554</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 555</span> <span style="color: #228B22; background: #FFFFFF;">        % argOffset tells us where to get the eigs inputs K, SIGMA and OPTS.</span><br/>               <span style="color: #A0A0A0"> 556</span> <span style="color: #228B22; background: #FFFFFF;">        % If A is really the function afun, then it also helps us find the</span><br/>               <span style="color: #A0A0A0"> 557</span> <span style="color: #228B22; background: #FFFFFF;">        % trailing parameters in eigs(afun,n,[B],k,sigma,opts,P1,P2,...)</span><br/>               <span style="color: #A0A0A0"> 558</span> <span style="color: #228B22; background: #FFFFFF;">        % Values of argOffset:</span><br/>               <span style="color: #A0A0A0"> 559</span> <span style="color: #228B22; background: #FFFFFF;">        %  0: Amatrix is false and Bpresent is true:</span><br/>               <span style="color: #A0A0A0"> 560</span> <span style="color: #228B22; background: #FFFFFF;">        %     eigs(afun,n,B,k,sigma,opts,P1,P2,...)</span><br/>               <span style="color: #A0A0A0"> 561</span> <span style="color: #228B22; background: #FFFFFF;">        %  1: Amatrix and Bpresent are both true, or both false</span><br/>               <span style="color: #A0A0A0"> 562</span> <span style="color: #228B22; background: #FFFFFF;">        %     eigs(A,B,k,sigma,opts)</span><br/>               <span style="color: #A0A0A0"> 563</span> <span style="color: #228B22; background: #FFFFFF;">        %     eigs(afun,n,k,sigma,opts,P1,P2,...)</span><br/>               <span style="color: #A0A0A0"> 564</span> <span style="color: #228B22; background: #FFFFFF;">        %  2: Amatrix is true and Bpresent is false:</span><br/>               <span style="color: #A0A0A0"> 565</span> <span style="color: #228B22; background: #FFFFFF;">        %     eigs(A,k,sigma,opts)</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 566</span> <span style="color: #000000; background: #FFFFFF;">        argOffset = Amatrix + ~Bpresent; </span><br/>               <span style="color: #A0A0A0"> 567</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 568</span> <span style="color: #000000; background: #FFFFFF;">        if Amatrix &amp;&amp; ((nargin - Bpresent)&gt;4) </span><br/>               <span style="color: #A0A0A0"> 569</span> <span style="color: #A0A0A0; background: #FFFFFF;">            error('MATLAB:eigs:TooManyInputs', 'Too many inputs.')</span><br/>               <span style="color: #A0A0A0"> 570</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 571</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 572</span> <span style="color: #228B22; background: #FFFFFF;">        % Process the input K.</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 573</span> <span style="color: #000000; background: #FFFFFF;">        if (nargin &lt; (4-argOffset)) </span><br/>               <span style="color: #A0A0A0"> 574</span> <span style="color: #A0A0A0; background: #FFFFFF;">            k = min(n,6);</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 575</span> <span style="color: #228B22; background: #FFFFFF;">        else </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 576</span> <span style="color: #000000; background: #FFFFFF;">            k = varargin{4-argOffset}; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 577</span> <span style="color: #000000; background: #FFFFFF;">            kstr = ['Number of eigenvalues requested, k, must be a' ... </span><br/>               <span style="color: #A0A0A0"> 578</span> <span style="color: #000000; background: #FFFFFF;">                ' positive integer &lt;= n.'];</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 579</span> <span style="color: #000000; background: #FFFFFF;">            if ~isnumeric(k) || ~isscalar(k) || ~isreal(k) || (k&gt;n) </span><br/>               <span style="color: #A0A0A0"> 580</span> <span style="color: #A0A0A0; background: #FFFFFF;">                error('MATLAB:eigs:NonIntegerEigQty', kstr)</span><br/>               <span style="color: #A0A0A0"> 581</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 582</span> <span style="color: #000000; background: #FFFFFF;">            if issparse(k) </span><br/>               <span style="color: #A0A0A0"> 583</span> <span style="color: #A0A0A0; background: #FFFFFF;">                k = full(k);</span><br/>               <span style="color: #A0A0A0"> 584</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 585</span> <span style="color: #000000; background: #FFFFFF;">            if (round(k) ~= k) </span><br/>               <span style="color: #A0A0A0"> 586</span> <span style="color: #A0A0A0; background: #FFFFFF;">                warning('MATLAB:eigs:NonIntegerEigQty',['%s\n         ' ...</span><br/>               <span style="color: #A0A0A0"> 587</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    'Rounding number of eigenvalues.'],kstr)</span><br/>               <span style="color: #A0A0A0"> 588</span> <span style="color: #A0A0A0; background: #FFFFFF;">                k = round(k);</span><br/>               <span style="color: #A0A0A0"> 589</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 590</span> <span style="color: #000000; background: #FFFFFF;">        end </span><br/>               <span style="color: #A0A0A0"> 591</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 592</span> <span style="color: #228B22; background: #FFFFFF;">        % Process the input SIGMA and derive ARPACK values whch and sigma.</span><br/>               <span style="color: #A0A0A0"> 593</span> <span style="color: #228B22; background: #FFFFFF;">        % eigs_sigma is the value documented in the help as "SIGMA" that is</span><br/>               <span style="color: #A0A0A0"> 594</span> <span style="color: #228B22; background: #FFFFFF;">        % passed in to EIGS. eigs_sigma may be either a scalar, including 0,</span><br/>               <span style="color: #A0A0A0"> 595</span> <span style="color: #228B22; background: #FFFFFF;">        % or a string, including 'SM'.</span><br/>               <span style="color: #A0A0A0"> 596</span> <span style="color: #228B22; background: #FFFFFF;">        % In ARPACK, eigs_sigma corresponds to two variables:</span><br/>               <span style="color: #A0A0A0"> 597</span> <span style="color: #228B22; background: #FFFFFF;">        % 1.  which, called "whch" to avoid conflict with MATLAB's function</span><br/>               <span style="color: #A0A0A0"> 598</span> <span style="color: #228B22; background: #FFFFFF;">        % 2.  sigma</span><br/>               <span style="color: #A0A0A0"> 599</span> <span style="color: #228B22; background: #FFFFFF;">        % whch is always a string. sigma is always a scalar.</span><br/>               <span style="color: #A0A0A0"> 600</span> <span style="color: #228B22; background: #FFFFFF;">        % Valid combinations are shown below. Note eigs_sigma = 0/'SM' has</span><br/>               <span style="color: #A0A0A0"> 601</span> <span style="color: #228B22; background: #FFFFFF;">        % the same sigma/whch values as eigs_sigma='LM' (default) so these</span><br/>               <span style="color: #A0A0A0"> 602</span> <span style="color: #228B22; background: #FFFFFF;">        % must be distinguished by the mode.</span><br/>               <span style="color: #A0A0A0"> 603</span> <span style="color: #228B22; background: #FFFFFF;">        % eigs_sigma = 'SM' or 0 =&gt; sigma = 0, whch = 'LM' (mode=3)</span><br/>               <span style="color: #A0A0A0"> 604</span> <span style="color: #228B22; background: #FFFFFF;">        % eigs_sigma is a string not 'SM' =&gt; sigma = 0, whch = eigs_sigma (mode=1)</span><br/>               <span style="color: #A0A0A0"> 605</span> <span style="color: #228B22; background: #FFFFFF;">        % eigs_sigma is any scalar =&gt; sigma = eigs_sigma, whch = 'LM'</span><br/>               <span style="color: #A0A0A0"> 606</span> <span style="color: #228B22; background: #FFFFFF;">        % (mode=1)</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 607</span> <span style="color: #000000; background: #FFFFFF;">        whchstr = 'Eigenvalue range sigma must be a valid 2-element string.'; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 608</span> <span style="color: #000000; background: #FFFFFF;">        if (nargin &lt; (5-argOffset)) </span><br/>               <span style="color: #A0A0A0"> 609</span> <span style="color: #228B22; background: #FFFFFF;">            % default: eigs 'LM' =&gt; ARPACK which='LM', sigma=0</span><br/>               <span style="color: #A0A0A0"> 610</span> <span style="color: #A0A0A0; background: #FFFFFF;">            eigs_sigma = 'LM';</span><br/>               <span style="color: #A0A0A0"> 611</span> <span style="color: #A0A0A0; background: #FFFFFF;">            whch = 'LM';</span><br/>               <span style="color: #A0A0A0"> 612</span> <span style="color: #A0A0A0; background: #FFFFFF;">            sigma = 0;</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 613</span> <span style="color: #228B22; background: #FFFFFF;">        else </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 614</span> <span style="color: #000000; background: #FFFFFF;">            eigs_sigma = varargin{5-argOffset}; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 615</span> <span style="color: #000000; background: #FFFFFF;">            if ischar(eigs_sigma) </span><br/>               <span style="color: #A0A0A0"> 616</span> <span style="color: #228B22; background: #FFFFFF;">                % eigs(string) =&gt; ARPACK which=string, sigma=0</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 617</span> <span style="color: #000000; background: #FFFFFF;">                if ~isequal(size(eigs_sigma),[1,2]) </span><br/>               <span style="color: #A0A0A0"> 618</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    error('MATLAB:eigs:EigenvalueRangeNotValid', ...</span><br/>               <span style="color: #A0A0A0"> 619</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        [whchstr '\nFor real symmetric A, the' ...</span><br/>               <span style="color: #A0A0A0"> 620</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        ' choices are ''%s'', ''%s'', ''%s'', ''%s'' or ''%s''.' ...</span><br/>               <span style="color: #A0A0A0"> 621</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        '\nFor non-symmetric or complex' ...</span><br/>               <span style="color: #A0A0A0"> 622</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        ' A, the choices are ''%s'', ''%s'', ''%s'', ''%s'',' ...</span><br/>               <span style="color: #A0A0A0"> 623</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        ' ''%s'' or ''%s''.\n'], ...</span><br/>               <span style="color: #A0A0A0"> 624</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        'LM','SM','LA','SA','BE','LM','SM','LR','SR','LI','SI')</span><br/>               <span style="color: #A0A0A0"> 625</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 626</span> <span style="color: #000000; background: #FFFFFF;">                eigs_sigma = upper(eigs_sigma); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 627</span> <span style="color: #000000; background: #FFFFFF;">                if strcmp(eigs_sigma,'SM') </span><br/>               <span style="color: #A0A0A0"> 628</span> <span style="color: #228B22; background: #FFFFFF;">                    % eigs('SM') =&gt; ARPACK which='LM', sigma=0</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 629</span> <span style="color: #000000; background: #FFFFFF;">                    whch = 'LM'; </span><br/>               <span style="color: #A0A0A0"> 630</span> <span style="color: #228B22; background: #FFFFFF;">                else</span><br/>               <span style="color: #A0A0A0"> 631</span> <span style="color: #228B22; background: #FFFFFF;">                    % eigs(string), where string~='SM' =&gt; ARPACK which=string, sigma=0</span><br/>               <span style="color: #A0A0A0"> 632</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    whch = eigs_sigma;</span><br/>               <span style="color: #A0A0A0"> 633</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 634</span> <span style="color: #000000; background: #FFFFFF;">                sigma = zeros(classAB); </span><br/>               <span style="color: #A0A0A0"> 635</span> <span style="color: #228B22; background: #FFFFFF;">            else</span><br/>               <span style="color: #A0A0A0"> 636</span> <span style="color: #228B22; background: #FFFFFF;">                % eigs(scalar) =&gt; ARPACK which='LM', sigma=scalar</span><br/>               <span style="color: #A0A0A0"> 637</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if ~isfloat(eigs_sigma) || ~isscalar(eigs_sigma)</span><br/>               <span style="color: #A0A0A0"> 638</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    error('MATLAB:eigs:EigenvalueShiftNonScalar',...</span><br/>               <span style="color: #A0A0A0"> 639</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        'Eigenvalue shift sigma must be a scalar.')</span><br/>               <span style="color: #A0A0A0"> 640</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 641</span> <span style="color: #A0A0A0; background: #FFFFFF;">                sigma = eigs_sigma;</span><br/>               <span style="color: #A0A0A0"> 642</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if issparse(sigma)</span><br/>               <span style="color: #A0A0A0"> 643</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    sigma = full(sigma);</span><br/>               <span style="color: #A0A0A0"> 644</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 645</span> <span style="color: #A0A0A0; background: #FFFFFF;">                sigma = cast(sigma,classAB);</span><br/>               <span style="color: #A0A0A0"> 646</span> <span style="color: #A0A0A0; background: #FFFFFF;">                isrealprob = isrealprob &amp;&amp; isreal(sigma);</span><br/>               <span style="color: #A0A0A0"> 647</span> <span style="color: #A0A0A0; background: #FFFFFF;">                whch = 'LM';</span><br/>               <span style="color: #A0A0A0"> 648</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 649</span> <span style="color: #000000; background: #FFFFFF;">        end </span><br/>               <span style="color: #A0A0A0"> 650</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 651</span> <span style="color: #228B22; background: #FFFFFF;">        % Process the input OPTS and derive some ARPACK values.</span><br/>               <span style="color: #A0A0A0"> 652</span> <span style="color: #228B22; background: #FFFFFF;">        % ARPACK's minimum tolerance is eps/2 ([S/D]LAMCH's EPS)</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 653</span> <span style="color: #000000; background: #FFFFFF;">        tol = eps(classAB); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 654</span> <span style="color: #000000; background: #FFFFFF;">        maxit = []; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 655</span> <span style="color: #000000; background: #FFFFFF;">        p = []; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 656</span> <span style="color: #000000; background: #FFFFFF;">        style = []; </span><br/>               <span style="color: #A0A0A0"> 657</span> <span style="color: #228B22; background: #FFFFFF;">        % Always use resid as the start vector, whether it is OPTS.v0 or</span><br/>               <span style="color: #A0A0A0"> 658</span> <span style="color: #228B22; background: #FFFFFF;">        % randomly generated within eigs.  We default resid to empty here.</span><br/>               <span style="color: #A0A0A0"> 659</span> <span style="color: #228B22; background: #FFFFFF;">        % If the user does not initialize it, we provide a random residual</span><br/>               <span style="color: #A0A0A0"> 660</span> <span style="color: #228B22; background: #FFFFFF;">        % below.</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 661</span> <span style="color: #000000; background: #FFFFFF;">      info = intconvert(1); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 662</span> <span style="color: #000000; background: #FFFFFF;">        resid = []; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 663</span> <span style="color: #000000; background: #FFFFFF;">        eigs_display = 0; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 664</span> <span style="color: #000000; background: #FFFFFF;">        cholB = false; % do we have B or its Cholesky factor? </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 665</span> <span style="color: #000000; background: #FFFFFF;">        permB = []; % if cholB, is it chol(B), or chol(B(permB,permB))? </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 666</span> <span style="color: #000000; background: #FFFFFF;">        if (nargin &gt;= (6-argOffset)) </span><br/>               <span style="color: #A0A0A0"> 667</span> <span style="color: #A0A0A0; background: #FFFFFF;">            opts = varargin{6-argOffset};</span><br/>               <span style="color: #A0A0A0"> 668</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if ~isa(opts,'struct')</span><br/>               <span style="color: #A0A0A0"> 669</span> <span style="color: #A0A0A0; background: #FFFFFF;">                error('MATLAB:eigs:OptionsNotStructure',...</span><br/>               <span style="color: #A0A0A0"> 670</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    'Options argument must be a structure.')</span><br/>               <span style="color: #A0A0A0"> 671</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 672</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if isfield(opts,'issym') &amp;&amp; ~Amatrix</span><br/>               <span style="color: #A0A0A0"> 673</span> <span style="color: #A0A0A0; background: #FFFFFF;">                issymA = opts.issym;</span><br/>               <span style="color: #A0A0A0"> 674</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if (issymA ~= false) &amp;&amp; (issymA ~= true)</span><br/>               <span style="color: #A0A0A0"> 675</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    error('MATLAB:eigs:InvalidOptsIssym', ...</span><br/>               <span style="color: #A0A0A0"> 676</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        'opts.issym must be true or false.')</span><br/>               <span style="color: #A0A0A0"> 677</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 678</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 679</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if isfield(opts,'isreal') &amp;&amp; ~Amatrix</span><br/>               <span style="color: #A0A0A0"> 680</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if (opts.isreal ~= false) &amp;&amp; (opts.isreal ~= true)</span><br/>               <span style="color: #A0A0A0"> 681</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    error('MATLAB:eigs:InvalidOptsIsreal', ...</span><br/>               <span style="color: #A0A0A0"> 682</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        'opts.isreal must be true or false.')</span><br/>               <span style="color: #A0A0A0"> 683</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 684</span> <span style="color: #A0A0A0; background: #FFFFFF;">                isrealprob = isrealprob &amp;&amp; opts.isreal;</span><br/>               <span style="color: #A0A0A0"> 685</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 686</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if ~isempty(B) &amp;&amp; (isfield(opts,'cholB') || isfield(opts,'permB'))</span><br/>               <span style="color: #A0A0A0"> 687</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if isfield(opts,'cholB')</span><br/>               <span style="color: #A0A0A0"> 688</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    cholB = opts.cholB;</span><br/>               <span style="color: #A0A0A0"> 689</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    if (cholB ~= false) &amp;&amp; (cholB ~= true)</span><br/>               <span style="color: #A0A0A0"> 690</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        error('MATLAB:eigs:InvalidOptsCholB', ...</span><br/>               <span style="color: #A0A0A0"> 691</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            'opts.cholB must be true or false.')</span><br/>               <span style="color: #A0A0A0"> 692</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    end</span><br/>               <span style="color: #A0A0A0"> 693</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    if isfield(opts,'permB')</span><br/>               <span style="color: #A0A0A0"> 694</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        if issparse(B) &amp;&amp; cholB</span><br/>               <span style="color: #A0A0A0"> 695</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            permB = opts.permB;</span><br/>               <span style="color: #A0A0A0"> 696</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            if ~isvector(permB) || ~isequal(sort(permB(:)),(1:n)')</span><br/>               <span style="color: #A0A0A0"> 697</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                error('MATLAB:eigs:InvalidOptsPermB',...</span><br/>               <span style="color: #A0A0A0"> 698</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                    'opts.permB must be a permutation of 1:n.')</span><br/>               <span style="color: #A0A0A0"> 699</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            end</span><br/>               <span style="color: #A0A0A0"> 700</span> <span style="color: #228B22; background: #FFFFFF;">                        else</span><br/>               <span style="color: #A0A0A0"> 701</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            warning('MATLAB:eigs:IgnoredOptionPermB', ...</span><br/>               <span style="color: #A0A0A0"> 702</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                ['Ignoring opts.permB since B is not its sparse' ...</span><br/>               <span style="color: #A0A0A0"> 703</span> <span style="color: #A0A0A0; background: #FFFFFF;">                                ' Cholesky factor.'])</span><br/>               <span style="color: #A0A0A0"> 704</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        end</span><br/>               <span style="color: #A0A0A0"> 705</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    end</span><br/>               <span style="color: #A0A0A0"> 706</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 707</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 708</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if isfield(opts,'tol')</span><br/>               <span style="color: #A0A0A0"> 709</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if ~isfloat(tol) || ~isscalar(opts.tol) || ~isreal(opts.tol) || (opts.tol&lt;=0)</span><br/>               <span style="color: #A0A0A0"> 710</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    error('MATLAB:eigs:InvalidOptsTol',...</span><br/>               <span style="color: #A0A0A0"> 711</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        ['Convergence tolerance opts.tol must be a strictly' ...</span><br/>               <span style="color: #A0A0A0"> 712</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        ' positive real scalar.'])</span><br/>               <span style="color: #A0A0A0"> 713</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 714</span> <span style="color: #A0A0A0; background: #FFFFFF;">                tol = cast(full(opts.tol),classAB);</span><br/>               <span style="color: #A0A0A0"> 715</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 716</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if isfield(opts,'p')</span><br/>               <span style="color: #A0A0A0"> 717</span> <span style="color: #A0A0A0; background: #FFFFFF;">                p = opts.p;</span><br/>               <span style="color: #A0A0A0"> 718</span> <span style="color: #A0A0A0; background: #FFFFFF;">                pstr = ['Number of basis vectors opts.p must be a positive' ...</span><br/>               <span style="color: #A0A0A0"> 719</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ' integer &lt;= n.'];</span><br/>               <span style="color: #A0A0A0"> 720</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if ~isnumeric(p) || ~isscalar(p) || ~isreal(p) || (p&lt;=0) || (p&gt;n)</span><br/>               <span style="color: #A0A0A0"> 721</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    error('MATLAB:eigs:InvalidOptsP', pstr)</span><br/>               <span style="color: #A0A0A0"> 722</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 723</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if issparse(p)</span><br/>               <span style="color: #A0A0A0"> 724</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    p = full(p);</span><br/>               <span style="color: #A0A0A0"> 725</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 726</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if (round(p) ~= p)</span><br/>               <span style="color: #A0A0A0"> 727</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    warning('MATLAB:eigs:NonIntegerVecQty',['%s\n         ' ...</span><br/>               <span style="color: #A0A0A0"> 728</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        'Rounding number of basis vectors.'],pstr)</span><br/>               <span style="color: #A0A0A0"> 729</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    p = round(p);</span><br/>               <span style="color: #A0A0A0"> 730</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 731</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 732</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if isfield(opts,'maxit')</span><br/>               <span style="color: #A0A0A0"> 733</span> <span style="color: #A0A0A0; background: #FFFFFF;">                maxit = opts.maxit;</span><br/>               <span style="color: #A0A0A0"> 734</span> <span style="color: #A0A0A0; background: #FFFFFF;">                str = ['Maximum number of iterations opts.maxit must be' ...</span><br/>               <span style="color: #A0A0A0"> 735</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ' a positive integer.'];</span><br/>               <span style="color: #A0A0A0"> 736</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if ~isnumeric(maxit) || ~isscalar(maxit) || ~isreal(maxit) || (maxit&lt;=0)</span><br/>               <span style="color: #A0A0A0"> 737</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    error('MATLAB:eigs:OptsMaxitNotPosInt', str)</span><br/>               <span style="color: #A0A0A0"> 738</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 739</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if issparse(maxit)</span><br/>               <span style="color: #A0A0A0"> 740</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    maxit = full(maxit);</span><br/>               <span style="color: #A0A0A0"> 741</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 742</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if (round(maxit) ~= maxit)</span><br/>               <span style="color: #A0A0A0"> 743</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    warning('MATLAB:eigs:NonIntegerIterationQty',['%s\n         ' ...</span><br/>               <span style="color: #A0A0A0"> 744</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        'Rounding number of iterations.'],str)</span><br/>               <span style="color: #A0A0A0"> 745</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    maxit = round(maxit);</span><br/>               <span style="color: #A0A0A0"> 746</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 747</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 748</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if isfield(opts,'v0')</span><br/>               <span style="color: #A0A0A0"> 749</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if ~isfloat(opts.v0) || ~isequal(size(opts.v0),[n,1])</span><br/>               <span style="color: #A0A0A0"> 750</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    error('MATLAB:eigs:WrongSizeOptsV0',...</span><br/>               <span style="color: #A0A0A0"> 751</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        'Start vector opts.v0 must be n-by-1.')</span><br/>               <span style="color: #A0A0A0"> 752</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 753</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if isrealprob</span><br/>               <span style="color: #A0A0A0"> 754</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    if ~isreal(opts.v0)</span><br/>               <span style="color: #A0A0A0"> 755</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        error('MATLAB:eigs:NotRealOptsV0',...</span><br/>               <span style="color: #A0A0A0"> 756</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            'Start vector opts.v0 must be real for real problems.')</span><br/>               <span style="color: #A0A0A0"> 757</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    end</span><br/>               <span style="color: #A0A0A0"> 758</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    resid(1:n,1) = full(opts.v0);</span><br/>               <span style="color: #A0A0A0"> 759</span> <span style="color: #228B22; background: #FFFFFF;">                else</span><br/>               <span style="color: #A0A0A0"> 760</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    resid(2:2:2*n,1) = full(imag(opts.v0));</span><br/>               <span style="color: #A0A0A0"> 761</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    resid(1:2:(2*n-1),1) = full(real(opts.v0));</span><br/>               <span style="color: #A0A0A0"> 762</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 763</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 764</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if isfield(opts,'disp')</span><br/>               <span style="color: #A0A0A0"> 765</span> <span style="color: #A0A0A0; background: #FFFFFF;">                eigs_display = opts.disp;</span><br/>               <span style="color: #A0A0A0"> 766</span> <span style="color: #A0A0A0; background: #FFFFFF;">                dispstr = 'Diagnostic level opts.disp must be an integer.';</span><br/>               <span style="color: #A0A0A0"> 767</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if ~isnumeric(eigs_display) || ~isscalar(eigs_display) || ...</span><br/>               <span style="color: #A0A0A0"> 768</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        ~isreal(eigs_display) || (eigs_display&lt;0)</span><br/>               <span style="color: #A0A0A0"> 769</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    error('MATLAB:eigs:NonIntegerDiagnosticLevel', dispstr)</span><br/>               <span style="color: #A0A0A0"> 770</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 771</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if (round(eigs_display) ~= eigs_display)</span><br/>               <span style="color: #A0A0A0"> 772</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    warning('MATLAB:eigs:NonIntegerDiagnosticLevel', ...</span><br/>               <span style="color: #A0A0A0"> 773</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        '%s\n         Rounding diagnostic level.',dispstr)</span><br/>               <span style="color: #A0A0A0"> 774</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    eigs_display = round(eigs_display);</span><br/>               <span style="color: #A0A0A0"> 775</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 776</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 777</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if isfield(opts,'cheb')</span><br/>               <span style="color: #A0A0A0"> 778</span> <span style="color: #A0A0A0; background: #FFFFFF;">                error('MATLAB:eigs:ObsoleteOptionCheb', ...</span><br/>               <span style="color: #A0A0A0"> 779</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    'Polynomial acceleration opts.cheb is an obsolete option.');</span><br/>               <span style="color: #A0A0A0"> 780</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 781</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if isfield(opts,'stagtol')</span><br/>               <span style="color: #A0A0A0"> 782</span> <span style="color: #A0A0A0; background: #FFFFFF;">                error('MATLAB:eigs:ObsoleteOptionStagtol', ...</span><br/>               <span style="color: #A0A0A0"> 783</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    'Stagnation tolerance opts.stagtol is an obsolete option.');</span><br/>               <span style="color: #A0A0A0"> 784</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 785</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if isfield(opts,'style')</span><br/>               <span style="color: #A0A0A0"> 786</span> <span style="color: #A0A0A0; background: #FFFFFF;">                style = opts.style;</span><br/>               <span style="color: #A0A0A0"> 787</span> <span style="color: #A0A0A0; background: #FFFFFF;">                str = 'style must be ''S'' or ''G''.';</span><br/>               <span style="color: #A0A0A0"> 788</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if ~ischar(style)</span><br/>               <span style="color: #A0A0A0"> 789</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    error('MATLAB:eigs:InvalidStyle',str);</span><br/>               <span style="color: #A0A0A0"> 790</span> <span style="color: #A0A0A0; background: #FFFFFF;">                elseif ~(strcmp(style,'S') || strcmp(style,'G'))</span><br/>               <span style="color: #A0A0A0"> 791</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    error('MATLAB:eigs:InvalidStyle',str);</span><br/>               <span style="color: #A0A0A0"> 792</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 793</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 794</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 795</span> <span style="color: #000000; background: #FFFFFF;">        if (isempty(resid)) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 796</span> <span style="color: #000000; background: #FFFFFF;">            if isrealprob </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 797</span> <span style="color: #000000; background: #FFFFFF;">                resid = cast(rand(n,1),classAB); </span><br/>               <span style="color: #A0A0A0"> 798</span> <span style="color: #228B22; background: #FFFFFF;">            else</span><br/>               <span style="color: #A0A0A0"> 799</span> <span style="color: #A0A0A0; background: #FFFFFF;">                resid = cast(rand(2*n,1),classAB);</span><br/>               <span style="color: #A0A0A0"> 800</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 801</span> <span style="color: #000000; background: #FFFFFF;">        end </span><br/>               <span style="color: #A0A0A0"> 802</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 803</span> <span style="color: #000000; background: #FFFFFF;">        afunNargs = zeros(1,0); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 804</span> <span style="color: #000000; background: #FFFFFF;">        if ~Amatrix </span><br/>               <span style="color: #A0A0A0"> 805</span> <span style="color: #228B22; background: #FFFFFF;">            % The trailing parameters for afun start at varargin{7-argOffset}</span><br/>               <span style="color: #A0A0A0"> 806</span> <span style="color: #228B22; background: #FFFFFF;">            % in eigs(afun,n,[B],k,sigma,opts,P1,P2,...). If there are no</span><br/>               <span style="color: #A0A0A0"> 807</span> <span style="color: #228B22; background: #FFFFFF;">            % trailing parameters in eigs, then afunNargs is a 1-by-0 empty</span><br/>               <span style="color: #A0A0A0"> 808</span> <span style="color: #228B22; background: #FFFFFF;">            % and no trailing parameters are passed to afun(x)</span><br/>               <span style="color: #A0A0A0"> 809</span> <span style="color: #A0A0A0; background: #FFFFFF;">            afunNargs = 7-argOffset:nargin;</span><br/>               <span style="color: #A0A0A0"> 810</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 811</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 812</span> <span style="color: #228B22; background: #FFFFFF;">        % Now that OPTS has been processed, do final error checking and</span><br/>               <span style="color: #A0A0A0"> 813</span> <span style="color: #228B22; background: #FFFFFF;">        % assign ARPACK variables</span><br/>               <span style="color: #A0A0A0"> 814</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 815</span> <span style="color: #228B22; background: #FFFFFF;">        % Extra check on input B</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 816</span> <span style="color: #000000; background: #FFFFFF;">        if ~isempty(B) </span><br/>               <span style="color: #A0A0A0"> 817</span> <span style="color: #228B22; background: #FFFFFF;">            % B must be symmetric (Hermitian) positive (semi-)definite</span><br/>               <span style="color: #A0A0A0"> 818</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if cholB</span><br/>               <span style="color: #A0A0A0"> 819</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if ~isequal(triu(B),B)</span><br/>               <span style="color: #A0A0A0"> 820</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    error('MATLAB:eigs:BNotChol', ...</span><br/>               <span style="color: #A0A0A0"> 821</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        'opts.CHOLB specified, but B is not upper triangular.');</span><br/>               <span style="color: #A0A0A0"> 822</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 823</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 824</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 825</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 826</span> <span style="color: #000000; background: #FFFFFF;">        if isempty(style) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 827</span> <span style="color: #000000; background: #FFFFFF;">            if strcmp(eigs_sigma,'SM') || isscalar(eigs_sigma) || ~isempty(B) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 828</span> <span style="color: #000000; background: #FFFFFF;">                style = 'G'; </span><br/>               <span style="color: #A0A0A0"> 829</span> <span style="color: #228B22; background: #FFFFFF;">            else</span><br/>               <span style="color: #A0A0A0"> 830</span> <span style="color: #A0A0A0; background: #FFFFFF;">                style = 'S';</span><br/>               <span style="color: #A0A0A0"> 831</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 832</span> <span style="color: #000000; background: #FFFFFF;">        end </span><br/>               <span style="color: #A0A0A0"> 833</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 834</span> <span style="color: #000000; background: #FFFFFF;">        if ~isempty(B) </span><br/>               <span style="color: #A0A0A0"> 835</span> <span style="color: #A0A0A0; background: #FFFFFF;">            scaleB = norm(B,'fro')/sqrt(n);</span><br/>               <span style="color: #A0A0A0"> 836</span> <span style="color: #A0A0A0; background: #FFFFFF;">            scaleB = 2^(floor(log2(scaleB+1)));</span><br/>               <span style="color: #A0A0A0"> 837</span> <span style="color: #A0A0A0; background: #FFFFFF;">            B = B/scaleB;</span><br/>               <span style="color: #A0A0A0"> 838</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if cholB</span><br/>               <span style="color: #A0A0A0"> 839</span> <span style="color: #A0A0A0; background: #FFFFFF;">                scaleB = scaleB^2;</span><br/>               <span style="color: #A0A0A0"> 840</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 841</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if isscalar(eigs_sigma)</span><br/>               <span style="color: #A0A0A0"> 842</span> <span style="color: #A0A0A0; background: #FFFFFF;">                sigma = scaleB*eigs_sigma;</span><br/>               <span style="color: #A0A0A0"> 843</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 844</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 845</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 846</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 847</span> <span style="color: #000000; background: #FFFFFF;">        if strcmp(eigs_sigma,'SM') || ~ischar(eigs_sigma) </span><br/>               <span style="color: #A0A0A0"> 848</span> <span style="color: #228B22; background: #FFFFFF;">            % eigs(A,B,k,scalarSigma) or eigs(A,B,k,'SM'), B may be []</span><br/>               <span style="color: #A0A0A0"> 849</span> <span style="color: #228B22; background: #FFFFFF;">            % Note: sigma must be real for [s,d]saupd and [s,d]naupd</span><br/>               <span style="color: #A0A0A0"> 850</span> <span style="color: #228B22; background: #FFFFFF;">            % If sigma is complex, even if A and B are both real, we use</span><br/>               <span style="color: #A0A0A0"> 851</span> <span style="color: #228B22; background: #FFFFFF;">            % [c,z]naupd.</span><br/>               <span style="color: #A0A0A0"> 852</span> <span style="color: #228B22; background: #FFFFFF;">            % This means that mode=3 in [s,d]naupd, which has</span><br/>               <span style="color: #A0A0A0"> 853</span> <span style="color: #228B22; background: #FFFFFF;">            % OP = real(inv(A - sigma*M)*M) and B = M</span><br/>               <span style="color: #A0A0A0"> 854</span> <span style="color: #228B22; background: #FFFFFF;">            % reduces to the same OP as [s,d]saupd and [c,z]naupd.</span><br/>               <span style="color: #A0A0A0"> 855</span> <span style="color: #228B22; background: #FFFFFF;">            % A*x = lambda*M*x, M symmetric (positive) semi-definite</span><br/>               <span style="color: #A0A0A0"> 856</span> <span style="color: #228B22; background: #FFFFFF;">            % =&gt; OP = inv(A - sigma*M)*M and B = M</span><br/>               <span style="color: #A0A0A0"> 857</span> <span style="color: #228B22; background: #FFFFFF;">            % =&gt; shift-and-invert mode</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 858</span> <span style="color: #000000; background: #FFFFFF;">            mode = 3; </span><br/>               <span style="color: #A0A0A0"> 859</span> <span style="color: #A0A0A0; background: #FFFFFF;">        elseif strcmp(style,'S')</span><br/>               <span style="color: #A0A0A0"> 860</span> <span style="color: #228B22; background: #FFFFFF;">            % eigs(A,k,stringSigma) or eigs(A,[],k,stringSigma),</span><br/>               <span style="color: #A0A0A0"> 861</span> <span style="color: #228B22; background: #FFFFFF;">            % stringSigma~='SM'</span><br/>               <span style="color: #A0A0A0"> 862</span> <span style="color: #228B22; background: #FFFFFF;">            % A*x = lambda*x</span><br/>               <span style="color: #A0A0A0"> 863</span> <span style="color: #228B22; background: #FFFFFF;">            % =&gt; OP = A and B = I</span><br/>               <span style="color: #A0A0A0"> 864</span> <span style="color: #A0A0A0; background: #FFFFFF;">            mode = 1;</span><br/>               <span style="color: #A0A0A0"> 865</span> <span style="color: #228B22; background: #FFFFFF;">        else</span><br/>               <span style="color: #A0A0A0"> 866</span> <span style="color: #228B22; background: #FFFFFF;">            % eigs(A,B,k,stringSigma), stringSigma~='SM'</span><br/>               <span style="color: #A0A0A0"> 867</span> <span style="color: #228B22; background: #FFFFFF;">            % A*x = lambda*B*x</span><br/>               <span style="color: #A0A0A0"> 868</span> <span style="color: #228B22; background: #FFFFFF;">            % =&gt; OP = inv(B)*A and use standard inner product.</span><br/>               <span style="color: #A0A0A0"> 869</span> <span style="color: #A0A0A0; background: #FFFFFF;">            mode = 2;</span><br/>               <span style="color: #A0A0A0"> 870</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 871</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 872</span> <span style="color: #000000; background: #FFFFFF;">        BisHpd = false; </span><br/><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 873</span> <a name="Line873"></a><span style="color: #000000; background: #FFFFFF;">        if cholB || (~isempty(B) &amp;&amp; <a href="file113.html">ishermitian</a>(B)) </span><br/>               <span style="color: #A0A0A0"> 874</span> <span style="color: #228B22; background: #FFFFFF;">            % The reordering permutation permB is [] unless B is sparse</span><br/>               <span style="color: #A0A0A0"> 875</span> <span style="color: #A0A0A0; background: #FFFFFF;">            [RB,RBT,permB,BisHpd] = CHOLfactorB;</span><br/>               <span style="color: #A0A0A0"> 876</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if mode == 3 &amp;&amp; ~cholB</span><br/>               <span style="color: #A0A0A0"> 877</span> <span style="color: #A0A0A0; background: #FFFFFF;">                RB = [];    RBT = [];   permB = [];</span><br/>               <span style="color: #A0A0A0"> 878</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 879</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 880</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 881</span> <span style="color: #000000; background: #FFFFFF;">        qqB = []; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 882</span> <span style="color: #000000; background: #FFFFFF;">        if BisHpd == false &amp;&amp; (mode == 1 || mode == 2) </span><br/>               <span style="color: #A0A0A0"> 883</span> <span style="color: #A0A0A0; background: #FFFFFF;">            [LB,UB,ppB,qqB,dgB] = LUfactorB;</span><br/>               <span style="color: #A0A0A0"> 884</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 885</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 886</span> <span style="color: #000000; background: #FFFFFF;">        Bfactors = []; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 887</span> <span style="color: #000000; background: #FFFFFF;">        if ~isempty(B) </span><br/>               <span style="color: #A0A0A0"> 888</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if BisHpd == true</span><br/>               <span style="color: #A0A0A0"> 889</span> <span style="color: #A0A0A0; background: #FFFFFF;">                Bfactors = struct('RB',RB,'RBT',RBT,'permB',permB,'BisHpd',BisHpd);</span><br/>               <span style="color: #A0A0A0"> 890</span> <span style="color: #A0A0A0; background: #FFFFFF;">            elseif (mode == 1 || mode == 2)</span><br/>               <span style="color: #A0A0A0"> 891</span> <span style="color: #A0A0A0; background: #FFFFFF;">                Bfactors = struct('LB',LB,'UB',UB,'ppB',ppB,'qqB',qqB,'dgB',dgB,'BisHpd',BisHpd);</span><br/>               <span style="color: #A0A0A0"> 892</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 893</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 894</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 895</span> <span style="color: #000000; background: #FFFFFF;">        Afactors = []; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 896</span> <span style="color: #000000; background: #FFFFFF;">        qq = []; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 897</span> <span style="color: #000000; background: #FFFFFF;">        if (mode == 3) &amp;&amp; Amatrix % need lu(A-sigma*B) </span><br/>               <span style="color: #A0A0A0"> 898</span> <span style="color: #228B22; background: #FFFFFF;">            % The reordering permutation permAsB is [] unless A-sigma*B is sparse</span><br/><span style="color: #FF0000">  2.61 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 899</span> <a name="Line899"></a><span style="color: #000000; background: #FF8080;">            [L,U,pp,qq,dgAsB] = <a href="file116.html">LUfactorAminusSigmaB</a>; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 900</span> <span style="color: #000000; background: #FFFFFF;">            Afactors = struct('L',L,'U',U,'pp',pp,'qq',qq,'dgAsB',dgAsB); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 901</span> <span style="color: #000000; background: #FFFFFF;">        end % if (mode == 3) &amp;&amp; Amatrix         </span><br/>               <span style="color: #A0A0A0"> 902</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 903</span> <span style="color: #228B22; background: #FFFFFF;">        % under these conditions, OP must be unsymmetric</span><br/>               <span style="color: #A0A0A0"> 904</span> <span style="color: #228B22; background: #FFFFFF;">        % note that OP = inv(A-\sigma*B)*B IS symmetric if A is symmetric</span><br/>               <span style="color: #A0A0A0"> 905</span> <span style="color: #228B22; background: #FFFFFF;">        % and B-inner product is used!</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 906</span> <span style="color: #000000; background: #FFFFFF;">        if ~isempty(B) &amp;&amp; (BisHpd == false || (strcmp(style,'S') &amp;&amp; mode == 3)) </span><br/>               <span style="color: #A0A0A0"> 907</span> <span style="color: #A0A0A0; background: #FFFFFF;">            issymA = false;</span><br/>               <span style="color: #A0A0A0"> 908</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 909</span> <span style="color: #228B22; background: #FFFFFF;">        % Extra check on input K</span><br/>               <span style="color: #A0A0A0"> 910</span> <span style="color: #228B22; background: #FFFFFF;">        % We fall back on using the full EIG code if K is too large.</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 911</span> <span style="color: #000000; background: #FFFFFF;">        useeig = false; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 912</span> <span style="color: #000000; background: #FFFFFF;">        if isrealprob &amp;&amp; issymA </span><br/>               <span style="color: #A0A0A0"> 913</span> <span style="color: #A0A0A0; background: #FFFFFF;">            knstr = sprintf(['For real symmetric problems, must have' ...</span><br/>               <span style="color: #A0A0A0"> 914</span> <span style="color: #A0A0A0; background: #FFFFFF;">                ' number of eigenvalues k &lt; n.\n']);</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 915</span> <span style="color: #228B22; background: #FFFFFF;">        else </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 916</span> <span style="color: #000000; background: #FFFFFF;">            knstr = sprintf(['For nonsymmetric and complex problems,' ... </span><br/>               <span style="color: #A0A0A0"> 917</span> <span style="color: #000000; background: #FFFFFF;">                ' must have number of eigenvalues k &lt; n-1.\n']);</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 918</span> <span style="color: #000000; background: #FFFFFF;">        end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 919</span> <span style="color: #000000; background: #FFFFFF;">        if isempty(B) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 920</span> <span style="color: #000000; background: #FFFFFF;">            knstr = [knstr 'Using eig(full(A)) instead.']; </span><br/>               <span style="color: #A0A0A0"> 921</span> <span style="color: #228B22; background: #FFFFFF;">        else</span><br/>               <span style="color: #A0A0A0"> 922</span> <span style="color: #A0A0A0; background: #FFFFFF;">            knstr = [knstr 'Using eig(full(A),full(B)) instead.'];</span><br/>               <span style="color: #A0A0A0"> 923</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 924</span> <span style="color: #000000; background: #FFFFFF;">        if (k == 0) </span><br/>               <span style="color: #A0A0A0"> 925</span> <span style="color: #A0A0A0; background: #FFFFFF;">            useeig = true;</span><br/>               <span style="color: #A0A0A0"> 926</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 927</span> <span style="color: #000000; background: #FFFFFF;">        if isrealprob &amp;&amp; issymA </span><br/>               <span style="color: #A0A0A0"> 928</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if (k &gt; n-1)</span><br/>               <span style="color: #A0A0A0"> 929</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if (n &gt;= 6)</span><br/>               <span style="color: #A0A0A0"> 930</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    warning('MATLAB:eigs:TooManyRequestedEigsForRealSym', ...</span><br/>               <span style="color: #A0A0A0"> 931</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        '%s',knstr)</span><br/>               <span style="color: #A0A0A0"> 932</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 933</span> <span style="color: #A0A0A0; background: #FFFFFF;">                useeig = true;</span><br/>               <span style="color: #A0A0A0"> 934</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 935</span> <span style="color: #228B22; background: #FFFFFF;">        else </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 936</span> <span style="color: #000000; background: #FFFFFF;">            if (k &gt; n-2) </span><br/>               <span style="color: #A0A0A0"> 937</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if (n &gt;= 7)</span><br/>               <span style="color: #A0A0A0"> 938</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    warning('MATLAB:eigs:TooManyRequestedEigsForComplexNonsym', ...</span><br/>               <span style="color: #A0A0A0"> 939</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        '%s',knstr)</span><br/>               <span style="color: #A0A0A0"> 940</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 941</span> <span style="color: #A0A0A0; background: #FFFFFF;">                useeig = true;</span><br/>               <span style="color: #A0A0A0"> 942</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 943</span> <span style="color: #000000; background: #FFFFFF;">        end </span><br/>               <span style="color: #A0A0A0"> 944</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 945</span> <span style="color: #228B22; background: #FFFFFF;">        % Extra check on input SIGMA</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 946</span> <span style="color: #000000; background: #FFFFFF;">        if isrealprob &amp;&amp; issymA </span><br/>               <span style="color: #A0A0A0"> 947</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if ~isreal(sigma)</span><br/>               <span style="color: #A0A0A0"> 948</span> <span style="color: #A0A0A0; background: #FFFFFF;">                error('MATLAB:eigs:ComplexShiftForRealSymProblem',...</span><br/>               <span style="color: #A0A0A0"> 949</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ['For real symmetric problems, eigenvalue shift sigma must' ...</span><br/>               <span style="color: #A0A0A0"> 950</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ' be real.'])</span><br/>               <span style="color: #A0A0A0"> 951</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 952</span> <span style="color: #228B22; background: #FFFFFF;">        else </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 953</span> <span style="color: #000000; background: #FFFFFF;">            if ~isrealprob &amp;&amp; issymA &amp;&amp; ~isreal(sigma) </span><br/>               <span style="color: #A0A0A0"> 954</span> <span style="color: #A0A0A0; background: #FFFFFF;">                warning('MATLAB:eigs:ComplexShiftForHermitianProblem', ...</span><br/>               <span style="color: #A0A0A0"> 955</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ['Complex eigenvalue shift sigma on a Hermitian problem' ...</span><br/>               <span style="color: #A0A0A0"> 956</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ' (all real eigenvalues).'])</span><br/>               <span style="color: #A0A0A0"> 957</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 958</span> <span style="color: #000000; background: #FFFFFF;">        end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 959</span> <span style="color: #000000; background: #FFFFFF;">        if isrealprob &amp;&amp; issymA </span><br/>               <span style="color: #A0A0A0"> 960</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if strcmp(whch,'LR')</span><br/>               <span style="color: #A0A0A0"> 961</span> <span style="color: #A0A0A0; background: #FFFFFF;">                whch = 'LA';</span><br/>               <span style="color: #A0A0A0"> 962</span> <span style="color: #A0A0A0; background: #FFFFFF;">                warning('MATLAB:eigs:SigmaChangedToLA', ...</span><br/>               <span style="color: #A0A0A0"> 963</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ['For real symmetric problems, sigma value ''LR''' ...</span><br/>               <span style="color: #A0A0A0"> 964</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ' (Largest Real) is now ''LA'' (Largest Algebraic).'])</span><br/>               <span style="color: #A0A0A0"> 965</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 966</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if strcmp(whch,'SR')</span><br/>               <span style="color: #A0A0A0"> 967</span> <span style="color: #A0A0A0; background: #FFFFFF;">                whch = 'SA';</span><br/>               <span style="color: #A0A0A0"> 968</span> <span style="color: #A0A0A0; background: #FFFFFF;">                warning('MATLAB:eigs:SigmaChangedToSA', ...</span><br/>               <span style="color: #A0A0A0"> 969</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ['For real symmetric problems, sigma value ''SR''' ...</span><br/>               <span style="color: #A0A0A0"> 970</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ' (Smallest Real) is now ''SA'' (Smallest Algebraic).'])</span><br/>               <span style="color: #A0A0A0"> 971</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 972</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if ~ismember(whch,{'LM', 'SM', 'LA', 'SA', 'BE'})</span><br/>               <span style="color: #A0A0A0"> 973</span> <span style="color: #A0A0A0; background: #FFFFFF;">                error('MATLAB:eigs:EigenvalueRangeNotValid', ...</span><br/>               <span style="color: #A0A0A0"> 974</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    [whchstr '\nFor real symmetric A, the' ...</span><br/>               <span style="color: #A0A0A0"> 975</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ' choices are ''%s'', ''%s'', ''%s'', ''%s'' or ''%s''.'], ...</span><br/>               <span style="color: #A0A0A0"> 976</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    'LM','SM','LA','SA','BE');</span><br/>               <span style="color: #A0A0A0"> 977</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 978</span> <span style="color: #228B22; background: #FFFFFF;">        else </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 979</span> <span style="color: #000000; background: #FFFFFF;">            if strcmp(whch,'BE') </span><br/>               <span style="color: #A0A0A0"> 980</span> <span style="color: #A0A0A0; background: #FFFFFF;">                warning('MATLAB:eigs:SigmaChangedToLM', ...</span><br/>               <span style="color: #A0A0A0"> 981</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ['Sigma value ''BE'' is now only available for real' ...</span><br/>               <span style="color: #A0A0A0"> 982</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ' symmetric problems.  Computing ''LM'' eigenvalues instead.'])</span><br/>               <span style="color: #A0A0A0"> 983</span> <span style="color: #A0A0A0; background: #FFFFFF;">                whch = 'LM';</span><br/>               <span style="color: #A0A0A0"> 984</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 985</span> <a name="Line985"></a><span style="color: #000000; background: #FFFFFF;">            if ~ismember(whch,{'LM', 'SM', 'LR', 'SR', 'LI', 'SI'}) </span><br/>               <span style="color: #A0A0A0"> 986</span> <span style="color: #A0A0A0; background: #FFFFFF;">                error('MATLAB:eigs:EigenvalueRangeNotValid', ...</span><br/>               <span style="color: #A0A0A0"> 987</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    [whchstr '\nFor non-symmetric or complex' ...</span><br/>               <span style="color: #A0A0A0"> 988</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ' A, the choices are ''%s'', ''%s'', ''%s'', ''%s'',' ...</span><br/>               <span style="color: #A0A0A0"> 989</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ' ''%s'' or ''%s''.\n'],'LM','SM','LR','SR','LI','SI');</span><br/>               <span style="color: #A0A0A0"> 990</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 991</span> <span style="color: #000000; background: #FFFFFF;">        end </span><br/>               <span style="color: #A0A0A0"> 992</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 993</span> <span style="color: #228B22; background: #FFFFFF;">        % The remainder of the error checking does not apply for the large</span><br/>               <span style="color: #A0A0A0"> 994</span> <span style="color: #228B22; background: #FFFFFF;">        % values of K that force us to use full EIG instead of ARPACK.</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 995</span> <span style="color: #000000; background: #FFFFFF;">        if useeig </span><br/>               <span style="color: #A0A0A0"> 996</span> <span style="color: #A0A0A0; background: #FFFFFF;">            return</span><br/>               <span style="color: #A0A0A0"> 997</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 998</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 999</span> <span style="color: #228B22; background: #FFFFFF;">        % Extra check on input OPTS.p</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1000</span> <span style="color: #000000; background: #FFFFFF;">        if isempty(p) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1001</span> <span style="color: #000000; background: #FFFFFF;">            if isrealprob &amp;&amp; ~issymA </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1002</span> <span style="color: #000000; background: #FFFFFF;">                p = min(max(2*k+1,20),n); </span><br/>               <span style="color: #A0A0A0">1003</span> <span style="color: #228B22; background: #FFFFFF;">            else</span><br/>               <span style="color: #A0A0A0">1004</span> <span style="color: #A0A0A0; background: #FFFFFF;">                p = min(max(2*k,20),n);</span><br/>               <span style="color: #A0A0A0">1005</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0">1006</span> <span style="color: #228B22; background: #FFFFFF;">        else</span><br/>               <span style="color: #A0A0A0">1007</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if isrealprob &amp;&amp; issymA</span><br/>               <span style="color: #A0A0A0">1008</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if (p &lt;= k)</span><br/>               <span style="color: #A0A0A0">1009</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    error('MATLAB:eigs:InvalidOptsPforRealSymProb',...</span><br/>               <span style="color: #A0A0A0">1010</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        ['For real symmetric problems, must have number of' ...</span><br/>               <span style="color: #A0A0A0">1011</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        ' basis vectors opts.p &gt; k.'])</span><br/>               <span style="color: #A0A0A0">1012</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0">1013</span> <span style="color: #228B22; background: #FFFFFF;">            else</span><br/>               <span style="color: #A0A0A0">1014</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if (p &lt;= k+1)</span><br/>               <span style="color: #A0A0A0">1015</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    error('MATLAB:eigs:InvalidOptsPforComplexOrNonSymProb',...</span><br/>               <span style="color: #A0A0A0">1016</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        ['For nonsymmetric and complex problems, must have number of' ...</span><br/>               <span style="color: #A0A0A0">1017</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        ' basis vectors opts.p &gt; k+1.'])</span><br/>               <span style="color: #A0A0A0">1018</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0">1019</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0">1020</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0">1021</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0">1022</span> <span style="color: #228B22; background: #FFFFFF;">        % Extra check on input OPTS.maxit</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1023</span> <span style="color: #000000; background: #FFFFFF;">        if isempty(maxit) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1024</span> <span style="color: #000000; background: #FFFFFF;">            maxit = max(300,ceil(2*n/max(p,1))); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1025</span> <span style="color: #000000; background: #FFFFFF;">        end </span><br/>               <span style="color: #A0A0A0">1026</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0">1027</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0">1028</span> <span style="color: #228B22; background: #FFFFFF;">        % Nested functions in checkInputs</span><br/>               <span style="color: #A0A0A0">1029</span> <span style="color: #228B22; background: #FFFFFF;">        %-------------------------------------------------------------------------%</span><br/>               <span style="color: #A0A0A0">1030</span> <span style="color: #A0A0A0; background: #FFFFFF;">        function [RB,RBT,ppB,BisHpd] = CHOLfactorB</span><br/>               <span style="color: #A0A0A0">1031</span> <span style="color: #228B22; background: #FFFFFF;">            % permB may be [] (from checkInputs) if the problem is not sparse</span><br/>               <span style="color: #A0A0A0">1032</span> <span style="color: #228B22; background: #FFFFFF;">            % or if it was not passed in as opts.permB</span><br/>               <span style="color: #A0A0A0">1033</span> <span style="color: #A0A0A0; background: #FFFFFF;">            ppB = permB;</span><br/>               <span style="color: #A0A0A0">1034</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if cholB</span><br/>               <span style="color: #A0A0A0">1035</span> <span style="color: #228B22; background: #FFFFFF;">                % CHOL(B) was passed in as B</span><br/>               <span style="color: #A0A0A0">1036</span> <span style="color: #A0A0A0; background: #FFFFFF;">                RB = B;</span><br/>               <span style="color: #A0A0A0">1037</span> <span style="color: #A0A0A0; background: #FFFFFF;">                RBT = B';</span><br/>               <span style="color: #A0A0A0">1038</span> <span style="color: #A0A0A0; background: #FFFFFF;">                BisHpd = true;</span><br/>               <span style="color: #A0A0A0">1039</span> <span style="color: #228B22; background: #FFFFFF;">            else</span><br/>               <span style="color: #A0A0A0">1040</span> <span style="color: #228B22; background: #FFFFFF;">                % CHOL(B) was not passed into EIGS</span><br/>               <span style="color: #A0A0A0">1041</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if ~isempty(B)</span><br/>               <span style="color: #A0A0A0">1042</span> <span style="color: #228B22; background: #FFFFFF;">                    % Algorithm requires CHOL(B) to be computed</span><br/>               <span style="color: #A0A0A0">1043</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    if issparse(B)</span><br/>               <span style="color: #A0A0A0">1044</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        ppB = symamd(B);</span><br/>               <span style="color: #A0A0A0">1045</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        [RB,idxB] = chol(B(ppB,ppB));</span><br/>               <span style="color: #A0A0A0">1046</span> <span style="color: #228B22; background: #FFFFFF;">                    else</span><br/>               <span style="color: #A0A0A0">1047</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        [RB,idxB] = chol(B);</span><br/>               <span style="color: #A0A0A0">1048</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    end</span><br/>               <span style="color: #A0A0A0">1049</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    if mode == 3</span><br/>               <span style="color: #A0A0A0">1050</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        RB = [];    ppB = [];</span><br/>               <span style="color: #A0A0A0">1051</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    end</span><br/>               <span style="color: #A0A0A0">1052</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    RBT = RB';</span><br/>               <span style="color: #A0A0A0">1053</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    if (idxB == 0)</span><br/>               <span style="color: #A0A0A0">1054</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        BisHpd = true;</span><br/>               <span style="color: #A0A0A0">1055</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    elseif mode == 3 &amp;&amp; isreal(B)</span><br/>               <span style="color: #A0A0A0">1056</span> <span style="color: #228B22; background: #FFFFFF;">                        % LDL decomposition is only for 'SM' eigenvalues of the</span><br/>               <span style="color: #A0A0A0">1057</span> <span style="color: #228B22; background: #FFFFFF;">                        % pair (A,B) where B is Hermitian positive</span><br/>               <span style="color: #A0A0A0">1058</span> <span style="color: #228B22; background: #FFFFFF;">                        % semi-definite; in this case, as ARPACK users' guide</span><br/>               <span style="color: #A0A0A0">1059</span> <span style="color: #228B22; background: #FFFFFF;">                        % suggests, one should still use B-(semi)inner product</span><br/>               <span style="color: #A0A0A0">1060</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        [LB,DB,pvB] = ldl(B,'vector'); %#ok</span><br/>               <span style="color: #A0A0A0">1061</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        BisHpd = checkTridiagForHSD(diag(DB), diag(DB,1));</span><br/>               <span style="color: #A0A0A0">1062</span> <span style="color: #228B22; background: #FFFFFF;">                    else</span><br/>               <span style="color: #A0A0A0">1063</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        BisHpd = false;</span><br/>               <span style="color: #A0A0A0">1064</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    end</span><br/>               <span style="color: #A0A0A0">1065</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0">1066</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0">1067</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if ~isempty(B) &amp;&amp; issparse(B)</span><br/>               <span style="color: #A0A0A0">1068</span> <span style="color: #A0A0A0; background: #FFFFFF;">               tmp = speye(length(B));               </span><br/>               <span style="color: #A0A0A0">1069</span> <span style="color: #A0A0A0; background: #FFFFFF;">               ppB = tmp(ppB,1:length(B));</span><br/>               <span style="color: #A0A0A0">1070</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0">1071</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end % CHOLfactorB</span><br/>               <span style="color: #A0A0A0">1072</span> <span style="color: #228B22; background: #FFFFFF;">        %-------------------------------------------------------------------------%</span><br/>               <span style="color: #A0A0A0">1073</span> <span style="color: #A0A0A0; background: #FFFFFF;">        function [LB,UB,ppB,qqB,dgB] = LUfactorB</span><br/>               <span style="color: #A0A0A0">1074</span> <span style="color: #228B22; background: #FFFFFF;">            % LU factor B, including a reordering perm if it is sparse</span><br/>               <span style="color: #A0A0A0">1075</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if issparse(B)</span><br/>               <span style="color: #A0A0A0">1076</span> <span style="color: #A0A0A0; background: #FFFFFF;">                [LB,UB,ppB,qqB,dgB] = lu(B);</span><br/>               <span style="color: #A0A0A0">1077</span> <span style="color: #228B22; background: #FFFFFF;">            else</span><br/>               <span style="color: #A0A0A0">1078</span> <span style="color: #A0A0A0; background: #FFFFFF;">                [LB,UB,ppB] = lu(B,'vector');</span><br/>               <span style="color: #A0A0A0">1079</span> <span style="color: #A0A0A0; background: #FFFFFF;">                qqB = []; dgB = [];</span><br/>               <span style="color: #A0A0A0">1080</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end            </span><br/>               <span style="color: #A0A0A0">1081</span> <span style="color: #228B22; background: #FFFFFF;">            % Warn if lu(B) is ill-conditioned</span><br/>               <span style="color: #A0A0A0">1082</span> <span style="color: #A0A0A0; background: #FFFFFF;">            dUB = diag(UB);</span><br/>               <span style="color: #A0A0A0">1083</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if any(dUB == 0) || any(diag(LB) == 0)</span><br/>               <span style="color: #A0A0A0">1084</span> <span style="color: #A0A0A0; background: #FFFFFF;">                error('MATLAB:eigs:SingularB', ...</span><br/>               <span style="color: #A0A0A0">1085</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ['B is singular.\nUnable to compute the specified eigenvalues'...</span><br/>               <span style="color: #A0A0A0">1086</span> <span style="color: #A0A0A0; background: #FFFFFF;">                     ' because infinite eigenvalue(s) exist']);</span><br/>               <span style="color: #A0A0A0">1087</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0">1088</span> <span style="color: #A0A0A0; background: #FFFFFF;">            rcondestUB = full(min(abs(dUB)) / max(abs(dUB)));</span><br/>               <span style="color: #A0A0A0">1089</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if (rcondestUB &lt; eps)</span><br/>               <span style="color: #A0A0A0">1090</span> <span style="color: #A0A0A0; background: #FFFFFF;">                warning('MATLAB:eigs:IllConditionedB',...</span><br/>               <span style="color: #A0A0A0">1091</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ['B has small reciprocal condition' ...</span><br/>               <span style="color: #A0A0A0">1092</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ' estimate: %f\n' ...</span><br/>               <span style="color: #A0A0A0">1093</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    '         indicating that B^{-1}A might not be applied accurately.\n' ...</span><br/>               <span style="color: #A0A0A0">1094</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    '         and there may be infinite eigenvalue(s).\n'],...</span><br/>               <span style="color: #A0A0A0">1095</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    rcondestUB);</span><br/>               <span style="color: #A0A0A0">1096</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0">1097</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end % LUfactorB</span><br/>               <span style="color: #A0A0A0">1098</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0">1099</span> <span style="color: #228B22; background: #FFFFFF;">        %-------------------------------------------------------------------------%</span><br/>               <span style="color: #A0A0A0">1100</span> <span style="color: #A0A0A0; background: #FFFFFF;">        function [L,U,pp,qq,dgAsB] = LUfactorAminusSigmaB</span><br/>               <span style="color: #A0A0A0">1101</span> <span style="color: #228B22; background: #FFFFFF;">            % LU factor A-sigma*B, including a reordering perm if it is sparse</span><br/>               <span style="color: #A0A0A0">1102</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if sigma == 0</span><br/>               <span style="color: #A0A0A0">1103</span> <span style="color: #A0A0A0; background: #FFFFFF;">                AsB = A;</span><br/>               <span style="color: #A0A0A0">1104</span> <span style="color: #A0A0A0; background: #FFFFFF;">            elseif isempty(B)</span><br/>               <span style="color: #A0A0A0">1105</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if issparse(A)</span><br/>               <span style="color: #A0A0A0">1106</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    AsB = A - sigma * speye(n);</span><br/>               <span style="color: #A0A0A0">1107</span> <span style="color: #228B22; background: #FFFFFF;">                else</span><br/>               <span style="color: #A0A0A0">1108</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    AsB = A - sigma * eye(n);</span><br/>               <span style="color: #A0A0A0">1109</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0">1110</span> <span style="color: #228B22; background: #FFFFFF;">            else</span><br/>               <span style="color: #A0A0A0">1111</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if cholB</span><br/>               <span style="color: #A0A0A0">1112</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    if issparse(B)</span><br/>               <span style="color: #A0A0A0">1113</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        AsB = A - sigma * checkInputBmtimes(speye(n));</span><br/>               <span style="color: #A0A0A0">1114</span> <span style="color: #228B22; background: #FFFFFF;">                    else</span><br/>               <span style="color: #A0A0A0">1115</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        AsB = A - sigma * checkInputBmtimes(eye(n));</span><br/>               <span style="color: #A0A0A0">1116</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    end</span><br/>               <span style="color: #A0A0A0">1117</span> <span style="color: #228B22; background: #FFFFFF;">                else</span><br/>               <span style="color: #A0A0A0">1118</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    AsB = A - sigma * B;</span><br/>               <span style="color: #A0A0A0">1119</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0">1120</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0">1121</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if issparse(AsB)</span><br/>               <span style="color: #A0A0A0">1122</span> <span style="color: #A0A0A0; background: #FFFFFF;">                [L,U,pp,qq,dgAsB] = lu(AsB);</span><br/>               <span style="color: #A0A0A0">1123</span> <span style="color: #228B22; background: #FFFFFF;">            else</span><br/>               <span style="color: #A0A0A0">1124</span> <span style="color: #A0A0A0; background: #FFFFFF;">                [L,U,pp] = lu(AsB,'vector');</span><br/>               <span style="color: #A0A0A0">1125</span> <span style="color: #A0A0A0; background: #FFFFFF;">                qq = []; dgAsB = [];</span><br/>               <span style="color: #A0A0A0">1126</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0">1127</span> <span style="color: #228B22; background: #FFFFFF;">            % Warn if lu(A-sigma*B) is ill-conditioned</span><br/>               <span style="color: #A0A0A0">1128</span> <span style="color: #228B22; background: #FFFFFF;">            % =&gt; sigma is close to an exact eigenvalue of (A,B)</span><br/>               <span style="color: #A0A0A0">1129</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if isempty(B)</span><br/>               <span style="color: #A0A0A0">1130</span> <span style="color: #A0A0A0; background: #FFFFFF;">                ds = '(A-sigma*I)';</span><br/>               <span style="color: #A0A0A0">1131</span> <span style="color: #228B22; background: #FFFFFF;">            else</span><br/>               <span style="color: #A0A0A0">1132</span> <span style="color: #A0A0A0; background: #FFFFFF;">                ds = '(A-sigma*B)';</span><br/>               <span style="color: #A0A0A0">1133</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0">1134</span> <span style="color: #A0A0A0; background: #FFFFFF;">            dU = diag(U);</span><br/>               <span style="color: #A0A0A0">1135</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if any(dU == 0) || any(diag(L) == 0)</span><br/>               <span style="color: #A0A0A0">1136</span> <span style="color: #A0A0A0; background: #FFFFFF;">                error('MATLAB:eigs:AminusBSingular', ...</span><br/>               <span style="color: #A0A0A0">1137</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    [ds 'is singular. The shift is an eigenvalue.\n' ...</span><br/>               <span style="color: #A0A0A0">1138</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    'Try to use some other shift please.\n']);</span><br/>               <span style="color: #A0A0A0">1139</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0">1140</span> <span style="color: #A0A0A0; background: #FFFFFF;">            rcondestU = full(min(abs(dU)) / max(abs(dU)));</span><br/>               <span style="color: #A0A0A0">1141</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if (rcondestU &lt; eps)                </span><br/>               <span style="color: #A0A0A0">1142</span> <span style="color: #A0A0A0; background: #FFFFFF;">                warning('MATLAB:eigs:SigmaNearExactEig',...</span><br/>               <span style="color: #A0A0A0">1143</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    [ds ' has small reciprocal condition' ...</span><br/>               <span style="color: #A0A0A0">1144</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ' estimate: %f\n' ...</span><br/>               <span style="color: #A0A0A0">1145</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    '         indicating that sigma is near an exact' ...</span><br/>               <span style="color: #A0A0A0">1146</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ' eigenvalue.\n         The algorithm may not converge unless' ...</span><br/>               <span style="color: #A0A0A0">1147</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ' you try a new value for sigma.\n'], ...</span><br/>               <span style="color: #A0A0A0">1148</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    rcondestU);</span><br/>               <span style="color: #A0A0A0">1149</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0">1150</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end % LUfactorAminusSigmaB</span><br/>               <span style="color: #A0A0A0">1151</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0">1152</span> <span style="color: #228B22; background: #FFFFFF;">%-------------------------------------------------------------------------%        </span><br/>               <span style="color: #A0A0A0">1153</span> <span style="color: #A0A0A0; background: #FFFFFF;">        function v = checkInputBmtimes(u)</span><br/>               <span style="color: #A0A0A0">1154</span> <span style="color: #228B22; background: #FFFFFF;">            % Matrix-vector multiply v = B*u</span><br/>               <span style="color: #A0A0A0">1155</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if cholB % use B's cholesky factor and its transpose</span><br/>               <span style="color: #A0A0A0">1156</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if ~isempty(permB)</span><br/>               <span style="color: #A0A0A0">1157</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    v = permB'*(RBT * (RB * (permB*u)));</span><br/>               <span style="color: #A0A0A0">1158</span> <span style="color: #228B22; background: #FFFFFF;">                else</span><br/>               <span style="color: #A0A0A0">1159</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    v = RBT * (RB * u);</span><br/>               <span style="color: #A0A0A0">1160</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0">1161</span> <span style="color: #228B22; background: #FFFFFF;">            else</span><br/>               <span style="color: #A0A0A0">1162</span> <span style="color: #A0A0A0; background: #FFFFFF;">                v = B * u;</span><br/>               <span style="color: #A0A0A0">1163</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0">1164</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0">1165</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1166</span> <span style="color: #000000; background: #FFFFFF;">    end % checkInputs </span><br/></pre><p><p>Other subfunctions in this file are not included in this listing.</body></html>